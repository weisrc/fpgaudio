import{c as Le,a as D,h as B,b as Ye,r as Q,w as re,d as et,T as si,F as Oa,g as Ae,G as Nu,H as Eu,I as Vu,J as qt,K as Du,R as Fu,L as $e,o as fn,k as ws,M as Ma,N as Na,O as Pu,P as Ea,e as we,S as ki,U as Rs,i as Ru,V as ct,W as At,X as ht,Y as qu,Z as Bu,$ as Va,a0 as Lu,a1 as ju,a2 as Or,j as Uu,a3 as Wu,a4 as No,a5 as $u,l as _t,a6 as zu,a7 as ns,t as Da,a8 as Hu,a9 as Gu,aa as Zu,ab as qs,ac as Xu,ad as Fa,ae as Eo,af as Qu,n as Yu,ag as Ku,ah as Ju,ai as Yn,u as ec,p as tc,f as kn,m as nc,q as ic,aj as Bs,v as Mr,B as ce,ak as Ss,_ as rc,x as Cn,y as xn,z as Ee,A as sc,al as is,am as pt,Q as rs,C as Vo}from"./index.17f2b62a.js";import{c as oc,g as ac,b as lc,a as uc,h as cc}from"./scroll.ccad5f2a.js";var Ct=Le({name:"QCardSection",props:{tag:{type:String,default:"div"},horizontal:Boolean},setup(t,{slots:e}){const n=D(()=>`q-card__section q-card__section--${t.horizontal===!0?"horiz row no-wrap":"vert"}`);return()=>B(t.tag,{class:n.value},Ye(e.default))}});const hc={ratio:[String,Number]};function dc(t,e){return D(()=>{const n=Number(t.ratio||(e!==void 0?e.value:void 0));return isNaN(n)!==!0&&n>0?{paddingBottom:`${100/n}%`}:null})}const fc=16/9;var Do=Le({name:"QImg",props:{...hc,src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:fc},placeholderSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(t,{slots:e,emit:n}){const i=Q(t.initialRatio),r=dc(t,i);let s;const o=[Q(null),Q(t.placeholderSrc!==void 0?{src:t.placeholderSrc}:null)],a=Q(0),l=Q(!1),u=Q(!1),c=D(()=>`q-img q-img--${t.noNativeMenu===!0?"no-":""}menu`),h=D(()=>({width:t.width,height:t.height})),f=D(()=>`q-img__image ${t.imgClass!==void 0?t.imgClass+" ":""}q-img__image--with${t.noTransition===!0?"out":""}-transition`),d=D(()=>({...t.imgStyle,objectFit:t.fit,objectPosition:t.position}));re(()=>p(),g);function p(){return t.src||t.srcset||t.sizes?{src:t.src,srcset:t.srcset,sizes:t.sizes}:null}function g(y){if(clearTimeout(s),u.value=!1,y===null){l.value=!1,o[0].value=null,o[1].value=null;return}l.value=!0,o[a.value].value=y}function m({target:y}){s!==null&&(clearTimeout(s),i.value=y.naturalHeight===0?.5:y.naturalWidth/y.naturalHeight,w(y,1))}function w(y,S){s===null||S===1e3||(y.complete===!0?b(y):s=setTimeout(()=>{w(y,S+1)},50))}function b(y){s!==null&&(a.value=a.value===1?0:1,o[a.value].value=null,l.value=!1,u.value=!1,n("load",y.currentSrc||y.src))}function C(y){clearTimeout(s),l.value=!1,u.value=!0,o[0].value=null,o[1].value=null,n("error",y)}function T(y,S){return B("div",{class:"q-img__container absolute-full",key:y},S)}function v(y){const S=o[y].value,A={key:"img_"+y,class:f.value,style:d.value,crossorigin:t.crossorigin,decoding:t.decoding,referrerpolicy:t.referrerpolicy,height:t.height,width:t.width,loading:t.loading,fetchpriority:t.fetchpriority,"aria-hidden":"true",draggable:t.draggable,...S};return a.value===y?(A.class+=" q-img__image--waiting",Object.assign(A,{onLoad:m,onError:C})):A.class+=" q-img__image--loaded",T("img"+y,B("img",A))}function _(){return l.value!==!0?B("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},Ye(e[u.value===!0?"error":"default"])):B("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},e.loading!==void 0?e.loading():t.noSpinner===!0?void 0:[B(Oa,{color:t.spinnerColor,size:t.spinnerSize})])}return g(p()),et(()=>{clearTimeout(s),s=null}),()=>{const y=[];return r.value!==null&&y.push(B("div",{key:"filler",style:r.value})),u.value!==!0&&(o[0].value!==null&&y.push(v(0)),o[1].value!==null&&y.push(v(1))),y.push(B(si,{name:"q-transition--fade"},_)),B("div",{class:c.value,style:h.value,role:"img","aria-label":t.alt},y)}}});const jn={dark:{type:Boolean,default:null}};function Un(t,e){return D(()=>t.dark===null?e.dark.isActive:t.dark)}const pc={true:"inset",item:"item-inset","item-thumbnail":"item-thumbnail-inset"},ss={xs:2,sm:4,md:8,lg:16,xl:24};var mc=Le({name:"QSeparator",props:{...jn,spaced:[Boolean,String],inset:[Boolean,String],vertical:Boolean,color:String,size:String},setup(t){const e=Ae(),n=Un(t,e.proxy.$q),i=D(()=>t.vertical===!0?"vertical":"horizontal"),r=D(()=>` q-separator--${i.value}`),s=D(()=>t.inset!==!1?`${r.value}-${pc[t.inset]}`:""),o=D(()=>`q-separator${r.value}${s.value}`+(t.color!==void 0?` bg-${t.color}`:"")+(n.value===!0?" q-separator--dark":"")),a=D(()=>{const l={};if(t.size!==void 0&&(l[t.vertical===!0?"width":"height"]=t.size),t.spaced!==!1){const u=t.spaced===!0?`${ss.md}px`:t.spaced in ss?`${ss[t.spaced]}px`:t.spaced,c=t.vertical===!0?["Left","Right"]:["Top","Bottom"];l[`margin${c[0]}`]=l[`margin${c[1]}`]=u}return l});return()=>B("hr",{class:o.value,style:a.value,"aria-orientation":i.value})}});const gc={xs:8,sm:10,md:14,lg:20,xl:24};var Pa=Le({name:"QChip",props:{...jn,...Nu,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(t,{slots:e,emit:n}){const{proxy:{$q:i}}=Ae(),r=Un(t,i),s=Eu(t,gc),o=D(()=>t.selected===!0||t.icon!==void 0),a=D(()=>t.selected===!0?t.iconSelected||i.iconSet.chip.selected:t.icon),l=D(()=>t.iconRemove||i.iconSet.chip.remove),u=D(()=>t.disable===!1&&(t.clickable===!0||t.selected!==null)),c=D(()=>{const m=t.outline===!0&&t.color||t.textColor;return"q-chip row inline no-wrap items-center"+(t.outline===!1&&t.color!==void 0?` bg-${t.color}`:"")+(m?` text-${m} q-chip--colored`:"")+(t.disable===!0?" disabled":"")+(t.dense===!0?" q-chip--dense":"")+(t.outline===!0?" q-chip--outline":"")+(t.selected===!0?" q-chip--selected":"")+(u.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(t.square===!0?" q-chip--square":"")+(r.value===!0?" q-chip--dark q-dark":"")}),h=D(()=>{const m=t.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:t.tabindex||0},w={...m,role:"button","aria-hidden":"false","aria-label":t.removeAriaLabel||i.lang.label.remove};return{chip:m,remove:w}});function f(m){m.keyCode===13&&d(m)}function d(m){t.disable||(n("update:selected",!t.selected),n("click",m))}function p(m){(m.keyCode===void 0||m.keyCode===13)&&($e(m),t.disable===!1&&(n("update:modelValue",!1),n("remove")))}function g(){const m=[];u.value===!0&&m.push(B("div",{class:"q-focus-helper"})),o.value===!0&&m.push(B(qt,{class:"q-chip__icon q-chip__icon--left",name:a.value}));const w=t.label!==void 0?[B("div",{class:"ellipsis"},[t.label])]:void 0;return m.push(B("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},Du(e.default,w))),t.iconRight&&m.push(B(qt,{class:"q-chip__icon q-chip__icon--right",name:t.iconRight})),t.removable===!0&&m.push(B(qt,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:l.value,...h.value.remove,onClick:p,onKeyup:p})),m}return()=>{if(t.modelValue===!1)return;const m={class:c.value,style:s.value};return u.value===!0&&Object.assign(m,h.value.chip,{onClick:d,onKeyup:f}),Vu("div",m,g(),"ripple",t.ripple!==!1&&t.disable!==!0,()=>[[Fu,t.ripple]])}}});function vc({validate:t,resetValidation:e,requiresQForm:n}){const i=ws(Ma,!1);if(i!==!1){const{props:r,proxy:s}=Ae();Object.assign(s,{validate:t,resetValidation:e}),re(()=>r.disable,o=>{o===!0?(typeof e=="function"&&e(),i.unbindComponent(s)):i.bindComponent(s)}),fn(()=>{r.disable!==!0&&i.bindComponent(s)}),et(()=>{r.disable!==!0&&i.unbindComponent(s)})}else n===!0&&console.error("Parent QForm not found on useFormChild()!")}const Fo=/^#[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/,Po=/^#[0-9a-fA-F]{4}([0-9a-fA-F]{4})?$/,Ro=/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{4}|[0-9a-fA-F]{6}|[0-9a-fA-F]{8})$/,Li=/^rgb\(((0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),){2}(0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5])\)$/,ji=/^rgba\(((0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),){2}(0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),(0|0\.[0-9]+[1-9]|0\.[1-9]+|1)\)$/,os={date:t=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(t),time:t=>/^([0-1]?\d|2[0-3]):[0-5]\d$/.test(t),fulltime:t=>/^([0-1]?\d|2[0-3]):[0-5]\d:[0-5]\d$/.test(t),timeOrFulltime:t=>/^([0-1]?\d|2[0-3]):[0-5]\d(:[0-5]\d)?$/.test(t),email:t=>/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t),hexColor:t=>Fo.test(t),hexaColor:t=>Po.test(t),hexOrHexaColor:t=>Ro.test(t),rgbColor:t=>Li.test(t),rgbaColor:t=>ji.test(t),rgbOrRgbaColor:t=>Li.test(t)||ji.test(t),hexOrRgbColor:t=>Fo.test(t)||Li.test(t),hexaOrRgbaColor:t=>Po.test(t)||ji.test(t),anyColor:t=>Ro.test(t)||Li.test(t)||ji.test(t)},_c=[!0,!1,"ondemand"],yc={modelValue:{},error:{type:Boolean,default:null},errorMessage:String,noErrorIcon:Boolean,rules:Array,reactiveRules:Boolean,lazyRules:{type:[Boolean,String],validator:t=>_c.includes(t)}};function bc(t,e){const{props:n,proxy:i}=Ae(),r=Q(!1),s=Q(null),o=Q(null);vc({validate:p,resetValidation:d});let a=0,l;const u=D(()=>n.rules!==void 0&&n.rules!==null&&n.rules.length>0),c=D(()=>n.disable!==!0&&u.value===!0),h=D(()=>n.error===!0||r.value===!0),f=D(()=>typeof n.errorMessage=="string"&&n.errorMessage.length>0?n.errorMessage:s.value);re(()=>n.modelValue,()=>{g()}),re(()=>n.reactiveRules,w=>{w===!0?l===void 0&&(l=re(()=>n.rules,()=>{g(!0)})):l!==void 0&&(l(),l=void 0)},{immediate:!0}),re(t,w=>{w===!0?o.value===null&&(o.value=!1):o.value===!1&&(o.value=!0,c.value===!0&&n.lazyRules!=="ondemand"&&e.value===!1&&m())});function d(){a++,e.value=!1,o.value=null,r.value=!1,s.value=null,m.cancel()}function p(w=n.modelValue){if(c.value!==!0)return!0;const b=++a,C=e.value!==!0?()=>{o.value=!0}:()=>{},T=(_,y)=>{_===!0&&C(),r.value=_,s.value=y||null,e.value=!1},v=[];for(let _=0;_<n.rules.length;_++){const y=n.rules[_];let S;if(typeof y=="function"?S=y(w,os):typeof y=="string"&&os[y]!==void 0&&(S=os[y](w)),S===!1||typeof S=="string")return T(!0,S),!1;S!==!0&&S!==void 0&&v.push(S)}return v.length===0?(T(!1),!0):(e.value=!0,Promise.all(v).then(_=>{if(_===void 0||Array.isArray(_)===!1||_.length===0)return b===a&&T(!1),!0;const y=_.find(S=>S===!1||typeof S=="string");return b===a&&T(y!==void 0,y),y===void 0},_=>(b===a&&(console.error(_),T(!0)),!1)))}function g(w){c.value===!0&&n.lazyRules!=="ondemand"&&(o.value===!0||n.lazyRules!==!0&&w!==!0)&&m()}const m=Na(p,0);return et(()=>{l!==void 0&&l(),m.cancel()}),Object.assign(i,{resetValidation:d,validate:p}),Pu(i,"hasError",()=>h.value),{isDirtyModel:o,hasRules:u,hasError:h,errorMessage:f,validate:p,resetValidation:d}}const qo=/^on[A-Z]/;function wc(t,e){const n={listeners:Q({}),attributes:Q({})};function i(){const r={},s={};for(const o in t)o!=="class"&&o!=="style"&&qo.test(o)===!1&&(r[o]=t[o]);for(const o in e.props)qo.test(o)===!0&&(s[o]=e.props[o]);n.attributes.value=r,n.listeners.value=s}return Ea(i),i(),n}let as,Ui=0;const Be=new Array(256);for(let t=0;t<256;t++)Be[t]=(t+256).toString(16).substring(1);const Sc=(()=>{const t=typeof crypto!="undefined"?crypto:typeof window!="undefined"?window.crypto||window.msCrypto:void 0;if(t!==void 0){if(t.randomBytes!==void 0)return t.randomBytes;if(t.getRandomValues!==void 0)return e=>{const n=new Uint8Array(e);return t.getRandomValues(n),n}}return e=>{const n=[];for(let i=e;i>0;i--)n.push(Math.floor(Math.random()*256));return n}})(),Bo=4096;function Tc(){(as===void 0||Ui+16>Bo)&&(Ui=0,as=Sc(Bo));const t=Array.prototype.slice.call(as,Ui,Ui+=16);return t[6]=t[6]&15|64,t[8]=t[8]&63|128,Be[t[0]]+Be[t[1]]+Be[t[2]]+Be[t[3]]+"-"+Be[t[4]]+Be[t[5]]+"-"+Be[t[6]]+Be[t[7]]+"-"+Be[t[8]]+Be[t[9]]+"-"+Be[t[10]]+Be[t[11]]+Be[t[12]]+Be[t[13]]+Be[t[14]]+Be[t[15]]}let Yt=[],oi=[];function Ra(t){oi=oi.filter(e=>e!==t)}function kc(t){Ra(t),oi.push(t)}function Lo(t){Ra(t),oi.length===0&&Yt.length>0&&(Yt[Yt.length-1](),Yt=[])}function Ci(t){oi.length===0?t():Yt.push(t)}function Cc(t){Yt=Yt.filter(e=>e!==t)}function Ts(t){return t===void 0?`f_${Tc()}`:t}function on(t){return t!=null&&(""+t).length>0}const xi={...jn,...yc,label:String,stackLabel:Boolean,hint:String,hideHint:Boolean,prefix:String,suffix:String,labelColor:String,color:String,bgColor:String,filled:Boolean,outlined:Boolean,borderless:Boolean,standout:[Boolean,String],square:Boolean,loading:Boolean,labelSlot:Boolean,bottomSlots:Boolean,hideBottomSpace:Boolean,rounded:Boolean,dense:Boolean,itemAligned:Boolean,counter:Boolean,clearable:Boolean,clearIcon:String,disable:Boolean,readonly:Boolean,autofocus:Boolean,for:String,maxlength:[Number,String]},Nr=["update:modelValue","clear","focus","blur","popup-show","popup-hide"];function Er(){const{props:t,attrs:e,proxy:n,vnode:i}=Ae();return{isDark:Un(t,n.$q),editable:D(()=>t.disable!==!0&&t.readonly!==!0),innerLoading:Q(!1),focused:Q(!1),hasPopupOpen:!1,splitAttrs:wc(e,i),targetUid:Q(Ts(t.for)),rootRef:Q(null),targetRef:Q(null),controlRef:Q(null)}}function Vr(t){const{props:e,emit:n,slots:i,attrs:r,proxy:s}=Ae(),{$q:o}=s;let a;t.hasValue===void 0&&(t.hasValue=D(()=>on(e.modelValue))),t.emitValue===void 0&&(t.emitValue=O=>{n("update:modelValue",O)}),t.controlEvents===void 0&&(t.controlEvents={onFocusin:A,onFocusout:I}),Object.assign(t,{clearValue:M,onControlFocusin:A,onControlFocusout:I,focus:y}),t.computedCounter===void 0&&(t.computedCounter=D(()=>{if(e.counter!==!1){const O=typeof e.modelValue=="string"||typeof e.modelValue=="number"?(""+e.modelValue).length:Array.isArray(e.modelValue)===!0?e.modelValue.length:0,P=e.maxlength!==void 0?e.maxlength:e.maxValues;return O+(P!==void 0?" / "+P:"")}}));const{isDirtyModel:l,hasRules:u,hasError:c,errorMessage:h,resetValidation:f}=bc(t.focused,t.innerLoading),d=t.floatingLabel!==void 0?D(()=>e.stackLabel===!0||t.focused.value===!0||t.floatingLabel.value===!0):D(()=>e.stackLabel===!0||t.focused.value===!0||t.hasValue.value===!0),p=D(()=>e.bottomSlots===!0||e.hint!==void 0||u.value===!0||e.counter===!0||e.error!==null),g=D(()=>e.filled===!0?"filled":e.outlined===!0?"outlined":e.borderless===!0?"borderless":e.standout?"standout":"standard"),m=D(()=>`q-field row no-wrap items-start q-field--${g.value}`+(t.fieldClass!==void 0?` ${t.fieldClass.value}`:"")+(e.rounded===!0?" q-field--rounded":"")+(e.square===!0?" q-field--square":"")+(d.value===!0?" q-field--float":"")+(b.value===!0?" q-field--labeled":"")+(e.dense===!0?" q-field--dense":"")+(e.itemAligned===!0?" q-field--item-aligned q-item-type":"")+(t.isDark.value===!0?" q-field--dark":"")+(t.getControl===void 0?" q-field--auto-height":"")+(t.focused.value===!0?" q-field--focused":"")+(c.value===!0?" q-field--error":"")+(c.value===!0||t.focused.value===!0?" q-field--highlighted":"")+(e.hideBottomSpace!==!0&&p.value===!0?" q-field--with-bottom":"")+(e.disable===!0?" q-field--disabled":e.readonly===!0?" q-field--readonly":"")),w=D(()=>"q-field__control relative-position row no-wrap"+(e.bgColor!==void 0?` bg-${e.bgColor}`:"")+(c.value===!0?" text-negative":typeof e.standout=="string"&&e.standout.length>0&&t.focused.value===!0?` ${e.standout}`:e.color!==void 0?` text-${e.color}`:"")),b=D(()=>e.labelSlot===!0||e.label!==void 0),C=D(()=>"q-field__label no-pointer-events absolute ellipsis"+(e.labelColor!==void 0&&c.value!==!0?` text-${e.labelColor}`:"")),T=D(()=>({id:t.targetUid.value,editable:t.editable.value,focused:t.focused.value,floatingLabel:d.value,modelValue:e.modelValue,emitValue:t.emitValue})),v=D(()=>{const O={for:t.targetUid.value};return e.disable===!0?O["aria-disabled"]="true":e.readonly===!0&&(O["aria-readonly"]="true"),O});re(()=>e.for,O=>{t.targetUid.value=Ts(O)});function _(){const O=document.activeElement;let P=t.targetRef!==void 0&&t.targetRef.value;P&&(O===null||O.id!==t.targetUid.value)&&(P.hasAttribute("tabindex")===!0||(P=P.querySelector("[tabindex]")),P&&P!==O&&P.focus({preventScroll:!0}))}function y(){Ci(_)}function S(){Cc(_);const O=document.activeElement;O!==null&&t.rootRef.value.contains(O)&&O.blur()}function A(O){clearTimeout(a),t.editable.value===!0&&t.focused.value===!1&&(t.focused.value=!0,n("focus",O))}function I(O,P){clearTimeout(a),a=setTimeout(()=>{document.hasFocus()===!0&&(t.hasPopupOpen===!0||t.controlRef===void 0||t.controlRef.value===null||t.controlRef.value.contains(document.activeElement)!==!1)||(t.focused.value===!0&&(t.focused.value=!1,n("blur",O)),P!==void 0&&P())})}function M(O){$e(O),o.platform.is.mobile!==!0?(t.targetRef!==void 0&&t.targetRef.value||t.rootRef.value).focus():t.rootRef.value.contains(document.activeElement)===!0&&document.activeElement.blur(),e.type==="file"&&(t.inputRef.value.value=null),n("update:modelValue",null),n("clear",e.modelValue),we(()=>{f(),o.platform.is.mobile!==!0&&(l.value=!1)})}function N(){const O=[];return i.prepend!==void 0&&O.push(B("div",{class:"q-field__prepend q-field__marginal row no-wrap items-center",key:"prepend",onClick:ct},i.prepend())),O.push(B("div",{class:"q-field__control-container col relative-position row no-wrap q-anchor--skip"},V())),c.value===!0&&e.noErrorIcon===!1&&O.push(W("error",[B(qt,{name:o.iconSet.field.error,color:"negative"})])),e.loading===!0||t.innerLoading.value===!0?O.push(W("inner-loading-append",i.loading!==void 0?i.loading():[B(Oa,{color:e.color})])):e.clearable===!0&&t.hasValue.value===!0&&t.editable.value===!0&&O.push(W("inner-clearable-append",[B(qt,{class:"q-field__focusable-action",tag:"button",name:e.clearIcon||o.iconSet.field.clear,tabindex:0,type:"button","aria-hidden":null,role:null,onClick:M})])),i.append!==void 0&&O.push(B("div",{class:"q-field__append q-field__marginal row no-wrap items-center",key:"append",onClick:ct},i.append())),t.getInnerAppend!==void 0&&O.push(W("inner-append",t.getInnerAppend())),t.getControlChild!==void 0&&O.push(t.getControlChild()),O}function V(){const O=[];return e.prefix!==void 0&&e.prefix!==null&&O.push(B("div",{class:"q-field__prefix no-pointer-events row items-center"},e.prefix)),t.getShadowControl!==void 0&&t.hasShadow.value===!0&&O.push(t.getShadowControl()),t.getControl!==void 0?O.push(t.getControl()):i.rawControl!==void 0?O.push(i.rawControl()):i.control!==void 0&&O.push(B("div",{ref:t.targetRef,class:"q-field__native row",tabindex:-1,...t.splitAttrs.attributes.value,"data-autofocus":e.autofocus===!0||void 0},i.control(T.value))),b.value===!0&&O.push(B("div",{class:C.value},Ye(i.label,e.label))),e.suffix!==void 0&&e.suffix!==null&&O.push(B("div",{class:"q-field__suffix no-pointer-events row items-center"},e.suffix)),O.concat(Ye(i.default))}function F(){let O,P;c.value===!0?h.value!==null?(O=[B("div",{role:"alert"},h.value)],P=`q--slot-error-${h.value}`):(O=Ye(i.error),P="q--slot-error"):(e.hideHint!==!0||t.focused.value===!0)&&(e.hint!==void 0?(O=[B("div",e.hint)],P=`q--slot-hint-${e.hint}`):(O=Ye(i.hint),P="q--slot-hint"));const L=e.counter===!0||i.counter!==void 0;if(e.hideBottomSpace===!0&&L===!1&&O===void 0)return;const x=B("div",{key:P,class:"q-field__messages col"},O);return B("div",{class:"q-field__bottom row items-start q-field__bottom--"+(e.hideBottomSpace!==!0?"animated":"stale"),onClick:ct},[e.hideBottomSpace===!0?x:B(si,{name:"q-transition--field-message"},()=>x),L===!0?B("div",{class:"q-field__counter"},i.counter!==void 0?i.counter():t.computedCounter.value):null])}function W(O,P){return P===null?null:B("div",{key:O,class:"q-field__append q-field__marginal row no-wrap items-center q-anchor--skip"},P)}let j=!1;return ki(()=>{j=!0}),Rs(()=>{j===!0&&e.autofocus===!0&&s.focus()}),fn(()=>{Ru.value===!0&&e.for===void 0&&(t.targetUid.value=Ts()),e.autofocus===!0&&s.focus()}),et(()=>{clearTimeout(a)}),Object.assign(s,{focus:y,blur:S}),function(){const P=t.getControl===void 0&&i.control===void 0?{...t.splitAttrs.attributes.value,"data-autofocus":e.autofocus===!0||void 0,...v.value}:v.value;return B("label",{ref:t.rootRef,class:[m.value,r.class],style:r.style,...P},[i.before!==void 0?B("div",{class:"q-field__before q-field__marginal row no-wrap items-center",onClick:ct},i.before()):null,B("div",{class:"q-field__inner relative-position col self-stretch"},[B("div",{ref:t.controlRef,class:w.value,tabindex:-1,...t.controlEvents},N()),p.value===!0?F():null]),i.after!==void 0?B("div",{class:"q-field__after q-field__marginal row no-wrap items-center",onClick:ct},i.after()):null])}}const Ls={name:String};function js(t){return D(()=>t.name||t.for)}function An(t,e,n,i){const r=[];return t.forEach(s=>{i(s)===!0?r.push(s):e.push({failedPropValidation:n,file:s})}),r}function Wi(t){t&&t.dataTransfer&&(t.dataTransfer.dropEffect="copy"),$e(t)}const xc={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},Ac=["rejected"];function Ic({editable:t,dnd:e,getFileInput:n,addFilesToQueue:i}){const{props:r,emit:s,proxy:o}=Ae(),a=Q(null),l=D(()=>r.accept!==void 0?r.accept.split(",").map(b=>(b=b.trim(),b==="*"?"*/":(b.endsWith("/*")&&(b=b.slice(0,b.length-1)),b.toUpperCase()))):null),u=D(()=>parseInt(r.maxFiles,10)),c=D(()=>parseInt(r.maxTotalSize,10));function h(b){if(t.value)if(b!==Object(b)&&(b={target:null}),b.target!==null&&b.target.matches('input[type="file"]')===!0)b.clientX===0&&b.clientY===0&&At(b);else{const C=n();C&&C!==b.target&&C.click(b)}}function f(b){t.value&&b&&i(null,b)}function d(b,C,T,v){let _=Array.from(C||b.target.files);const y=[],S=()=>{y.length>0&&s("rejected",y)};if(r.accept!==void 0&&l.value.indexOf("*/")===-1&&(_=An(_,y,"accept",A=>l.value.some(I=>A.type.toUpperCase().startsWith(I)||A.name.toUpperCase().endsWith(I))),_.length===0))return S();if(r.maxFileSize!==void 0){const A=parseInt(r.maxFileSize,10);if(_=An(_,y,"max-file-size",I=>I.size<=A),_.length===0)return S()}if(r.multiple!==!0&&_.length>0&&(_=[_[0]]),_.forEach(A=>{A.__key=A.webkitRelativePath+A.lastModified+A.name+A.size}),v===!0){const A=T.map(I=>I.__key);_=An(_,y,"duplicate",I=>A.includes(I.__key)===!1)}if(_.length===0)return S();if(r.maxTotalSize!==void 0){let A=v===!0?T.reduce((I,M)=>I+M.size,0):0;if(_=An(_,y,"max-total-size",I=>(A+=I.size,A<=c.value)),_.length===0)return S()}if(typeof r.filter=="function"){const A=r.filter(_);_=An(_,y,"filter",I=>A.includes(I))}if(r.maxFiles!==void 0){let A=v===!0?T.length:0;if(_=An(_,y,"max-files",()=>(A++,A<=u.value)),_.length===0)return S()}if(S(),_.length>0)return _}function p(b){Wi(b),e.value!==!0&&(e.value=!0)}function g(b){$e(b),(b.relatedTarget!==null||ht.is.safari!==!0?b.relatedTarget!==a.value:document.elementsFromPoint(b.clientX,b.clientY).includes(a.value)===!1)===!0&&(e.value=!1)}function m(b){Wi(b);const C=b.dataTransfer.files;C.length>0&&i(null,C),e.value=!1}function w(b){if(e.value===!0)return B("div",{ref:a,class:`q-${b}__dnd absolute-full`,onDragenter:Wi,onDragover:Wi,onDragleave:g,onDrop:m})}return Object.assign(o,{pickFiles:h,addFiles:f}),{pickFiles:h,addFiles:f,onDragover:p,onDragleave:g,processFiles:d,getDndNode:w,maxFilesNumber:u,maxTotalSizeNumber:c}}function qa(t,e){function n(){const i=t.modelValue;try{const r="DataTransfer"in window?new DataTransfer:"ClipboardEvent"in window?new ClipboardEvent("").clipboardData:void 0;return Object(i)===i&&("length"in i?Array.from(i):[i]).forEach(s=>{r.items.add(s)}),{files:r.files}}catch{return{files:void 0}}}return e===!0?D(()=>{if(t.type==="file")return n()}):D(n)}const jo=["B","KB","MB","GB","TB","PB"];function Oc(t){let e=0;for(;parseInt(t,10)>=1024&&e<jo.length-1;)t/=1024,++e;return`${t.toFixed(1)}${jo[e]}`}function Uo(t,e,n){if(n<=e)return e;const i=n-e+1;let r=e+(t-e)%i;return r<e&&(r=i+r),r===0?0:r}var Mc=Le({name:"QFile",inheritAttrs:!1,props:{...xi,...Ls,...xc,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...Nr,...Ac],setup(t,{slots:e,emit:n,attrs:i}){const{proxy:r}=Ae(),s=Er(),o=Q(null),a=Q(!1),l=js(t),{pickFiles:u,onDragover:c,onDragleave:h,processFiles:f,getDndNode:d}=Ic({editable:s.editable,dnd:a,getFileInput:N,addFilesToQueue:V}),p=qa(t),g=D(()=>Object(t.modelValue)===t.modelValue?"length"in t.modelValue?Array.from(t.modelValue):[t.modelValue]:[]),m=D(()=>on(g.value)),w=D(()=>g.value.map(O=>O.name).join(", ")),b=D(()=>Oc(g.value.reduce((O,P)=>O+P.size,0))),C=D(()=>({totalSize:b.value,filesNumber:g.value.length,maxFiles:t.maxFiles})),T=D(()=>({tabindex:-1,type:"file",title:"",accept:t.accept,capture:t.capture,name:l.value,...i,id:s.targetUid.value,disabled:s.editable.value!==!0})),v=D(()=>"q-file q-field--auto-height"+(a.value===!0?" q-file--dnd":"")),_=D(()=>t.multiple===!0&&t.append===!0);function y(O){const P=g.value.slice();P.splice(O,1),A(P)}function S(O){const P=g.value.findIndex(O);P>-1&&y(P)}function A(O){n("update:modelValue",t.multiple===!0?O:O[0])}function I(O){O.keyCode===13&&ct(O)}function M(O){(O.keyCode===13||O.keyCode===32)&&u(O)}function N(){return o.value}function V(O,P){const L=f(O,P,g.value,_.value),x=N();x!=null&&(x.value=""),L!==void 0&&((t.multiple===!0?t.modelValue&&L.every(E=>g.value.includes(E)):t.modelValue===L[0])||A(_.value===!0?g.value.concat(L):L))}function F(){return[B("input",{class:[t.inputClass,"q-file__filler"],style:t.inputStyle})]}function W(){if(e.file!==void 0)return g.value.length===0?F():g.value.map((P,L)=>e.file({index:L,file:P,ref:this}));if(e.selected!==void 0)return g.value.length===0?F():e.selected({files:g.value,ref:this});if(t.useChips===!0)return g.value.length===0?F():g.value.map((P,L)=>B(Pa,{key:"file-"+L,removable:s.editable.value,dense:!0,textColor:t.color,tabindex:t.tabindex,onRemove:()=>{y(L)}},()=>B("span",{class:"ellipsis",textContent:P.name})));const O=t.displayValue!==void 0?t.displayValue:w.value;return O.length>0?[B("div",{class:t.inputClass,style:t.inputStyle,textContent:O})]:F()}function j(){const O={ref:o,...T.value,...p.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:V};return t.multiple===!0&&(O.multiple=!0),B("input",O)}return Object.assign(s,{fieldClass:v,emitValue:A,hasValue:m,inputRef:o,innerValue:g,floatingLabel:D(()=>m.value===!0||on(t.displayValue)),computedCounter:D(()=>{if(t.counterLabel!==void 0)return t.counterLabel(C.value);const O=t.maxFiles;return`${g.value.length}${O!==void 0?" / "+O:""} (${b.value})`}),getControlChild:()=>d("file"),getControl:()=>{const O={ref:s.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:t.tabindex};return s.editable.value===!0&&Object.assign(O,{onDragover:c,onDragleave:h,onKeydown:I,onKeyup:M}),B("div",O,[j()].concat(W()))}}),Object.assign(r,{removeAtIndex:y,removeFile:S,getNativeElement:()=>o.value}),Vr(s)}}),Nc=Le({name:"QCardActions",props:{...qu,vertical:Boolean},setup(t,{slots:e}){const n=Bu(t),i=D(()=>`q-card__actions ${n.value} q-card__actions--${t.vertical===!0?"vert column":"horiz row"}`);return()=>B("div",{class:i.value},Ye(e.default))}}),ls=Le({name:"QCard",props:{...jn,tag:{type:String,default:"div"},square:Boolean,flat:Boolean,bordered:Boolean},setup(t,{slots:e}){const{proxy:{$q:n}}=Ae(),i=Un(t,n),r=D(()=>"q-card"+(i.value===!0?" q-card--dark q-dark":"")+(t.bordered===!0?" q-card--bordered":"")+(t.square===!0?" q-card--square no-border-radius":"")+(t.flat===!0?" q-card--flat no-shadow":""));return()=>B(t.tag,{class:r.value},Ye(e.default))}});const Wo={date:"####/##/##",datetime:"####/##/## ##:##",time:"##:##",fulltime:"##:##:##",phone:"(###) ### - ####",card:"#### #### #### ####"},nr={"#":{pattern:"[\\d]",negate:"[^\\d]"},S:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]"},N:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]"},A:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]",transform:t=>t.toLocaleUpperCase()},a:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]",transform:t=>t.toLocaleLowerCase()},X:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]",transform:t=>t.toLocaleUpperCase()},x:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]",transform:t=>t.toLocaleLowerCase()}},Ba=Object.keys(nr);Ba.forEach(t=>{nr[t].regex=new RegExp(nr[t].pattern)});const Ec=new RegExp("\\\\([^.*+?^${}()|([\\]])|([.*+?^${}()|[\\]])|(["+Ba.join("")+"])|(.)","g"),$o=/[.*+?^${}()|[\]\\]/g,Ve=String.fromCharCode(1),Vc={mask:String,reverseFillMask:Boolean,fillMask:[Boolean,String],unmaskedValue:Boolean};function Dc(t,e,n,i){let r,s,o,a;const l=Q(null),u=Q(h());function c(){return t.autogrow===!0||["textarea","text","search","url","tel","password"].includes(t.type)}re(()=>t.type+t.autogrow,d),re(()=>t.mask,_=>{if(_!==void 0)p(u.value,!0);else{const y=T(u.value);d(),t.modelValue!==y&&e("update:modelValue",y)}}),re(()=>t.fillMask+t.reverseFillMask,()=>{l.value===!0&&p(u.value,!0)}),re(()=>t.unmaskedValue,()=>{l.value===!0&&p(u.value)});function h(){if(d(),l.value===!0){const _=b(T(t.modelValue));return t.fillMask!==!1?v(_):_}return t.modelValue}function f(_){if(_<r.length)return r.slice(-_);let y="",S=r;const A=S.indexOf(Ve);if(A>-1){for(let I=_-S.length;I>0;I--)y+=Ve;S=S.slice(0,A)+y+S.slice(A)}return S}function d(){if(l.value=t.mask!==void 0&&t.mask.length>0&&c(),l.value===!1){a=void 0,r="",s="";return}const _=Wo[t.mask]===void 0?t.mask:Wo[t.mask],y=typeof t.fillMask=="string"&&t.fillMask.length>0?t.fillMask.slice(0,1):"_",S=y.replace($o,"\\$&"),A=[],I=[],M=[];let N=t.reverseFillMask===!0,V="",F="";_.replace(Ec,(P,L,x,E,q)=>{if(E!==void 0){const $=nr[E];M.push($),F=$.negate,N===!0&&(I.push("(?:"+F+"+)?("+$.pattern+"+)?(?:"+F+"+)?("+$.pattern+"+)?"),N=!1),I.push("(?:"+F+"+)?("+$.pattern+")?")}else if(x!==void 0)V="\\"+(x==="\\"?"":x),M.push(x),A.push("([^"+V+"]+)?"+V+"?");else{const $=L!==void 0?L:q;V=$==="\\"?"\\\\\\\\":$.replace($o,"\\\\$&"),M.push($),A.push("([^"+V+"]+)?"+V+"?")}});const W=new RegExp("^"+A.join("")+"("+(V===""?".":"[^"+V+"]")+"+)?"+(V===""?"":"["+V+"]*")+"$"),j=I.length-1,O=I.map((P,L)=>L===0&&t.reverseFillMask===!0?new RegExp("^"+S+"*"+P):L===j?new RegExp("^"+P+"("+(F===""?".":F)+"+)?"+(t.reverseFillMask===!0?"$":S+"*")):new RegExp("^"+P));o=M,a=P=>{const L=W.exec(P);L!==null&&(P=L.slice(1).join(""));const x=[],E=O.length;for(let q=0,$=P;q<E;q++){const ee=O[q].exec($);if(ee===null)break;$=$.slice(ee.shift().length),x.push(...ee)}return x.length>0?x.join(""):P},r=M.map(P=>typeof P=="string"?P:Ve).join(""),s=r.split(Ve).join(y)}function p(_,y,S){const A=i.value,I=A.selectionEnd,M=A.value.length-I,N=T(_);y===!0&&d();const V=b(N),F=t.fillMask!==!1?v(V):V,W=u.value!==F;A.value!==F&&(A.value=F),W===!0&&(u.value=F),document.activeElement===A&&we(()=>{if(F===s){const O=t.reverseFillMask===!0?s.length:0;A.setSelectionRange(O,O,"forward");return}if(S==="insertFromPaste"&&t.reverseFillMask!==!0){const O=I-1;m.right(A,O,O);return}if(["deleteContentBackward","deleteContentForward"].indexOf(S)>-1){const O=t.reverseFillMask===!0?I===0?F.length>V.length?1:0:Math.max(0,F.length-(F===s?0:Math.min(V.length,M)+1))+1:I;A.setSelectionRange(O,O,"forward");return}if(t.reverseFillMask===!0)if(W===!0){const O=Math.max(0,F.length-(F===s?0:Math.min(V.length,M+1)));O===1&&I===1?A.setSelectionRange(O,O,"forward"):m.rightReverse(A,O,O)}else{const O=F.length-M;A.setSelectionRange(O,O,"backward")}else if(W===!0){const O=Math.max(0,r.indexOf(Ve),Math.min(V.length,I)-1);m.right(A,O,O)}else{const O=I-1;m.right(A,O,O)}});const j=t.unmaskedValue===!0?T(F):F;String(t.modelValue)!==j&&n(j,!0)}function g(_,y,S){const A=b(T(_.value));y=Math.max(0,r.indexOf(Ve),Math.min(A.length,y)),_.setSelectionRange(y,S,"forward")}const m={left(_,y,S,A){const I=r.slice(y-1).indexOf(Ve)===-1;let M=Math.max(0,y-1);for(;M>=0;M--)if(r[M]===Ve){y=M,I===!0&&y++;break}if(M<0&&r[y]!==void 0&&r[y]!==Ve)return m.right(_,0,0);y>=0&&_.setSelectionRange(y,A===!0?S:y,"backward")},right(_,y,S,A){const I=_.value.length;let M=Math.min(I,S+1);for(;M<=I;M++)if(r[M]===Ve){S=M;break}else r[M-1]===Ve&&(S=M);if(M>I&&r[S-1]!==void 0&&r[S-1]!==Ve)return m.left(_,I,I);_.setSelectionRange(A?y:S,S,"forward")},leftReverse(_,y,S,A){const I=f(_.value.length);let M=Math.max(0,y-1);for(;M>=0;M--)if(I[M-1]===Ve){y=M;break}else if(I[M]===Ve&&(y=M,M===0))break;if(M<0&&I[y]!==void 0&&I[y]!==Ve)return m.rightReverse(_,0,0);y>=0&&_.setSelectionRange(y,A===!0?S:y,"backward")},rightReverse(_,y,S,A){const I=_.value.length,M=f(I),N=M.slice(0,S+1).indexOf(Ve)===-1;let V=Math.min(I,S+1);for(;V<=I;V++)if(M[V-1]===Ve){S=V,S>0&&N===!0&&S--;break}if(V>I&&M[S-1]!==void 0&&M[S-1]!==Ve)return m.leftReverse(_,I,I);_.setSelectionRange(A===!0?y:S,S,"forward")}};function w(_){if(Va(_)===!0)return;const y=i.value,S=y.selectionStart,A=y.selectionEnd;if(_.keyCode===37||_.keyCode===39){const I=m[(_.keyCode===39?"right":"left")+(t.reverseFillMask===!0?"Reverse":"")];_.preventDefault(),I(y,S,A,_.shiftKey)}else _.keyCode===8&&t.reverseFillMask!==!0&&S===A?m.left(y,S,A,!0):_.keyCode===46&&t.reverseFillMask===!0&&S===A&&m.rightReverse(y,S,A,!0)}function b(_){if(_==null||_==="")return"";if(t.reverseFillMask===!0)return C(_);const y=o;let S=0,A="";for(let I=0;I<y.length;I++){const M=_[S],N=y[I];if(typeof N=="string")A+=N,M===N&&S++;else if(M!==void 0&&N.regex.test(M))A+=N.transform!==void 0?N.transform(M):M,S++;else return A}return A}function C(_){const y=o,S=r.indexOf(Ve);let A=_.length-1,I="";for(let M=y.length-1;M>=0&&A>-1;M--){const N=y[M];let V=_[A];if(typeof N=="string")I=N+I,V===N&&A--;else if(V!==void 0&&N.regex.test(V))do I=(N.transform!==void 0?N.transform(V):V)+I,A--,V=_[A];while(S===M&&V!==void 0&&N.regex.test(V));else return I}return I}function T(_){return typeof _!="string"||a===void 0?typeof _=="number"?a(""+_):_:a(_)}function v(_){return s.length-_.length<=0?_:t.reverseFillMask===!0&&_.length>0?s.slice(0,-_.length)+_:_+s.slice(_.length)}return{innerValue:u,hasMask:l,moveCursorForPaste:g,updateMaskValue:p,onMaskedKeydown:w}}const Fc=/[\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uff9f\u4e00-\u9faf\u3400-\u4dbf]/,Pc=/[\u4e00-\u9fff\u3400-\u4dbf\u{20000}-\u{2a6df}\u{2a700}-\u{2b73f}\u{2b740}-\u{2b81f}\u{2b820}-\u{2ceaf}\uf900-\ufaff\u3300-\u33ff\ufe30-\ufe4f\uf900-\ufaff\u{2f800}-\u{2fa1f}]/u,Rc=/[\u3131-\u314e\u314f-\u3163\uac00-\ud7a3]/,qc=/[a-z0-9_ -]$/i;function La(t){return function(n){if(n.type==="compositionend"||n.type==="change"){if(n.target.qComposing!==!0)return;n.target.qComposing=!1,t(n)}else n.type==="compositionupdate"&&n.target.qComposing!==!0&&typeof n.data=="string"&&(ht.is.firefox===!0?qc.test(n.data)===!1:Fc.test(n.data)===!0||Pc.test(n.data)===!0||Rc.test(n.data)===!0)===!0&&(n.target.qComposing=!0)}}var us=Le({name:"QInput",inheritAttrs:!1,props:{...xi,...Vc,...Ls,modelValue:{required:!1},shadowText:String,type:{type:String,default:"text"},debounce:[String,Number],autogrow:Boolean,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...Nr,"paste","change"],setup(t,{emit:e,attrs:n}){const{proxy:i}=Ae(),{$q:r}=i,s={};let o=NaN,a,l,u,c;const h=Q(null),f=js(t),{innerValue:d,hasMask:p,moveCursorForPaste:g,updateMaskValue:m,onMaskedKeydown:w}=Dc(t,e,F,h),b=qa(t,!0),C=D(()=>on(d.value)),T=La(V),v=Er(),_=D(()=>t.type==="textarea"||t.autogrow===!0),y=D(()=>_.value===!0||["text","search","url","tel","password"].includes(t.type)),S=D(()=>{const x={...v.splitAttrs.listeners.value,onInput:V,onPaste:N,onChange:j,onBlur:O,onFocus:At};return x.onCompositionstart=x.onCompositionupdate=x.onCompositionend=T,p.value===!0&&(x.onKeydown=w),t.autogrow===!0&&(x.onAnimationend=W),x}),A=D(()=>{const x={tabindex:0,"data-autofocus":t.autofocus===!0||void 0,rows:t.type==="textarea"?6:void 0,"aria-label":t.label,name:f.value,...v.splitAttrs.attributes.value,id:v.targetUid.value,maxlength:t.maxlength,disabled:t.disable===!0,readonly:t.readonly===!0};return _.value===!1&&(x.type=t.type),t.autogrow===!0&&(x.rows=1),x});re(()=>t.type,()=>{h.value&&(h.value.value=t.modelValue)}),re(()=>t.modelValue,x=>{if(p.value===!0){if(l===!0&&(l=!1,String(x)===o))return;m(x)}else d.value!==x&&(d.value=x,t.type==="number"&&s.hasOwnProperty("value")===!0&&(a===!0?a=!1:delete s.value));t.autogrow===!0&&we(W)}),re(()=>t.autogrow,x=>{x===!0?we(W):h.value!==null&&n.rows>0&&(h.value.style.height="auto")}),re(()=>t.dense,()=>{t.autogrow===!0&&we(W)});function I(){Ci(()=>{const x=document.activeElement;h.value!==null&&h.value!==x&&(x===null||x.id!==v.targetUid.value)&&h.value.focus({preventScroll:!0})})}function M(){h.value!==null&&h.value.select()}function N(x){if(p.value===!0&&t.reverseFillMask!==!0){const E=x.target;g(E,E.selectionStart,E.selectionEnd)}e("paste",x)}function V(x){if(!x||!x.target)return;if(t.type==="file"){e("update:modelValue",x.target.files);return}const E=x.target.value;if(x.target.qComposing===!0){s.value=E;return}if(p.value===!0)m(E,!1,x.inputType);else if(F(E),y.value===!0&&x.target===document.activeElement){const{selectionStart:q,selectionEnd:$}=x.target;q!==void 0&&$!==void 0&&we(()=>{x.target===document.activeElement&&E.indexOf(x.target.value)===0&&x.target.setSelectionRange(q,$)})}t.autogrow===!0&&W()}function F(x,E){c=()=>{t.type!=="number"&&s.hasOwnProperty("value")===!0&&delete s.value,t.modelValue!==x&&o!==x&&(o=x,E===!0&&(l=!0),e("update:modelValue",x),we(()=>{o===x&&(o=NaN)})),c=void 0},t.type==="number"&&(a=!0,s.value=x),t.debounce!==void 0?(clearTimeout(u),s.value=x,u=setTimeout(c,t.debounce)):c()}function W(){requestAnimationFrame(()=>{const x=h.value;if(x!==null){const E=x.parentNode.style,{overflow:q}=x.style;r.platform.is.firefox!==!0&&(x.style.overflow="hidden"),x.style.height="1px",E.marginBottom=x.scrollHeight-1+"px",x.style.height=x.scrollHeight+"px",x.style.overflow=q,E.marginBottom=""}})}function j(x){T(x),clearTimeout(u),c!==void 0&&c(),e("change",x.target.value)}function O(x){x!==void 0&&At(x),clearTimeout(u),c!==void 0&&c(),a=!1,l=!1,delete s.value,t.type!=="file"&&setTimeout(()=>{h.value!==null&&(h.value.value=d.value!==void 0?d.value:"")})}function P(){return s.hasOwnProperty("value")===!0?s.value:d.value!==void 0?d.value:""}et(()=>{O()}),fn(()=>{t.autogrow===!0&&W()}),Object.assign(v,{innerValue:d,fieldClass:D(()=>`q-${_.value===!0?"textarea":"input"}`+(t.autogrow===!0?" q-textarea--autogrow":"")),hasShadow:D(()=>t.type!=="file"&&typeof t.shadowText=="string"&&t.shadowText.length>0),inputRef:h,emitValue:F,hasValue:C,floatingLabel:D(()=>C.value===!0||on(t.displayValue)),getControl:()=>B(_.value===!0?"textarea":"input",{ref:h,class:["q-field__native q-placeholder",t.inputClass],style:t.inputStyle,...A.value,...S.value,...t.type!=="file"?{value:P()}:b.value}),getShadowControl:()=>B("div",{class:"q-field__native q-field__shadow absolute-bottom no-pointer-events"+(_.value===!0?"":" text-no-wrap")},[B("span",{class:"invisible"},P()),B("span",t.shadowText)])});const L=Vr(v);return Object.assign(i,{focus:I,select:M,getNativeElement:()=>h.value}),L}}),Bc=Le({name:"QField",inheritAttrs:!1,props:xi,emits:Nr,setup(){return Vr(Er())}}),Lc=Le({name:"QItem",props:{...jn,...Lu,tag:{type:String,default:"div"},active:{type:Boolean,default:null},clickable:Boolean,dense:Boolean,insetLevel:Number,tabindex:[String,Number],focused:Boolean,manualFocus:Boolean},emits:["click","keyup"],setup(t,{slots:e,emit:n}){const{proxy:{$q:i}}=Ae(),r=Un(t,i),{hasLink:s,linkAttrs:o,linkClass:a,linkTag:l,navigateOnClick:u}=ju(),c=Q(null),h=Q(null),f=D(()=>t.clickable===!0||s.value===!0||t.tag==="label"),d=D(()=>t.disable!==!0&&f.value===!0),p=D(()=>"q-item q-item-type row no-wrap"+(t.dense===!0?" q-item--dense":"")+(r.value===!0?" q-item--dark":"")+(s.value===!0&&t.active===null?a.value:t.active===!0?` q-item--active${t.activeClass!==void 0?` ${t.activeClass}`:""}`:"")+(t.disable===!0?" disabled":"")+(d.value===!0?" q-item--clickable q-link cursor-pointer "+(t.manualFocus===!0?"q-manual-focusable":"q-focusable q-hoverable")+(t.focused===!0?" q-manual-focusable--focused":""):"")),g=D(()=>{if(t.insetLevel===void 0)return null;const C=i.lang.rtl===!0?"Right":"Left";return{["padding"+C]:16+t.insetLevel*56+"px"}});function m(C){d.value===!0&&(h.value!==null&&(C.qKeyEvent!==!0&&document.activeElement===c.value?h.value.focus():document.activeElement===h.value&&c.value.focus()),u(C))}function w(C){if(d.value===!0&&Or(C,13)===!0){$e(C),C.qKeyEvent=!0;const T=new MouseEvent("click",C);T.qKeyEvent=!0,c.value.dispatchEvent(T)}n("keyup",C)}function b(){const C=Uu(e.default,[]);return d.value===!0&&C.unshift(B("div",{class:"q-focus-helper",tabindex:-1,ref:h})),C}return()=>{const C={ref:c,class:p.value,style:g.value,role:"listitem",onClick:m,onKeyup:w};return d.value===!0?(C.tabindex=t.tabindex||"0",Object.assign(C,o.value)):f.value===!0&&(C["aria-disabled"]="true"),B(l.value,C,b())}}}),jc=Le({name:"QItemSection",props:{avatar:Boolean,thumbnail:Boolean,side:Boolean,top:Boolean,noWrap:Boolean},setup(t,{slots:e}){const n=D(()=>`q-item__section column q-item__section--${t.avatar===!0||t.side===!0||t.thumbnail===!0?"side":"main"}`+(t.top===!0?" q-item__section--top justify-start":" justify-center")+(t.avatar===!0?" q-item__section--avatar":"")+(t.thumbnail===!0?" q-item__section--thumbnail":"")+(t.noWrap===!0?" q-item__section--nowrap":""));return()=>B("div",{class:n.value},Ye(e.default))}}),Uc=Le({name:"QItemLabel",props:{overline:Boolean,caption:Boolean,header:Boolean,lines:[Number,String]},setup(t,{slots:e}){const n=D(()=>parseInt(t.lines,10)),i=D(()=>"q-item__label"+(t.overline===!0?" q-item__label--overline text-overline":"")+(t.caption===!0?" q-item__label--caption text-caption":"")+(t.header===!0?" q-item__label--header":"")+(n.value===1?" ellipsis":"")),r=D(()=>t.lines!==void 0&&n.value>1?{overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":n.value}:null);return()=>B("div",{style:r.value,class:i.value},Ye(e.default))}});function Wc(){if(window.getSelection!==void 0){const t=window.getSelection();t.empty!==void 0?t.empty():t.removeAllRanges!==void 0&&(t.removeAllRanges(),Wu.is.mobile!==!0&&t.addRange(document.createRange()))}else document.selection!==void 0&&document.selection.empty()}const $c={target:{default:!0},noParentEvent:Boolean,contextMenu:Boolean};function zc({showing:t,avoidEmit:e,configureAnchorEl:n}){const{props:i,proxy:r,emit:s}=Ae(),o=Q(null);let a;function l(d){return o.value===null?!1:d===void 0||d.touches===void 0||d.touches.length<=1}const u={};n===void 0&&(Object.assign(u,{hide(d){r.hide(d)},toggle(d){r.toggle(d),d.qAnchorHandled=!0},toggleKey(d){Or(d,13)===!0&&u.toggle(d)},contextClick(d){r.hide(d),ct(d),we(()=>{r.show(d),d.qAnchorHandled=!0})},prevent:ct,mobileTouch(d){if(u.mobileCleanup(d),l(d)!==!0)return;r.hide(d),o.value.classList.add("non-selectable");const p=d.target;No(u,"anchor",[[p,"touchmove","mobileCleanup","passive"],[p,"touchend","mobileCleanup","passive"],[p,"touchcancel","mobileCleanup","passive"],[o.value,"contextmenu","prevent","notPassive"]]),a=setTimeout(()=>{r.show(d),d.qAnchorHandled=!0},300)},mobileCleanup(d){o.value.classList.remove("non-selectable"),clearTimeout(a),t.value===!0&&d!==void 0&&Wc()}}),n=function(d=i.contextMenu){if(i.noParentEvent===!0||o.value===null)return;let p;d===!0?r.$q.platform.is.mobile===!0?p=[[o.value,"touchstart","mobileTouch","passive"]]:p=[[o.value,"mousedown","hide","passive"],[o.value,"contextmenu","contextClick","notPassive"]]:p=[[o.value,"click","toggle","passive"],[o.value,"keyup","toggleKey","passive"]],No(u,"anchor",p)});function c(){$u(u,"anchor")}function h(d){for(o.value=d;o.value.classList.contains("q-anchor--skip");)o.value=o.value.parentNode;n()}function f(){if(i.target===!1||i.target===""||r.$el.parentNode===null)o.value=null;else if(i.target===!0)h(r.$el.parentNode);else{let d=i.target;if(typeof i.target=="string")try{d=document.querySelector(i.target)}catch{d=void 0}d!=null?(o.value=d.$el||d,n()):(o.value=null,console.error(`Anchor: target "${i.target}" not found`))}}return re(()=>i.contextMenu,d=>{o.value!==null&&(c(),n(d))}),re(()=>i.target,()=>{o.value!==null&&c(),f()}),re(()=>i.noParentEvent,d=>{o.value!==null&&(d===!0?c():n())}),fn(()=>{f(),e!==!0&&i.modelValue===!0&&o.value===null&&s("update:modelValue",!1)}),et(()=>{clearTimeout(a),c()}),{anchorEl:o,canShow:l,anchorEvents:u}}function Hc(t,e){const n=Q(null);let i;function r(a,l){const u=`${l!==void 0?"add":"remove"}EventListener`,c=l!==void 0?l:i;a!==window&&a[u]("scroll",c,_t.passive),window[u]("scroll",c,_t.passive),i=l}function s(){n.value!==null&&(r(n.value),n.value=null)}const o=re(()=>t.noParentEvent,()=>{n.value!==null&&(s(),e())});return et(o),{localScrollTarget:n,unconfigureScrollTarget:s,changeScrollEvent:r}}const ja={modelValue:{type:Boolean,default:null},"onUpdate:modelValue":[Function,Array]},Ua=["before-show","show","before-hide","hide"];function Wa({showing:t,canShow:e,hideOnRouteChange:n,handleShow:i,handleHide:r,processOnMount:s}){const o=Ae(),{props:a,emit:l,proxy:u}=o;let c;function h(b){t.value===!0?p(b):f(b)}function f(b){if(a.disable===!0||b!==void 0&&b.qAnchorHandled===!0||e!==void 0&&e(b)!==!0)return;const C=a["onUpdate:modelValue"]!==void 0;C===!0&&(l("update:modelValue",!0),c=b,we(()=>{c===b&&(c=void 0)})),(a.modelValue===null||C===!1)&&d(b)}function d(b){t.value!==!0&&(t.value=!0,l("before-show",b),i!==void 0?i(b):l("show",b))}function p(b){if(a.disable===!0)return;const C=a["onUpdate:modelValue"]!==void 0;C===!0&&(l("update:modelValue",!1),c=b,we(()=>{c===b&&(c=void 0)})),(a.modelValue===null||C===!1)&&g(b)}function g(b){t.value!==!1&&(t.value=!1,l("before-hide",b),r!==void 0?r(b):l("hide",b))}function m(b){a.disable===!0&&b===!0?a["onUpdate:modelValue"]!==void 0&&l("update:modelValue",!1):b===!0!==t.value&&(b===!0?d:g)(c)}re(()=>a.modelValue,m),n!==void 0&&zu(o)===!0&&re(()=>u.$route.fullPath,()=>{n.value===!0&&t.value===!0&&p()}),s===!0&&fn(()=>{m(a.modelValue)});const w={show:f,hide:p,toggle:h};return Object.assign(u,w),w}const ni=[];function Gc(t,e){do{if(t.$options.name==="QMenu"){if(t.hide(e),t.$props.separateClosePopup===!0)return ns(t)}else if(t.__qPortalInnerRef!==void 0){const n=ns(t);return n!==void 0&&n.$options.name==="QPopupProxy"?(t.hide(e),n):t}t=ns(t)}while(t!=null)}function Zc(t){for(t=t.parent;t!=null;){if(t.type.name==="QGlobalDialog")return!0;if(t.type.name==="QDialog"||t.type.name==="QMenu")return!1;t=t.parent}return!1}function $a(t,e,n,i){const r=Q(!1),s=Q(!1);let o=null;const a={},l=i===!0&&Zc(t);function u(h){if(h===!0){Lo(a),s.value=!0;return}s.value=!1,r.value===!1&&(l===!1&&o===null&&(o=Gu()),r.value=!0,ni.push(t.proxy),kc(a))}function c(h){if(s.value=!1,h!==!0)return;Lo(a),r.value=!1;const f=ni.indexOf(t.proxy);f!==-1&&ni.splice(f,1),o!==null&&(Zu(o),o=null)}return Da(()=>{c(!0)}),t.proxy.__qPortalInnerRef=e,{showPortal:u,hidePortal:c,portalIsActive:r,portalIsAccessible:s,renderPortal:()=>l===!0?n():r.value===!0?[B(Hu,{to:o},n())]:void 0}}const za={transitionShow:{type:String,default:"fade"},transitionHide:{type:String,default:"fade"},transitionDuration:{type:[String,Number],default:300}};function Xc(t,e){const n=Q(e.value);return re(e,i=>{we(()=>{n.value=i})}),{transition:D(()=>"q-transition--"+(n.value===!0?t.transitionHide:t.transitionShow)),transitionStyle:D(()=>`--q-transition-duration: ${t.transitionDuration}ms`)}}function Ha(){let t;const e=Ae();function n(){t=void 0}return ki(n),et(n),{removeTick:n,registerTick(i){t=i,we(()=>{t===i&&(qs(e)===!1&&t(),t=void 0)})}}}function Ga(){let t;const e=Ae();function n(){clearTimeout(t)}return ki(n),et(n),{removeTimeout:n,registerTimeout(i,r){clearTimeout(t),qs(e)===!1&&(t=setTimeout(i,r))}}}const Jt=[];let Fn;function Qc(t){Fn=t.keyCode===27}function Yc(){Fn===!0&&(Fn=!1)}function Kc(t){Fn===!0&&(Fn=!1,Or(t,27)===!0&&Jt[Jt.length-1](t))}function Za(t){window[t]("keydown",Qc),window[t]("blur",Yc),window[t]("keyup",Kc),Fn=!1}function Xa(t){ht.is.desktop===!0&&(Jt.push(t),Jt.length===1&&Za("addEventListener"))}function ir(t){const e=Jt.indexOf(t);e>-1&&(Jt.splice(e,1),Jt.length===0&&Za("removeEventListener"))}const en=[];function Qa(t){en[en.length-1](t)}function Ya(t){ht.is.desktop===!0&&(en.push(t),en.length===1&&document.body.addEventListener("focusin",Qa))}function ks(t){const e=en.indexOf(t);e>-1&&(en.splice(e,1),en.length===0&&document.body.removeEventListener("focusin",Qa))}let Ka;const{notPassiveCapture:rr}=_t,tn=[];function sr(t){clearTimeout(Ka);const e=t.target;if(e===void 0||e.nodeType===8||e.classList.contains("no-pointer-events")===!0)return;let n=ni.length-1;for(;n>=0;){const i=ni[n].$;if(i.type.name!=="QDialog")break;if(i.props.seamless!==!0)return;n--}for(let i=tn.length-1;i>=0;i--){const r=tn[i];if((r.anchorEl.value===null||r.anchorEl.value.contains(e)===!1)&&(e===document.body||r.innerRef.value!==null&&r.innerRef.value.contains(e)===!1))t.qClickOutside=!0,r.onClickOutside(t);else return}}function Jc(t){tn.push(t),tn.length===1&&(document.addEventListener("mousedown",sr,rr),document.addEventListener("touchstart",sr,rr))}function zo(t){const e=tn.findIndex(n=>n===t);e>-1&&(tn.splice(e,1),tn.length===0&&(clearTimeout(Ka),document.removeEventListener("mousedown",sr,rr),document.removeEventListener("touchstart",sr,rr)))}let Ho,Go;function Zo(t){const e=t.split(" ");return e.length!==2?!1:["top","center","bottom"].includes(e[0])!==!0?(console.error("Anchor/Self position must start with one of top/center/bottom"),!1):["left","middle","right","start","end"].includes(e[1])!==!0?(console.error("Anchor/Self position must end with one of left/middle/right/start/end"),!1):!0}function eh(t){return t?!(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number"):!0}const Cs={"start#ltr":"left","start#rtl":"right","end#ltr":"right","end#rtl":"left"};["left","middle","right"].forEach(t=>{Cs[`${t}#ltr`]=t,Cs[`${t}#rtl`]=t});function Xo(t,e){const n=t.split(" ");return{vertical:n[0],horizontal:Cs[`${n[1]}#${e===!0?"rtl":"ltr"}`]}}function th(t,e){let{top:n,left:i,right:r,bottom:s,width:o,height:a}=t.getBoundingClientRect();return e!==void 0&&(n-=e[1],i-=e[0],s+=e[1],r+=e[0],o+=e[0],a+=e[1]),{top:n,left:i,right:r,bottom:s,width:o,height:a,middle:i+(r-i)/2,center:n+(s-n)/2}}function nh(t){return{top:0,center:t.offsetHeight/2,bottom:t.offsetHeight,left:0,middle:t.offsetWidth/2,right:t.offsetWidth}}function ih(t){if(ht.is.ios===!0&&window.visualViewport!==void 0){const a=document.body.style,{offsetLeft:l,offsetTop:u}=window.visualViewport;l!==Ho&&(a.setProperty("--q-pe-left",l+"px"),Ho=l),u!==Go&&(a.setProperty("--q-pe-top",u+"px"),Go=u)}let e;const{scrollLeft:n,scrollTop:i}=t.el;if(t.absoluteOffset===void 0)e=th(t.anchorEl,t.cover===!0?[0,0]:t.offset);else{const{top:a,left:l}=t.anchorEl.getBoundingClientRect(),u=a+t.absoluteOffset.top,c=l+t.absoluteOffset.left;e={top:u,left:c,width:1,height:1,right:c+1,center:u,middle:c,bottom:u+1}}let r={maxHeight:t.maxHeight,maxWidth:t.maxWidth,visibility:"visible"};(t.fit===!0||t.cover===!0)&&(r.minWidth=e.width+"px",t.cover===!0&&(r.minHeight=e.height+"px")),Object.assign(t.el.style,r);const s=nh(t.el),o={top:e[t.anchorOrigin.vertical]-s[t.selfOrigin.vertical],left:e[t.anchorOrigin.horizontal]-s[t.selfOrigin.horizontal]};rh(o,e,s,t.anchorOrigin,t.selfOrigin),r={top:o.top+"px",left:o.left+"px"},o.maxHeight!==void 0&&(r.maxHeight=o.maxHeight+"px",e.height>o.maxHeight&&(r.minHeight=r.maxHeight)),o.maxWidth!==void 0&&(r.maxWidth=o.maxWidth+"px",e.width>o.maxWidth&&(r.minWidth=r.maxWidth)),Object.assign(t.el.style,r),t.el.scrollTop!==i&&(t.el.scrollTop=i),t.el.scrollLeft!==n&&(t.el.scrollLeft=n)}function rh(t,e,n,i,r){const s=n.bottom,o=n.right,a=oc(),l=window.innerHeight-a,u=document.body.clientWidth;if(t.top<0||t.top+s>l)if(r.vertical==="center")t.top=e[i.vertical]>l/2?Math.max(0,l-s):0,t.maxHeight=Math.min(s,l);else if(e[i.vertical]>l/2){const c=Math.min(l,i.vertical==="center"?e.center:i.vertical===r.vertical?e.bottom:e.top);t.maxHeight=Math.min(s,c),t.top=Math.max(0,c-s)}else t.top=Math.max(0,i.vertical==="center"?e.center:i.vertical===r.vertical?e.top:e.bottom),t.maxHeight=Math.min(s,l-t.top);if(t.left<0||t.left+o>u)if(t.maxWidth=Math.min(o,u),r.horizontal==="middle")t.left=e[i.horizontal]>u/2?Math.max(0,u-o):0;else if(e[i.horizontal]>u/2){const c=Math.min(u,i.horizontal==="middle"?e.middle:i.horizontal===r.horizontal?e.right:e.left);t.maxWidth=Math.min(o,c),t.left=Math.max(0,c-t.maxWidth)}else t.left=Math.max(0,i.horizontal==="middle"?e.middle:i.horizontal===r.horizontal?e.left:e.right),t.maxWidth=Math.min(o,u-t.left)}var sh=Le({name:"QMenu",inheritAttrs:!1,props:{...$c,...ja,...jn,...za,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:Zo},self:{type:String,validator:Zo},offset:{type:Array,validator:eh},scrollTarget:{default:void 0},touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...Ua,"click","escape-key"],setup(t,{slots:e,emit:n,attrs:i}){let r=null,s,o,a;const l=Ae(),{proxy:u}=l,{$q:c}=u,h=Q(null),f=Q(!1),d=D(()=>t.persistent!==!0&&t.noRouteDismiss!==!0),p=Un(t,c),{registerTick:g,removeTick:m}=Ha(),{registerTimeout:w}=Ga(),{transition:b,transitionStyle:C}=Xc(t,f),{localScrollTarget:T,changeScrollEvent:v,unconfigureScrollTarget:_}=Hc(t,$),{anchorEl:y,canShow:S}=zc({showing:f}),{hide:A}=Wa({showing:f,canShow:S,handleShow:x,handleHide:E,hideOnRouteChange:d,processOnMount:!0}),{showPortal:I,hidePortal:M,renderPortal:N}=$a(l,h,R),V={anchorEl:y,innerRef:h,onClickOutside(U){if(t.persistent!==!0&&f.value===!0)return A(U),(U.type==="touchstart"||U.target.classList.contains("q-dialog__backdrop"))&&$e(U),!0}},F=D(()=>Xo(t.anchor||(t.cover===!0?"center middle":"bottom start"),c.lang.rtl)),W=D(()=>t.cover===!0?F.value:Xo(t.self||"top start",c.lang.rtl)),j=D(()=>(t.square===!0?" q-menu--square":"")+(p.value===!0?" q-menu--dark q-dark":"")),O=D(()=>t.autoClose===!0?{onClick:ee}:{}),P=D(()=>f.value===!0&&t.persistent!==!0);re(P,U=>{U===!0?(Xa(X),Jc(V)):(ir(X),zo(V))});function L(){Ci(()=>{let U=h.value;U&&U.contains(document.activeElement)!==!0&&(U=U.querySelector("[autofocus], [data-autofocus]")||U,U.focus({preventScroll:!0}))})}function x(U){if(r=t.noRefocus===!1?document.activeElement:null,Ya(K),I(),$(),s=void 0,U!==void 0&&(t.touchPosition||t.contextMenu)){const he=Xu(U);if(he.left!==void 0){const{top:Me,left:Re}=y.value.getBoundingClientRect();s={left:he.left-Re,top:he.top-Me}}}o===void 0&&(o=re(()=>c.screen.width+"|"+c.screen.height+"|"+t.self+"|"+t.anchor+"|"+c.lang.rtl,Y)),t.noFocus!==!0&&document.activeElement.blur(),g(()=>{Y(),t.noFocus!==!0&&L()}),w(()=>{c.platform.is.ios===!0&&(a=t.autoClose,h.value.click()),Y(),I(!0),n("show",U)},t.transitionDuration)}function E(U){m(),M(),q(!0),r!==null&&(U===void 0||U.qClickOutside!==!0)&&(r.focus(),r=null),w(()=>{M(!0),n("hide",U)},t.transitionDuration)}function q(U){s=void 0,o!==void 0&&(o(),o=void 0),(U===!0||f.value===!0)&&(ks(K),_(),zo(V),ir(X)),U!==!0&&(r=null)}function $(){(y.value!==null||t.scrollTarget!==void 0)&&(T.value=ac(y.value,t.scrollTarget),v(T.value,Y))}function ee(U){a!==!0?(Gc(u,U),n("click",U)):a=!1}function K(U){P.value===!0&&t.noFocus!==!0&&Fa(h.value,U.target)!==!0&&L()}function X(U){n("escape-key"),A(U)}function Y(){const U=h.value;U===null||y.value===null||ih({el:U,offset:t.offset,anchorEl:y.value,anchorOrigin:F.value,selfOrigin:W.value,absoluteOffset:s,fit:t.fit,cover:t.cover,maxHeight:t.maxHeight,maxWidth:t.maxWidth})}function R(){return B(si,{name:b.value,appear:!0},()=>f.value===!0?B("div",{role:"menu",...i,ref:h,tabindex:-1,class:["q-menu q-position-engine scroll"+j.value,i.class],style:[i.style,C.value],...O.value},Ye(e.default)):null)}return et(q),Object.assign(u,{focus:L,updatePosition:Y}),N}});function oh(t,e,n){let i;function r(){i!==void 0&&(Eo.remove(i),i=void 0)}return et(()=>{t.value===!0&&r()}),{removeFromHistory:r,addToHistory(){i={condition:()=>n.value===!0,handler:e},Eo.add(i)}}}let Kn=0,cs,hs,ei,ds=!1,Qo,Yo,In;function ah(t){lh(t)&&$e(t)}function lh(t){if(t.target===document.body||t.target.classList.contains("q-layout__backdrop"))return!0;const e=Qu(t),n=t.shiftKey&&!t.deltaX,i=!n&&Math.abs(t.deltaX)<=Math.abs(t.deltaY),r=n||i?t.deltaY:t.deltaX;for(let s=0;s<e.length;s++){const o=e[s];if(cc(o,i))return i?r<0&&o.scrollTop===0?!0:r>0&&o.scrollTop+o.clientHeight===o.scrollHeight:r<0&&o.scrollLeft===0?!0:r>0&&o.scrollLeft+o.clientWidth===o.scrollWidth}return!0}function Ko(t){t.target===document&&(document.scrollingElement.scrollTop=document.scrollingElement.scrollTop)}function $i(t){ds!==!0&&(ds=!0,requestAnimationFrame(()=>{ds=!1;const{height:e}=t.target,{clientHeight:n,scrollTop:i}=document.scrollingElement;(ei===void 0||e!==window.innerHeight)&&(ei=n-e,document.scrollingElement.scrollTop=i),i>ei&&(document.scrollingElement.scrollTop-=Math.ceil((i-ei)/8))}))}function Jo(t){const e=document.body,n=window.visualViewport!==void 0;if(t==="add"){const{overflowY:i,overflowX:r}=window.getComputedStyle(e);cs=lc(window),hs=uc(window),Qo=e.style.left,Yo=e.style.top,e.style.left=`-${cs}px`,e.style.top=`-${hs}px`,r!=="hidden"&&(r==="scroll"||e.scrollWidth>window.innerWidth)&&e.classList.add("q-body--force-scrollbar-x"),i!=="hidden"&&(i==="scroll"||e.scrollHeight>window.innerHeight)&&e.classList.add("q-body--force-scrollbar-y"),e.classList.add("q-body--prevent-scroll"),document.qScrollPrevented=!0,ht.is.ios===!0&&(n===!0?(window.scrollTo(0,0),window.visualViewport.addEventListener("resize",$i,_t.passiveCapture),window.visualViewport.addEventListener("scroll",$i,_t.passiveCapture),window.scrollTo(0,0)):window.addEventListener("scroll",Ko,_t.passiveCapture))}ht.is.desktop===!0&&ht.is.mac===!0&&window[`${t}EventListener`]("wheel",ah,_t.notPassive),t==="remove"&&(ht.is.ios===!0&&(n===!0?(window.visualViewport.removeEventListener("resize",$i,_t.passiveCapture),window.visualViewport.removeEventListener("scroll",$i,_t.passiveCapture)):window.removeEventListener("scroll",Ko,_t.passiveCapture)),e.classList.remove("q-body--prevent-scroll"),e.classList.remove("q-body--force-scrollbar-x"),e.classList.remove("q-body--force-scrollbar-y"),document.qScrollPrevented=!1,e.style.left=Qo,e.style.top=Yo,window.scrollTo(cs,hs),ei=void 0)}function uh(t){let e="add";if(t===!0){if(Kn++,In!==void 0){clearTimeout(In),In=void 0;return}if(Kn>1)return}else{if(Kn===0||(Kn--,Kn>0))return;if(e="remove",ht.is.ios===!0&&ht.is.nativeMobile===!0){clearTimeout(In),In=setTimeout(()=>{Jo(e),In=void 0},100);return}}Jo(e)}function ch(){let t;return{preventBodyScroll(e){e!==t&&(t!==void 0||e===!0)&&(t=e,uh(e))}}}let zi=0;const hh={standard:"fixed-full flex-center",top:"fixed-top justify-center",bottom:"fixed-bottom justify-center",right:"fixed-right items-center",left:"fixed-left items-center"},ea={standard:["scale","scale"],top:["slide-down","slide-up"],bottom:["slide-up","slide-down"],right:["slide-left","slide-right"],left:["slide-right","slide-left"]};var dh=Le({name:"QDialog",inheritAttrs:!1,props:{...ja,...za,transitionShow:String,transitionHide:String,persistent:Boolean,autoClose:Boolean,allowFocusOutside:Boolean,noEscDismiss:Boolean,noBackdropDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,noShake:Boolean,seamless:Boolean,maximized:Boolean,fullWidth:Boolean,fullHeight:Boolean,square:Boolean,position:{type:String,default:"standard",validator:t=>t==="standard"||["top","bottom","left","right"].includes(t)}},emits:[...Ua,"shake","click","escape-key"],setup(t,{slots:e,emit:n,attrs:i}){const r=Ae(),s=Q(null),o=Q(!1),a=Q(!1),l=Q(!1);let u,c=null,h,f;const d=D(()=>t.persistent!==!0&&t.noRouteDismiss!==!0&&t.seamless!==!0),{preventBodyScroll:p}=ch(),{registerTimeout:g}=Ga(),{registerTick:m,removeTick:w}=Ha(),{showPortal:b,hidePortal:C,portalIsAccessible:T,renderPortal:v}=$a(r,s,Y,!0),{hide:_}=Wa({showing:o,hideOnRouteChange:d,handleShow:O,handleHide:P,processOnMount:!0}),{addToHistory:y,removeFromHistory:S}=oh(o,_,d),A=D(()=>`q-dialog__inner flex no-pointer-events q-dialog__inner--${t.maximized===!0?"maximized":"minimized"} q-dialog__inner--${t.position} ${hh[t.position]}`+(l.value===!0?" q-dialog__inner--animating":"")+(t.fullWidth===!0?" q-dialog__inner--fullwidth":"")+(t.fullHeight===!0?" q-dialog__inner--fullheight":"")+(t.square===!0?" q-dialog__inner--square":"")),I=D(()=>"q-transition--"+(t.transitionShow===void 0?ea[t.position][0]:t.transitionShow)),M=D(()=>"q-transition--"+(t.transitionHide===void 0?ea[t.position][1]:t.transitionHide)),N=D(()=>a.value===!0?M.value:I.value),V=D(()=>`--q-transition-duration: ${t.transitionDuration}ms`),F=D(()=>o.value===!0&&t.seamless!==!0),W=D(()=>t.autoClose===!0?{onClick:ee}:{}),j=D(()=>[`q-dialog fullscreen no-pointer-events q-dialog--${F.value===!0?"modal":"seamless"}`,i.class]);re(o,R=>{we(()=>{a.value=R})}),re(()=>t.maximized,R=>{o.value===!0&&$(R)}),re(F,R=>{p(R),R===!0?(Ya(X),Xa(E)):(ks(X),ir(E))});function O(R){y(),c=t.noRefocus===!1&&document.activeElement!==null?document.activeElement:null,$(t.maximized),b(),l.value=!0,t.noFocus!==!0?(document.activeElement!==null&&document.activeElement.blur(),m(L)):w(),g(()=>{if(r.proxy.$q.platform.is.ios===!0){if(t.seamless!==!0&&document.activeElement){const{top:U,bottom:he}=document.activeElement.getBoundingClientRect(),{innerHeight:Me}=window,Re=window.visualViewport!==void 0?window.visualViewport.height:Me;U>0&&he>Re/2&&(document.scrollingElement.scrollTop=Math.min(document.scrollingElement.scrollHeight-Re,he>=Me?1/0:Math.ceil(document.scrollingElement.scrollTop+he-Re/2))),document.activeElement.scrollIntoView()}f=!0,s.value.click(),f=!1}b(!0),l.value=!1,n("show",R)},t.transitionDuration)}function P(R){w(),S(),q(!0),l.value=!0,C(),c!==null&&(c.focus(),c=null),g(()=>{C(!0),l.value=!1,n("hide",R)},t.transitionDuration)}function L(R){Ci(()=>{let U=s.value;U===null||U.contains(document.activeElement)===!0||(U=U.querySelector(R||"[autofocus], [data-autofocus]")||U,U.focus({preventScroll:!0}))})}function x(){L(),n("shake");const R=s.value;R!==null&&(R.classList.remove("q-animate--scale"),R.classList.add("q-animate--scale"),clearTimeout(u),u=setTimeout(()=>{s.value!==null&&(R.classList.remove("q-animate--scale"),L())},170))}function E(){t.seamless!==!0&&(t.persistent===!0||t.noEscDismiss===!0?t.maximized!==!0&&t.noShake!==!0&&x():(n("escape-key"),_()))}function q(R){clearTimeout(u),(R===!0||o.value===!0)&&($(!1),t.seamless!==!0&&(p(!1),ks(X),ir(E))),R!==!0&&(c=null)}function $(R){R===!0?h!==!0&&(zi<1&&document.body.classList.add("q-body--dialog"),zi++,h=!0):h===!0&&(zi<2&&document.body.classList.remove("q-body--dialog"),zi--,h=!1)}function ee(R){f!==!0&&(_(R),n("click",R))}function K(R){t.persistent!==!0&&t.noBackdropDismiss!==!0?_(R):t.noShake!==!0&&x()}function X(R){t.allowFocusOutside!==!0&&T.value===!0&&Fa(s.value,R.target)!==!0&&L('[tabindex]:not([tabindex="-1"])')}Object.assign(r.proxy,{focus:L,shake:x,__updateRefocusTarget(R){c=R||null}}),et(q);function Y(){return B("div",{role:"dialog","aria-modal":F.value===!0?"true":"false",...i,class:j.value},[B(si,{name:"q-transition--fade",appear:!0},()=>F.value===!0?B("div",{class:"q-dialog__backdrop fixed-full",style:V.value,"aria-hidden":"true",onMousedown:K}):null),B(si,{name:N.value,appear:!0},()=>o.value===!0?B("div",{ref:s,class:A.value,style:V.value,tabindex:-1,...W.value},Ye(e.default)):null)])}return v}});let or=!1;{const t=document.createElement("div");t.setAttribute("dir","rtl"),Object.assign(t.style,{width:"1px",height:"1px",overflow:"auto"});const e=document.createElement("div");Object.assign(e.style,{width:"1000px",height:"1px"}),document.body.appendChild(t),t.appendChild(e),t.scrollLeft=-1e3,or=t.scrollLeft>=0,t.remove()}const lt=1e3,fh=["start","center","end","start-force","center-force","end-force"],Ja=Array.prototype.filter,ph=window.getComputedStyle(document.body).overflowAnchor===void 0?Yu:function(t,e){t!==null&&(cancelAnimationFrame(t._qOverflowAnimationFrame),t._qOverflowAnimationFrame=requestAnimationFrame(()=>{if(t===null)return;const n=t.children||[];Ja.call(n,r=>r.dataset&&r.dataset.qVsAnchor!==void 0).forEach(r=>{delete r.dataset.qVsAnchor});const i=n[e];i&&i.dataset&&(i.dataset.qVsAnchor="")}))};function Vn(t,e){return t+e}function fs(t,e,n,i,r,s,o,a){const l=t===window?document.scrollingElement||document.documentElement:t,u=r===!0?"offsetWidth":"offsetHeight",c={scrollStart:0,scrollViewSize:-o-a,scrollMaxSize:0,offsetStart:-o,offsetEnd:-a};if(r===!0?(t===window?(c.scrollStart=window.pageXOffset||window.scrollX||document.body.scrollLeft||0,c.scrollViewSize+=document.documentElement.clientWidth):(c.scrollStart=l.scrollLeft,c.scrollViewSize+=l.clientWidth),c.scrollMaxSize=l.scrollWidth,s===!0&&(c.scrollStart=(or===!0?c.scrollMaxSize-c.scrollViewSize:0)-c.scrollStart)):(t===window?(c.scrollStart=window.pageYOffset||window.scrollY||document.body.scrollTop||0,c.scrollViewSize+=document.documentElement.clientHeight):(c.scrollStart=l.scrollTop,c.scrollViewSize+=l.clientHeight),c.scrollMaxSize=l.scrollHeight),n!==null)for(let h=n.previousElementSibling;h!==null;h=h.previousElementSibling)h.classList.contains("q-virtual-scroll--skip")===!1&&(c.offsetStart+=h[u]);if(i!==null)for(let h=i.nextElementSibling;h!==null;h=h.nextElementSibling)h.classList.contains("q-virtual-scroll--skip")===!1&&(c.offsetEnd+=h[u]);if(e!==t){const h=l.getBoundingClientRect(),f=e.getBoundingClientRect();r===!0?(c.offsetStart+=f.left-h.left,c.offsetEnd-=f.width):(c.offsetStart+=f.top-h.top,c.offsetEnd-=f.height),t!==window&&(c.offsetStart+=c.scrollStart),c.offsetEnd+=c.scrollMaxSize-c.offsetStart}return c}function ta(t,e,n,i){e==="end"&&(e=(t===window?document.body:t)[n===!0?"scrollWidth":"scrollHeight"]),t===window?n===!0?(i===!0&&(e=(or===!0?document.body.scrollWidth-document.documentElement.clientWidth:0)-e),window.scrollTo(e,window.pageYOffset||window.scrollY||document.body.scrollTop||0)):window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,e):n===!0?(i===!0&&(e=(or===!0?t.scrollWidth-t.offsetWidth:0)-e),t.scrollLeft=e):t.scrollTop=e}function Jn(t,e,n,i){if(n>=i)return 0;const r=e.length,s=Math.floor(n/lt),o=Math.floor((i-1)/lt)+1;let a=t.slice(s,o).reduce(Vn,0);return n%lt!==0&&(a-=e.slice(s*lt,n).reduce(Vn,0)),i%lt!==0&&i!==r&&(a-=e.slice(i,o*lt).reduce(Vn,0)),a}const mh={virtualScrollSliceSize:{type:[Number,String],default:null},virtualScrollSliceRatioBefore:{type:[Number,String],default:1},virtualScrollSliceRatioAfter:{type:[Number,String],default:1},virtualScrollItemSize:{type:[Number,String],default:24},virtualScrollStickySizeStart:{type:[Number,String],default:0},virtualScrollStickySizeEnd:{type:[Number,String],default:0},tableColspan:[Number,String]},gh={virtualScrollHorizontal:Boolean,onVirtualScroll:Function,...mh};function vh({virtualScrollLength:t,getVirtualScrollTarget:e,getVirtualScrollEl:n,virtualScrollItemSizeComputed:i}){const r=Ae(),{props:s,emit:o,proxy:a}=r,{$q:l}=a;let u,c,h,f=[],d;const p=Q(0),g=Q(0),m=Q({}),w=Q(null),b=Q(null),C=Q(null),T=Q({from:0,to:0}),v=D(()=>s.tableColspan!==void 0?s.tableColspan:100);i===void 0&&(i=D(()=>s.virtualScrollItemSize));const _=D(()=>i.value+";"+s.virtualScrollHorizontal),y=D(()=>_.value+";"+s.virtualScrollSliceRatioBefore+";"+s.virtualScrollSliceRatioAfter);re(y,()=>{j()}),re(_,S);function S(){W(c,!0)}function A(E){W(E===void 0?c:E)}function I(E,q){const $=e();if($==null||$.nodeType===8)return;const ee=fs($,n(),w.value,b.value,s.virtualScrollHorizontal,l.lang.rtl,s.virtualScrollStickySizeStart,s.virtualScrollStickySizeEnd);h!==ee.scrollViewSize&&j(ee.scrollViewSize),N($,ee,Math.min(t.value-1,Math.max(0,parseInt(E,10)||0)),0,fh.indexOf(q)>-1?q:c>-1&&E>c?"end":"start")}function M(){const E=e();if(E==null||E.nodeType===8)return;const q=fs(E,n(),w.value,b.value,s.virtualScrollHorizontal,l.lang.rtl,s.virtualScrollStickySizeStart,s.virtualScrollStickySizeEnd),$=t.value-1,ee=q.scrollMaxSize-q.offsetStart-q.offsetEnd-g.value;if(u===q.scrollStart)return;if(q.scrollMaxSize<=0){N(E,q,0,0);return}h!==q.scrollViewSize&&j(q.scrollViewSize),V(T.value.from);const K=Math.floor(q.scrollMaxSize-Math.max(q.scrollViewSize,q.offsetEnd)-Math.min(d[$],q.scrollViewSize/2));if(K>0&&Math.ceil(q.scrollStart)>=K){N(E,q,$,q.scrollMaxSize-q.offsetEnd-f.reduce(Vn,0));return}let X=0,Y=q.scrollStart-q.offsetStart,R=Y;if(Y<=ee&&Y+q.scrollViewSize>=p.value)Y-=p.value,X=T.value.from,R=Y;else for(let U=0;Y>=f[U]&&X<$;U++)Y-=f[U],X+=lt;for(;Y>0&&X<$;)Y-=d[X],Y>-q.scrollViewSize?(X++,R=Y):R=d[X]+Y;N(E,q,X,R)}function N(E,q,$,ee,K){const X=typeof K=="string"&&K.indexOf("-force")>-1,Y=X===!0?K.replace("-force",""):K,R=Y!==void 0?Y:"start";let U=Math.max(0,$-m.value[R]),he=U+m.value.total;he>t.value&&(he=t.value,U=Math.max(0,he-m.value.total)),u=q.scrollStart;const Me=U!==T.value.from||he!==T.value.to;if(Me===!1&&Y===void 0){P($);return}const{activeElement:Re}=document,st=C.value;Me===!0&&st!==null&&st!==Re&&st.contains(Re)===!0&&(st.addEventListener("focusout",F),setTimeout(()=>{st!==null&&st.removeEventListener("focusout",F)})),ph(st,$-U);const vn=Y!==void 0?d.slice(U,$).reduce(Vn,0):0;if(Me===!0){const z=he>=T.value.from&&U<=T.value.to?T.value.to:he;T.value={from:U,to:z},p.value=Jn(f,d,0,U),g.value=Jn(f,d,he,t.value),requestAnimationFrame(()=>{T.value.to!==he&&u===q.scrollStart&&(T.value={from:T.value.from,to:he},g.value=Jn(f,d,he,t.value))})}requestAnimationFrame(()=>{if(u!==q.scrollStart)return;Me===!0&&V(U);const z=d.slice(U,$).reduce(Vn,0),J=z+q.offsetStart+p.value,_e=J+d[$];let le=J+ee;if(Y!==void 0){const ne=z-vn,se=q.scrollStart+ne;le=X!==!0&&se<J&&_e<se+q.scrollViewSize?se:Y==="end"?_e-q.scrollViewSize:J-(Y==="start"?0:Math.round((q.scrollViewSize-d[$])/2))}u=le,ta(E,le,s.virtualScrollHorizontal,l.lang.rtl),P($)})}function V(E){const q=C.value;if(q){const $=Ja.call(q.children,U=>U.classList&&U.classList.contains("q-virtual-scroll--skip")===!1),ee=$.length,K=s.virtualScrollHorizontal===!0?U=>U.getBoundingClientRect().width:U=>U.offsetHeight;let X=E,Y,R;for(let U=0;U<ee;){for(Y=K($[U]),U++;U<ee&&$[U].classList.contains("q-virtual-scroll--with-prev")===!0;)Y+=K($[U]),U++;R=Y-d[X],R!==0&&(d[X]+=R,f[Math.floor(X/lt)]+=R),X++}}}function F(){C.value!==null&&C.value!==void 0&&C.value.focus()}function W(E,q){const $=1*i.value;(q===!0||Array.isArray(d)===!1)&&(d=[]);const ee=d.length;d.length=t.value;for(let X=t.value-1;X>=ee;X--)d[X]=$;const K=Math.floor((t.value-1)/lt);f=[];for(let X=0;X<=K;X++){let Y=0;const R=Math.min((X+1)*lt,t.value);for(let U=X*lt;U<R;U++)Y+=d[U];f.push(Y)}c=-1,u=void 0,p.value=Jn(f,d,0,T.value.from),g.value=Jn(f,d,T.value.to,t.value),E>=0?(V(T.value.from),we(()=>{I(E)})):L()}function j(E){if(E===void 0&&typeof window!="undefined"){const Y=e();Y!=null&&Y.nodeType!==8&&(E=fs(Y,n(),w.value,b.value,s.virtualScrollHorizontal,l.lang.rtl,s.virtualScrollStickySizeStart,s.virtualScrollStickySizeEnd).scrollViewSize)}h=E;const q=parseFloat(s.virtualScrollSliceRatioBefore)||0,$=parseFloat(s.virtualScrollSliceRatioAfter)||0,ee=1+q+$,K=E===void 0||E<=0?1:Math.ceil(E/i.value),X=Math.max(1,K,Math.ceil((s.virtualScrollSliceSize>0?s.virtualScrollSliceSize:10)/ee));m.value={total:Math.ceil(X*ee),start:Math.ceil(X*q),center:Math.ceil(X*(.5+q)),end:Math.ceil(X*(1+q)),view:K}}function O(E,q){const $=s.virtualScrollHorizontal===!0?"width":"height",ee={["--q-virtual-scroll-item-"+$]:i.value+"px"};return[E==="tbody"?B(E,{class:"q-virtual-scroll__padding",key:"before",ref:w},[B("tr",[B("td",{style:{[$]:`${p.value}px`,...ee},colspan:v.value})])]):B(E,{class:"q-virtual-scroll__padding",key:"before",ref:w,style:{[$]:`${p.value}px`,...ee}}),B(E,{class:"q-virtual-scroll__content",key:"content",ref:C,tabindex:-1},q.flat()),E==="tbody"?B(E,{class:"q-virtual-scroll__padding",key:"after",ref:b},[B("tr",[B("td",{style:{[$]:`${g.value}px`,...ee},colspan:v.value})])]):B(E,{class:"q-virtual-scroll__padding",key:"after",ref:b,style:{[$]:`${g.value}px`,...ee}})]}function P(E){c!==E&&(s.onVirtualScroll!==void 0&&o("virtual-scroll",{index:E,from:T.value.from,to:T.value.to-1,direction:E<c?"decrease":"increase",ref:a}),c=E)}j();const L=Na(M,l.platform.is.ios===!0?120:35);Ku(()=>{j()});let x=!1;return ki(()=>{x=!0}),Rs(()=>{if(x!==!0)return;const E=e();u!==void 0&&E!==void 0&&E!==null&&E.nodeType!==8?ta(E,u,s.virtualScrollHorizontal,l.lang.rtl):I(c)}),et(()=>{L.cancel()}),Object.assign(a,{scrollTo:I,reset:S,refresh:A}),{virtualScrollSliceRange:T,virtualScrollSliceSizeComputed:m,setVirtualScrollSize:j,onVirtualScrollEvt:L,localResetVirtualScroll:W,padVirtualScroll:O,scrollTo:I,reset:S,refresh:A}}const na=t=>["add","add-unique","toggle"].includes(t),_h=".*+?^${}()|[]\\",yh=Object.keys(xi);var bh=Le({name:"QSelect",inheritAttrs:!1,props:{...gh,...Ls,...xi,modelValue:{required:!0},multiple:Boolean,displayValue:[String,Number],displayValueHtml:Boolean,dropdownIcon:String,options:{type:Array,default:()=>[]},optionValue:[Function,String],optionLabel:[Function,String],optionDisable:[Function,String],hideSelected:Boolean,hideDropdownIcon:Boolean,fillInput:Boolean,maxValues:[Number,String],optionsDense:Boolean,optionsDark:{type:Boolean,default:null},optionsSelectedClass:String,optionsHtml:Boolean,optionsCover:Boolean,menuShrink:Boolean,menuAnchor:String,menuSelf:String,menuOffset:Array,popupContentClass:String,popupContentStyle:[String,Array,Object],useInput:Boolean,useChips:Boolean,newValueMode:{type:String,validator:na},mapOptions:Boolean,emitValue:Boolean,inputDebounce:{type:[Number,String],default:500},inputClass:[Array,String,Object],inputStyle:[Array,String,Object],tabindex:{type:[String,Number],default:0},autocomplete:String,transitionShow:String,transitionHide:String,transitionDuration:[String,Number],behavior:{type:String,validator:t=>["default","menu","dialog"].includes(t),default:"default"},virtualScrollItemSize:{type:[Number,String],default:void 0},onNewValue:Function,onFilter:Function},emits:[...Nr,"add","remove","input-value","new-value","keyup","keypress","keydown","filter-abort"],setup(t,{slots:e,emit:n}){const{proxy:i}=Ae(),{$q:r}=i,s=Q(!1),o=Q(!1),a=Q(-1),l=Q(""),u=Q(!1),c=Q(!1);let h,f,d,p,g,m,w,b,C;const T=Q(null),v=Q(null),_=Q(null),y=Q(null),S=Q(null),A=js(t),I=La(xo),M=D(()=>Array.isArray(t.options)?t.options.length:0),N=D(()=>t.virtualScrollItemSize===void 0?t.optionsDense===!0?24:48:t.virtualScrollItemSize),{virtualScrollSliceRange:V,virtualScrollSliceSizeComputed:F,localResetVirtualScroll:W,padVirtualScroll:j,onVirtualScrollEvt:O,scrollTo:P,setVirtualScrollSize:L}=vh({virtualScrollLength:M,getVirtualScrollTarget:_u,getVirtualScrollEl:ko,virtualScrollItemSizeComputed:N}),x=Er(),E=D(()=>{const k=t.mapOptions===!0&&t.multiple!==!0,Z=t.modelValue!==void 0&&(t.modelValue!==null||k===!0)?t.multiple===!0&&Array.isArray(t.modelValue)?t.modelValue:[t.modelValue]:[];if(t.mapOptions===!0&&Array.isArray(t.options)===!0){const G=t.mapOptions===!0&&f!==void 0?f:[],ie=Z.map(pe=>vu(pe,G));return t.modelValue===null&&k===!0?ie.filter(pe=>pe!==null):ie}return Z}),q=D(()=>{const k={};return yh.forEach(Z=>{const G=t[Z];G!==void 0&&(k[Z]=G)}),k}),$=D(()=>t.optionsDark===null?x.isDark.value:t.optionsDark),ee=D(()=>on(E.value)),K=D(()=>{let k="q-field__input q-placeholder col";return t.hideSelected===!0||E.value.length===0?[k,t.inputClass]:(k+=" q-field__input--padding",t.inputClass===void 0?k:[k,t.inputClass])}),X=D(()=>(t.virtualScrollHorizontal===!0?"q-virtual-scroll--horizontal":"")+(t.popupContentClass?" "+t.popupContentClass:"")),Y=D(()=>M.value===0),R=D(()=>E.value.map(k=>se.value(k)).join(", ")),U=D(()=>t.optionsHtml===!0?()=>!0:k=>k!=null&&k.html===!0),he=D(()=>t.displayValueHtml===!0||t.displayValue===void 0&&(t.optionsHtml===!0||E.value.some(U.value))),Me=D(()=>x.focused.value===!0?t.tabindex:-1),Re=D(()=>({tabindex:t.tabindex,role:"combobox","aria-label":t.label,"aria-readonly":t.readonly===!0?"true":"false","aria-autocomplete":t.useInput===!0?"list":"none","aria-expanded":s.value===!0?"true":"false","aria-owns":`${x.targetUid.value}_lb`,"aria-controls":`${x.targetUid.value}_lb`})),st=D(()=>{const k={id:`${x.targetUid.value}_lb`,role:"listbox","aria-multiselectable":t.multiple===!0?"true":"false"};return a.value>=0&&(k["aria-activedescendant"]=`${x.targetUid.value}_${a.value}`),k}),vn=D(()=>E.value.map((k,Z)=>({index:Z,opt:k,html:U.value(k),selected:!0,removeAtIndex:Yr,toggleOption:Zt,tabindex:Me.value}))),z=D(()=>{if(M.value===0)return[];const{from:k,to:Z}=V.value;return t.options.slice(k,Z).map((G,ie)=>{const pe=Ne.value(G)===!0,ue=k+ie,ke={clickable:!0,active:!1,activeClass:le.value,manualFocus:!0,focused:!1,disable:pe,tabindex:-1,dense:t.optionsDense,dark:$.value,role:"option",id:`${x.targetUid.value}_${ue}`,onClick:()=>{Zt(G)}};return pe!==!0&&(Jr(G)===!0&&(ke.active=!0),a.value===ue&&(ke.focused=!0),ke["aria-selected"]=ke.active===!0?"true":"false",r.platform.is.desktop===!0&&(ke.onMousemove=()=>{s.value===!0&&yn(ue)})),{index:ue,opt:G,html:U.value(G),label:se.value(G),selected:ke.active,focused:ke.focused,toggleOption:Zt,setOptionIndex:yn,itemProps:ke}})}),J=D(()=>t.dropdownIcon!==void 0?t.dropdownIcon:r.iconSet.arrow.dropdown),_e=D(()=>t.optionsCover===!1&&t.outlined!==!0&&t.standout!==!0&&t.borderless!==!0&&t.rounded!==!0),le=D(()=>t.optionsSelectedClass!==void 0?t.optionsSelectedClass:t.color!==void 0?`text-${t.color}`:""),ne=D(()=>Kr(t.optionValue,"value")),se=D(()=>Kr(t.optionLabel,"label")),Ne=D(()=>Kr(t.optionDisable,"disable")),tt=D(()=>E.value.map(k=>ne.value(k))),Gt=D(()=>{const k={onInput:xo,onChange:I,onKeydown:To,onKeyup:wo,onKeypress:So,onFocus:yo,onClick(Z){d===!0&&At(Z)}};return k.onCompositionstart=k.onCompositionupdate=k.onCompositionend=I,k});re(E,k=>{f=k,t.useInput===!0&&t.fillInput===!0&&t.multiple!==!0&&x.innerLoading.value!==!0&&(o.value!==!0&&s.value!==!0||ee.value!==!0)&&(p!==!0&&Tn(),(o.value===!0||s.value===!0)&&bn(""))},{immediate:!0}),re(()=>t.fillInput,Tn),re(s,es),re(M,Mu);function _n(k){return t.emitValue===!0?ne.value(k):k}function Xn(k){if(k>-1&&k<E.value.length)if(t.multiple===!0){const Z=t.modelValue.slice();n("remove",{index:k,value:Z.splice(k,1)[0]}),n("update:modelValue",Z)}else n("update:modelValue",null)}function Yr(k){Xn(k),x.focus()}function _o(k,Z){const G=_n(k);if(t.multiple!==!0){t.fillInput===!0&&Qn(se.value(k),!0,!0),n("update:modelValue",G);return}if(E.value.length===0){n("add",{index:0,value:G}),n("update:modelValue",t.multiple===!0?[G]:G);return}if(Z===!0&&Jr(k)===!0||t.maxValues!==void 0&&t.modelValue.length>=t.maxValues)return;const ie=t.modelValue.slice();n("add",{index:ie.length,value:G}),ie.push(G),n("update:modelValue",ie)}function Zt(k,Z){if(x.editable.value!==!0||k===void 0||Ne.value(k)===!0)return;const G=ne.value(k);if(t.multiple!==!0){Z!==!0&&(Qn(t.fillInput===!0?se.value(k):"",!0,!0),Xt()),v.value!==null&&v.value.focus(),(E.value.length===0||Yn(ne.value(E.value[0]),G)!==!0)&&n("update:modelValue",t.emitValue===!0?G:k);return}if((d!==!0||u.value===!0)&&x.focus(),yo(),E.value.length===0){const ue=t.emitValue===!0?G:k;n("add",{index:0,value:ue}),n("update:modelValue",t.multiple===!0?[ue]:ue);return}const ie=t.modelValue.slice(),pe=tt.value.findIndex(ue=>Yn(ue,G));if(pe>-1)n("remove",{index:pe,value:ie.splice(pe,1)[0]});else{if(t.maxValues!==void 0&&ie.length>=t.maxValues)return;const ue=t.emitValue===!0?G:k;n("add",{index:ie.length,value:ue}),ie.push(ue)}n("update:modelValue",ie)}function yn(k){if(r.platform.is.desktop!==!0)return;const Z=k>-1&&k<M.value?k:-1;a.value!==Z&&(a.value=Z)}function qi(k=1,Z){if(s.value===!0){let G=a.value;do G=Uo(G+k,-1,M.value-1);while(G!==-1&&G!==a.value&&Ne.value(t.options[G])===!0);a.value!==G&&(yn(G),P(G),Z!==!0&&t.useInput===!0&&t.fillInput===!0&&Bi(G>=0?se.value(t.options[G]):m))}}function vu(k,Z){const G=ie=>Yn(ne.value(ie),k);return t.options.find(G)||Z.find(G)||k}function Kr(k,Z){const G=k!==void 0?k:Z;return typeof G=="function"?G:ie=>ie!==null&&typeof ie=="object"&&G in ie?ie[G]:ie}function Jr(k){const Z=ne.value(k);return tt.value.find(G=>Yn(G,Z))!==void 0}function yo(k){t.useInput===!0&&v.value!==null&&(k===void 0||v.value===k.target&&k.target.value===R.value)&&v.value.select()}function bo(k){Or(k,27)===!0&&s.value===!0&&(At(k),Xt(),Tn()),n("keyup",k)}function wo(k){const{value:Z}=k.target;if(k.keyCode!==void 0){bo(k);return}if(k.target.value="",clearTimeout(h),Tn(),typeof Z=="string"&&Z.length>0){const G=Z.toLocaleLowerCase(),ie=ue=>{const ke=t.options.find(We=>ue.value(We).toLocaleLowerCase()===G);return ke===void 0?!1:(E.value.indexOf(ke)===-1?Zt(ke):Xt(),!0)},pe=ue=>{ie(ne)!==!0&&(ie(se)===!0||ue===!0||bn(Z,!0,()=>pe(!0)))};pe()}else x.clearValue(k)}function So(k){n("keypress",k)}function To(k){if(n("keydown",k),Va(k)===!0)return;const Z=l.value.length>0&&(t.newValueMode!==void 0||t.onNewValue!==void 0),G=k.shiftKey!==!0&&t.multiple!==!0&&(a.value>-1||Z===!0);if(k.keyCode===27){ct(k);return}if(k.keyCode===9&&G===!1){wn();return}if(k.target===void 0||k.target.id!==x.targetUid.value)return;if(k.keyCode===40&&x.innerLoading.value!==!0&&s.value===!1){$e(k),Sn();return}if(k.keyCode===8&&t.hideSelected!==!0&&l.value.length===0){t.multiple===!0&&Array.isArray(t.modelValue)===!0?Xn(t.modelValue.length-1):t.multiple!==!0&&t.modelValue!==null&&n("update:modelValue",null);return}(k.keyCode===35||k.keyCode===36)&&(typeof l.value!="string"||l.value.length===0)&&($e(k),a.value=-1,qi(k.keyCode===36?1:-1,t.multiple)),(k.keyCode===33||k.keyCode===34)&&F.value!==void 0&&($e(k),a.value=Math.max(-1,Math.min(M.value,a.value+(k.keyCode===33?-1:1)*F.value.view)),qi(k.keyCode===33?1:-1,t.multiple)),(k.keyCode===38||k.keyCode===40)&&($e(k),qi(k.keyCode===38?-1:1,t.multiple));const ie=M.value;if((b===void 0||C<Date.now())&&(b=""),ie>0&&t.useInput!==!0&&k.key!==void 0&&k.key.length===1&&k.altKey===k.ctrlKey&&(k.keyCode!==32||b.length>0)){s.value!==!0&&Sn(k);const pe=k.key.toLocaleLowerCase(),ue=b.length===1&&b[0]===pe;C=Date.now()+1500,ue===!1&&($e(k),b+=pe);const ke=new RegExp("^"+b.split("").map(ts=>_h.indexOf(ts)>-1?"\\"+ts:ts).join(".*"),"i");let We=a.value;if(ue===!0||We<0||ke.test(se.value(t.options[We]))!==!0)do We=Uo(We+1,-1,ie-1);while(We!==a.value&&(Ne.value(t.options[We])===!0||ke.test(se.value(t.options[We]))!==!0));a.value!==We&&we(()=>{yn(We),P(We),We>=0&&t.useInput===!0&&t.fillInput===!0&&Bi(se.value(t.options[We]))});return}if(!(k.keyCode!==13&&(k.keyCode!==32||t.useInput===!0||b!=="")&&(k.keyCode!==9||G===!1))){if(k.keyCode!==9&&$e(k),a.value>-1&&a.value<ie){Zt(t.options[a.value]);return}if(Z===!0){const pe=(ue,ke)=>{if(ke){if(na(ke)!==!0)return}else ke=t.newValueMode;if(ue==null)return;Qn("",t.multiple!==!0,!0),(ke==="toggle"?Zt:_o)(ue,ke==="add-unique"),t.multiple!==!0&&(v.value!==null&&v.value.focus(),Xt())};if(t.onNewValue!==void 0?n("new-value",l.value,pe):pe(l.value),t.multiple!==!0)return}s.value===!0?wn():x.innerLoading.value!==!0&&Sn()}}function ko(){return d===!0?S.value:_.value!==null&&_.value.__qPortalInnerRef.value!==null?_.value.__qPortalInnerRef.value:void 0}function _u(){return ko()}function yu(){return t.hideSelected===!0?[]:e["selected-item"]!==void 0?vn.value.map(k=>e["selected-item"](k)).slice():e.selected!==void 0?[].concat(e.selected()):t.useChips===!0?vn.value.map((k,Z)=>B(Pa,{key:"option-"+Z,removable:x.editable.value===!0&&Ne.value(k.opt)!==!0,dense:!0,textColor:t.color,tabindex:Me.value,onRemove(){k.removeAtIndex(Z)}},()=>B("span",{class:"ellipsis",[k.html===!0?"innerHTML":"textContent"]:se.value(k.opt)}))):[B("span",{[he.value===!0?"innerHTML":"textContent"]:t.displayValue!==void 0?t.displayValue:R.value})]}function Co(){if(Y.value===!0)return e["no-option"]!==void 0?e["no-option"]({inputValue:l.value}):void 0;const k=e.option!==void 0?e.option:G=>B(Lc,{key:G.index,...G.itemProps},()=>B(jc,()=>B(Uc,()=>B("span",{[G.html===!0?"innerHTML":"textContent"]:G.label}))));let Z=j("div",z.value.map(k));return e["before-options"]!==void 0&&(Z=e["before-options"]().concat(Z)),ec(e["after-options"],Z)}function bu(k,Z){const G=Z===!0?{...Re.value,...x.splitAttrs.attributes.value}:void 0,ie={ref:Z===!0?v:void 0,key:"i_t",class:K.value,style:t.inputStyle,value:l.value!==void 0?l.value:"",type:"search",...G,id:Z===!0?x.targetUid.value:void 0,maxlength:t.maxlength,autocomplete:t.autocomplete,"data-autofocus":k!==!0&&t.autofocus===!0||void 0,disabled:t.disable===!0,readonly:t.readonly===!0,...Gt.value};return k!==!0&&d===!0&&(Array.isArray(ie.class)===!0?ie.class=[...ie.class,"no-pointer-events"]:ie.class+=" no-pointer-events"),B("input",ie)}function xo(k){clearTimeout(h),!(k&&k.target&&k.target.qComposing===!0)&&(Bi(k.target.value||""),p=!0,m=l.value,x.focused.value!==!0&&(d!==!0||u.value===!0)&&x.focus(),t.onFilter!==void 0&&(h=setTimeout(()=>{bn(l.value)},t.inputDebounce)))}function Bi(k){l.value!==k&&(l.value=k,n("input-value",k))}function Qn(k,Z,G){p=G!==!0,t.useInput===!0&&(Bi(k),(Z===!0||G!==!0)&&(m=k),Z!==!0&&bn(k))}function bn(k,Z,G){if(t.onFilter===void 0||Z!==!0&&x.focused.value!==!0)return;x.innerLoading.value===!0?n("filter-abort"):(x.innerLoading.value=!0,c.value=!0),k!==""&&t.multiple!==!0&&E.value.length>0&&p!==!0&&k===se.value(E.value[0])&&(k="");const ie=setTimeout(()=>{s.value===!0&&(s.value=!1)},10);clearTimeout(g),g=ie,n("filter",k,(pe,ue)=>{(Z===!0||x.focused.value===!0)&&g===ie&&(clearTimeout(g),typeof pe=="function"&&pe(),c.value=!1,we(()=>{x.innerLoading.value=!1,x.editable.value===!0&&(Z===!0?s.value===!0&&Xt():s.value===!0?es(!0):s.value=!0),typeof ue=="function"&&we(()=>{ue(i)}),typeof G=="function"&&we(()=>{G(i)})}))},()=>{x.focused.value===!0&&g===ie&&(clearTimeout(g),x.innerLoading.value=!1,c.value=!1),s.value===!0&&(s.value=!1)})}function wu(){return B(sh,{ref:_,class:X.value,style:t.popupContentStyle,modelValue:s.value,fit:t.menuShrink!==!0,cover:t.optionsCover===!0&&Y.value!==!0&&t.useInput!==!0,anchor:t.menuAnchor,self:t.menuSelf,offset:t.menuOffset,dark:$.value,noParentEvent:!0,noRefocus:!0,noFocus:!0,square:_e.value,transitionShow:t.transitionShow,transitionHide:t.transitionHide,transitionDuration:t.transitionDuration,separateClosePopup:!0,...st.value,onScrollPassive:O,onBeforeShow:Io,onBeforeHide:Su,onShow:Tu},Co)}function Su(k){Oo(k),wn()}function Tu(){L()}function ku(k){At(k),v.value!==null&&v.value.focus(),u.value=!0,window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,0)}function Cu(k){At(k),we(()=>{u.value=!1})}function xu(){const k=[B(Bc,{class:`col-auto ${x.fieldClass.value}`,...q.value,for:x.targetUid.value,dark:$.value,square:!0,loading:c.value,itemAligned:!1,filled:!0,stackLabel:l.value.length>0,...x.splitAttrs.listeners.value,onFocus:ku,onBlur:Cu},{...e,rawControl:()=>x.getControl(!0),before:void 0,after:void 0})];return s.value===!0&&k.push(B("div",{ref:S,class:X.value+" scroll",style:t.popupContentStyle,...st.value,onClick:ct,onScrollPassive:O},Co())),B(dh,{ref:y,modelValue:o.value,position:t.useInput===!0?"top":void 0,transitionShow:w,transitionHide:t.transitionHide,transitionDuration:t.transitionDuration,onBeforeShow:Io,onBeforeHide:Au,onHide:Iu,onShow:Ou},()=>B("div",{class:"q-select__dialog"+($.value===!0?" q-select__dialog--dark q-dark":"")+(u.value===!0?" q-select__dialog--focused":"")},k))}function Au(k){Oo(k),y.value!==null&&y.value.__updateRefocusTarget(x.rootRef.value.querySelector(".q-field__native > [tabindex]:last-child")),x.focused.value=!1}function Iu(k){Xt(),x.focused.value===!1&&n("blur",k),Tn()}function Ou(){const k=document.activeElement;(k===null||k.id!==x.targetUid.value)&&v.value!==null&&v.value!==k&&v.value.focus(),L()}function wn(){o.value!==!0&&(a.value=-1,s.value===!0&&(s.value=!1),x.focused.value===!1&&(clearTimeout(g),g=void 0,x.innerLoading.value===!0&&(n("filter-abort"),x.innerLoading.value=!1,c.value=!1)))}function Sn(k){x.editable.value===!0&&(d===!0?(x.onControlFocusin(k),o.value=!0,we(()=>{x.focus()})):x.focus(),t.onFilter!==void 0?bn(l.value):(Y.value!==!0||e["no-option"]!==void 0)&&(s.value=!0))}function Xt(){o.value=!1,wn()}function Tn(){t.useInput===!0&&Qn(t.multiple!==!0&&t.fillInput===!0&&E.value.length>0&&se.value(E.value[0])||"",!0,!0)}function es(k){let Z=-1;if(k===!0){if(E.value.length>0){const G=ne.value(E.value[0]);Z=t.options.findIndex(ie=>Yn(ne.value(ie),G))}W(Z)}yn(Z)}function Mu(k,Z){s.value===!0&&x.innerLoading.value===!1&&(W(-1,!0),we(()=>{s.value===!0&&x.innerLoading.value===!1&&(k>Z?W():es(!0))}))}function Ao(){o.value===!1&&_.value!==null&&_.value.updatePosition()}function Io(k){k!==void 0&&At(k),n("popup-show",k),x.hasPopupOpen=!0,x.onControlFocusin(k)}function Oo(k){k!==void 0&&At(k),n("popup-hide",k),x.hasPopupOpen=!1,x.onControlFocusout(k)}function Mo(){d=r.platform.is.mobile!==!0&&t.behavior!=="dialog"?!1:t.behavior!=="menu"&&(t.useInput===!0?e["no-option"]!==void 0||t.onFilter!==void 0||Y.value===!1:!0),w=r.platform.is.ios===!0&&d===!0&&t.useInput===!0?"fade":t.transitionShow}return Ea(Mo),Ju(Ao),Mo(),et(()=>{clearTimeout(h)}),Object.assign(i,{showPopup:Sn,hidePopup:Xt,removeAtIndex:Xn,add:_o,toggleOption:Zt,getOptionIndex:()=>a.value,setOptionIndex:yn,moveOptionSelection:qi,filter:bn,updateMenuPosition:Ao,updateInputValue:Qn,isOptionSelected:Jr,getEmittingOptionValue:_n,isOptionDisabled:(...k)=>Ne.value.apply(null,k)===!0,getOptionValue:(...k)=>ne.value.apply(null,k),getOptionLabel:(...k)=>se.value.apply(null,k)}),Object.assign(x,{innerValue:E,fieldClass:D(()=>`q-select q-field--auto-height q-select--with${t.useInput!==!0?"out":""}-input q-select--with${t.useChips!==!0?"out":""}-chips q-select--${t.multiple===!0?"multiple":"single"}`),inputRef:T,targetRef:v,hasValue:ee,showPopup:Sn,floatingLabel:D(()=>t.hideSelected!==!0&&ee.value===!0||typeof l.value=="number"||l.value.length>0||on(t.displayValue)),getControlChild:()=>{if(x.editable.value!==!1&&(o.value===!0||Y.value!==!0||e["no-option"]!==void 0))return d===!0?xu():wu();x.hasPopupOpen===!0&&(x.hasPopupOpen=!1)},controlEvents:{onFocusin(k){x.onControlFocusin(k)},onFocusout(k){x.onControlFocusout(k,()=>{Tn(),wn()})},onClick(k){if(ct(k),d!==!0&&s.value===!0){wn(),v.value!==null&&v.value.focus();return}Sn(k)}},getControl:k=>{const Z=yu(),G=k===!0||o.value!==!0||d!==!0;if(t.useInput===!0)Z.push(bu(k,G));else if(x.editable.value===!0){const pe=G===!0?Re.value:void 0;Z.push(B("input",{ref:G===!0?v:void 0,key:"d_t",class:"q-select__focus-target",id:G===!0?x.targetUid.value:void 0,readonly:!0,"data-autofocus":k!==!0&&t.autofocus===!0||void 0,...pe,onKeydown:To,onKeyup:bo,onKeypress:So})),G===!0&&typeof t.autocomplete=="string"&&t.autocomplete.length>0&&Z.push(B("input",{class:"q-select__autocomplete-input",autocomplete:t.autocomplete,tabindex:-1,onKeyup:wo}))}if(A.value!==void 0&&t.disable!==!0&&tt.value.length>0){const pe=tt.value.map(ue=>B("option",{value:ue,selected:!0}));Z.push(B("select",{class:"hidden",name:A.value,multiple:t.multiple},pe))}const ie=t.useInput===!0||G!==!0?void 0:x.splitAttrs.attributes.value;return B("div",{class:"q-field__native row items-center",...ie},Z)},getInnerAppend:()=>t.loading!==!0&&c.value!==!0&&t.hideDropdownIcon!==!0?[B(qt,{class:"q-select__dropdown-icon"+(s.value===!0?" rotate-180":""),name:J.value})]:null}),Vr(x)}}),wh=Le({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validation-success","validation-error"],setup(t,{slots:e,emit:n}){const i=Ae(),r=Q(null);let s=0;const o=[];function a(d){const p=typeof d=="boolean"?d:t.noErrorFocus!==!0,g=++s,m=(C,T)=>{n("validation-"+(C===!0?"success":"error"),T)},w=C=>{const T=C.validate();return typeof T.then=="function"?T.then(v=>({valid:v,comp:C}),v=>({valid:!1,comp:C,err:v})):Promise.resolve({valid:T,comp:C})};return(t.greedy===!0?Promise.all(o.map(w)).then(C=>C.filter(T=>T.valid!==!0)):o.reduce((C,T)=>C.then(()=>w(T).then(v=>{if(v.valid===!1)return Promise.reject(v)})),Promise.resolve()).catch(C=>[C])).then(C=>{if(C===void 0||C.length===0)return g===s&&m(!0),!0;if(g===s){const{comp:T,err:v}=C[0];if(v!==void 0&&console.error(v),m(!1,T),p===!0){const _=C.find(({comp:y})=>typeof y.focus=="function"&&qs(y.$)===!1);_!==void 0&&_.comp.focus()}}return!1})}function l(){s++,o.forEach(d=>{typeof d.resetValidation=="function"&&d.resetValidation()})}function u(d){d!==void 0&&$e(d);const p=s+1;a().then(g=>{p===s&&g===!0&&(t.onSubmit!==void 0?n("submit",d):d!==void 0&&d.target!==void 0&&typeof d.target.submit=="function"&&d.target.submit())})}function c(d){d!==void 0&&$e(d),n("reset"),we(()=>{l(),t.autofocus===!0&&t.noResetFocus!==!0&&h()})}function h(){Ci(()=>{if(r.value===null)return;const d=r.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(r.value.querySelectorAll("[tabindex]"),p=>p.tabIndex>-1);d!=null&&d.focus({preventScroll:!0})})}tc(Ma,{bindComponent(d){o.push(d)},unbindComponent(d){const p=o.indexOf(d);p>-1&&o.splice(p,1)}});let f=!1;return ki(()=>{f=!0}),Rs(()=>{f===!0&&t.autofocus===!0&&h()}),fn(()=>{t.autofocus===!0&&h()}),Object.assign(i.proxy,{validate:a,resetValidation:l,submit:u,reset:c,focus:h,getValidationComponents:()=>o}),()=>B("form",{class:"q-form",ref:r,onSubmit:u,onReset:c},Ye(e.default))}}),Sh=Le({name:"QPage",props:{padding:Boolean,styleFn:Function},setup(t,{slots:e}){const{proxy:{$q:n}}=Ae(),i=ws(nc,kn);if(i===kn)return console.error("QPage needs to be a deep child of QLayout"),kn;if(ws(ic,kn)===kn)return console.error("QPage needs to be child of QPageContainer"),kn;const s=D(()=>{const a=(i.header.space===!0?i.header.size:0)+(i.footer.space===!0?i.footer.size:0);if(typeof t.styleFn=="function"){const l=i.isContainer.value===!0?i.containerHeight.value:n.screen.height;return t.styleFn(a,l)}return{minHeight:i.isContainer.value===!0?i.containerHeight.value-a+"px":n.screen.height===0?a!==0?`calc(100vh - ${a}px)`:"100vh":n.screen.height-a+"px"}}),o=D(()=>`q-page${t.padding===!0?" q-layout-padding":""}`);return()=>B("main",{class:o.value,style:s.value},Ye(e.default))}});function Th(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ia(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function ra(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ia(Object(n),!0).forEach(function(i){Th(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ia(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function kh(t,e){if(t==null)return{};var n={},i=Object.keys(t),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function Ch(t,e){if(t==null)return{};var n=kh(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,i)||(n[i]=t[i]))}return n}function xh(t,e){return Ah(t)||Ih(t,e)||Oh(t,e)||Mh()}function Ah(t){if(Array.isArray(t))return t}function Ih(t,e){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(t)))){var n=[],i=!0,r=!1,s=void 0;try{for(var o=t[Symbol.iterator](),a;!(i=(a=o.next()).done)&&(n.push(a.value),!(e&&n.length===e));i=!0);}catch(l){r=!0,s=l}finally{try{!i&&o.return!=null&&o.return()}finally{if(r)throw s}}return n}}function Oh(t,e){if(!!t){if(typeof t=="string")return sa(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sa(t,e)}}function sa(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Mh(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nh(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oa(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function aa(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?oa(Object(n),!0).forEach(function(i){Nh(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):oa(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Eh(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(i){return e.reduceRight(function(r,s){return s(r)},i)}}function ti(t){return function e(){for(var n=this,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return r.length>=t.length?t.apply(this,r):function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return e.apply(n,[].concat(r,a))}}}function ar(t){return{}.toString.call(t).includes("Object")}function Vh(t){return!Object.keys(t).length}function ai(t){return typeof t=="function"}function Dh(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Fh(t,e){return ar(e)||Bt("changeType"),Object.keys(e).some(function(n){return!Dh(t,n)})&&Bt("changeField"),e}function Ph(t){ai(t)||Bt("selectorType")}function Rh(t){ai(t)||ar(t)||Bt("handlerType"),ar(t)&&Object.values(t).some(function(e){return!ai(e)})&&Bt("handlersType")}function qh(t){t||Bt("initialIsRequired"),ar(t)||Bt("initialType"),Vh(t)&&Bt("initialContent")}function Bh(t,e){throw new Error(t[e]||t.default)}var Lh={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},Bt=ti(Bh)(Lh),Hi={changes:Fh,selector:Ph,handler:Rh,initial:qh};function jh(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Hi.initial(t),Hi.handler(e);var n={current:t},i=ti($h)(n,e),r=ti(Wh)(n),s=ti(Hi.changes)(t),o=ti(Uh)(n);function a(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(c){return c};return Hi.selector(u),u(n.current)}function l(u){Eh(i,r,s,o)(u)}return[a,l]}function Uh(t,e){return ai(e)?e(t.current):e}function Wh(t,e){return t.current=aa(aa({},t.current),e),e}function $h(t,e,n){return ai(e)?e(t.current):Object.keys(n).forEach(function(i){var r;return(r=e[i])===null||r===void 0?void 0:r.call(e,t.current[i])}),n}var zh={create:jh},Hh={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.33.0/min/vs"}};function Gh(t){return function e(){for(var n=this,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return r.length>=t.length?t.apply(this,r):function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return e.apply(n,[].concat(r,a))}}}function Zh(t){return{}.toString.call(t).includes("Object")}function Xh(t){return t||la("configIsRequired"),Zh(t)||la("configType"),t.urls?(Qh(),{paths:{vs:t.urls.monacoBase}}):t}function Qh(){console.warn(el.deprecation)}function Yh(t,e){throw new Error(t[e]||t.default)}var el={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},la=Gh(Yh)(el),Kh={config:Xh},Jh=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return function(r){return n.reduceRight(function(s,o){return o(s)},r)}};function tl(t,e){return Object.keys(e).forEach(function(n){e[n]instanceof Object&&t[n]&&Object.assign(e[n],tl(t[n],e[n]))}),ra(ra({},t),e)}var ed={type:"cancelation",msg:"operation is manually canceled"};function ps(t){var e=!1,n=new Promise(function(i,r){t.then(function(s){return e?r(ed):i(s)}),t.catch(r)});return n.cancel=function(){return e=!0},n}var td=zh.create({config:Hh,isInitialized:!1,resolve:null,reject:null,monaco:null}),nl=xh(td,2),Ai=nl[0],Dr=nl[1];function nd(t){var e=Kh.config(t),n=e.monaco,i=Ch(e,["monaco"]);Dr(function(r){return{config:tl(r.config,i),monaco:n}})}function id(){var t=Ai(function(e){var n=e.monaco,i=e.isInitialized,r=e.resolve;return{monaco:n,isInitialized:i,resolve:r}});if(!t.isInitialized){if(Dr({isInitialized:!0}),t.monaco)return t.resolve(t.monaco),ps(ms);if(window.monaco&&window.monaco.editor)return il(window.monaco),t.resolve(window.monaco),ps(ms);Jh(rd,od)(ad)}return ps(ms)}function rd(t){return document.body.appendChild(t)}function sd(t){var e=document.createElement("script");return t&&(e.src=t),e}function od(t){var e=Ai(function(i){var r=i.config,s=i.reject;return{config:r,reject:s}}),n=sd("".concat(e.config.paths.vs,"/loader.js"));return n.onload=function(){return t()},n.onerror=e.reject,n}function ad(){var t=Ai(function(n){var i=n.config,r=n.resolve,s=n.reject;return{config:i,resolve:r,reject:s}}),e=window.require;e.config(t.config),e(["vs/editor/editor.main"],function(n){il(n),t.resolve(n)},function(n){t.reject(n)})}function il(t){Ai().monaco||Dr({monaco:t})}function ld(){return Ai(function(t){var e=t.monaco;return e})}var ms=new Promise(function(t,e){return Dr({resolve:t,reject:e})}),ud={config:nd,init:id,__getMonacoInstance:ld};function cd(){const t=Bs(null),e=ud.init(),n=()=>e.cancel();return e.then(i=>t.value=i).catch(i=>{(i==null?void 0:i.type)!=="cancelation"&&console.error("Monaco initialization error:",i)}),{monacoRef:t,unload:n}}const hd={defaultValue:String,defaultPath:String,defaultLanguage:String,value:String,language:String,path:String,theme:{type:String,default:"light"},line:Number,options:{type:Object,default:()=>({})},overrideServices:{type:Object,default:()=>({})},saveViewState:{type:Boolean,default:!0},width:{type:[Number,String],default:"100%"},height:{type:[Number,String],default:"100%"},className:String,"onUpdate:value":Function,onBeforeMount:Function,onMount:Function,onChange:Function,onValidate:Function};function dd(t){return t===void 0}function rl(t,e,n,i){return fd(t,i)||pd(t,e,n,i)}function fd(t,e){return t.editor.getModel(sl(t,e))}function pd(t,e,n,i){return t.editor.createModel(e,n,i?sl(t,i):void 0)}function sl(t,e){return t.Uri.parse(e)}const md={width:{type:[Number,String],required:!0},height:{type:[Number,String],required:!0},isEditorReady:{type:Boolean,required:!0},className:String,setContainerRef:Function},gs={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},gd={display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"};var vd=Mr((t,e)=>{let{slots:n}=e;return()=>{var i;return ce("div",{style:Ss(gd)},[(i=n.default)===null||i===void 0?void 0:i.call(n)])}}),_d=Mr({props:md,setup(t,e){let{slots:n}=e;const i=D(()=>{const{width:s,height:o}=t;return Ss({...gs.wrapper,width:s,height:o})}),r=D(()=>Ss({...gs.fullWidth,...!t.isEditorReady&&gs.hide}));return()=>{var s;return ce("div",{style:i.value},[!t.isEditorReady&&ce(vd,null,{default:()=>[(s=n.default)===null||s===void 0?void 0:s.call(n)]}),ce("div",{ref:t.setContainerRef,style:r.value,class:t.className},null)])}}}),yd=Mr({props:hd,setup(t,e){let{slots:n}=e;const i=new Map,r=Bs(null),s=h=>r.value=h,{monacoRef:o,unload:a}=cd(),{editorRef:l}=bd(t,o,r),{disposeValidator:u}=wd(t,o,l),c=D(()=>!!o.value&&!!l.value);return Da(()=>{var p;var h,f,d;(h=u.value)===null||h===void 0||h.call(u),(f=l.value.getModel())===null||f===void 0||f.dispose(),(p=(d=l.value)===null||d===void 0?void 0:d.dispose())!=null||a()}),re(()=>t.value,h=>{l.value&&l.value.getValue()!==h&&l.value.setValue(h)}),re(()=>t.path,(h,f)=>{const d=rl(o.value,t.value||t.defaultValue,t.language||t.defaultLanguage,h);d!==l.value.getModel()&&(t.saveViewState&&i.set(f,l.value.saveViewState()),l.value.setModel(d),t.saveViewState&&l.value.restoreViewState(i.get(h)))}),re(()=>t.options,h=>l.value&&l.value.updateOptions(h),{deep:!0}),re(()=>t.theme,h=>o.value&&o.value.editor.setTheme(h)),re(()=>t.language,h=>c.value&&o.value.editor.setModelLanguage(l.value.getModel(),h)),re(()=>t.line,h=>{l.value&&!dd(h)&&l.value.revealLine(h)}),()=>{var h;return ce(_d,{setContainerRef:s,width:t.width,height:t.height,isEditorReady:c.value},{default:()=>{var f;return[(f=(h=n.default)===null||h===void 0?void 0:h.call(n))!=null?f:"loading..."]}})}}});function bd(t,e,n){const i=Bs(null);fn(()=>{const s=re(e,()=>{n.value&&e.value&&(we(()=>s()),r())},{immediate:!0})});function r(){var s,o,a;if(!n.value||!e.value||i.value)return;(s=t.onBeforeMount)===null||s===void 0||s.call(t,e.value);const l=t.path||t.defaultPath,u=rl(e.value,t.value||t.defaultValue,t.language||t.defaultLanguage,l);i.value=e.value.editor.create(n.value,{model:u,theme:t.theme,automaticLayout:!0,autoIndent:"brackets",formatOnPaste:!0,formatOnType:!0,...t.options},t.overrideServices),(o=i.value)===null||o===void 0||o.onDidChangeModelContent(c=>{const h=i.value.getValue();if(h!==t.value){var f,d;(f=t["onUpdate:value"])===null||f===void 0||f.call(t,h),(d=t.onChange)===null||d===void 0||d.call(t,h,c)}}),(a=t.onMount)===null||a===void 0||a.call(t,i.value,e.value)}return{editorRef:i}}function wd(t,e,n){const i=Q(null),r=re([e,n],()=>{if(e.value&&n.value){we(()=>r());const s=e.value.editor.onDidChangeMarkers(o=>{var a,l;const u=(a=n.value)===null||a===void 0||(l=a.getModel())===null||l===void 0?void 0:l.uri;if(u&&o.find(f=>f.path===u.path)){var c;const f=e.value.editor.getModelMarkers({resource:u});(c=t.onValidate)===null||c===void 0||c.call(t,f)}});i.value=()=>s==null?void 0:s.dispose()}});return{disposeValidator:i}}var Nn=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Sd(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),e}var ol={},Fr={};function Td(t){var e=new Ze(t),n=e.readChunk();if(n.id!="MThd")throw"Bad MIDI file.  Expected 'MHdr', got: '"+n.id+"'";for(var i=kd(n.data),r=[],s=0;!e.eof()&&s<i.numTracks;s++){var o=e.readChunk();if(o.id!="MTrk")throw"Bad MIDI file.  Expected 'MTrk', got: '"+o.id+"'";var a=Cd(o.data);r.push(a)}return{header:i,tracks:r}}function kd(t){var e=new Ze(t),n=e.readUInt16(),i=e.readUInt16(),r={format:n,numTracks:i},s=e.readUInt16();return s&32768?(r.framesPerSecond=256-(s>>8),r.ticksPerFrame=s&255):r.ticksPerBeat=s,r}function Cd(t){for(var e=new Ze(t),n=[];!e.eof();){var i=s();n.push(i)}return n;var r;function s(){var o={};o.deltaTime=e.readVarInt();var a=e.readUInt8();if((a&240)===240)if(a===255){o.meta=!0;var l=e.readUInt8(),u=e.readVarInt();switch(l){case 0:if(o.type="sequenceNumber",u!==2)throw"Expected length for sequenceNumber event is 2, got "+u;return o.number=e.readUInt16(),o;case 1:return o.type="text",o.text=e.readString(u),o;case 2:return o.type="copyrightNotice",o.text=e.readString(u),o;case 3:return o.type="trackName",o.text=e.readString(u),o;case 4:return o.type="instrumentName",o.text=e.readString(u),o;case 5:return o.type="lyrics",o.text=e.readString(u),o;case 6:return o.type="marker",o.text=e.readString(u),o;case 7:return o.type="cuePoint",o.text=e.readString(u),o;case 32:if(o.type="channelPrefix",u!=1)throw"Expected length for channelPrefix event is 1, got "+u;return o.channel=e.readUInt8(),o;case 33:if(o.type="portPrefix",u!=1)throw"Expected length for portPrefix event is 1, got "+u;return o.port=e.readUInt8(),o;case 47:if(o.type="endOfTrack",u!=0)throw"Expected length for endOfTrack event is 0, got "+u;return o;case 81:if(o.type="setTempo",u!=3)throw"Expected length for setTempo event is 3, got "+u;return o.microsecondsPerBeat=e.readUInt24(),o;case 84:if(o.type="smpteOffset",u!=5)throw"Expected length for smpteOffset event is 5, got "+u;var c=e.readUInt8(),h={0:24,32:25,64:29,96:30};return o.frameRate=h[c&96],o.hour=c&31,o.min=e.readUInt8(),o.sec=e.readUInt8(),o.frame=e.readUInt8(),o.subFrame=e.readUInt8(),o;case 88:if(o.type="timeSignature",u!=2&&u!=4)throw"Expected length for timeSignature event is 4 or 2, got "+u;return o.numerator=e.readUInt8(),o.denominator=1<<e.readUInt8(),u===4?(o.metronome=e.readUInt8(),o.thirtyseconds=e.readUInt8()):(o.metronome=36,o.thirtyseconds=8),o;case 89:if(o.type="keySignature",u!=2)throw"Expected length for keySignature event is 2, got "+u;return o.key=e.readInt8(),o.scale=e.readUInt8(),o;case 127:return o.type="sequencerSpecific",o.data=e.readBytes(u),o;default:return o.type="unknownMeta",o.data=e.readBytes(u),o.metatypeByte=l,o}}else if(a==240){o.type="sysEx";var u=e.readVarInt();return o.data=e.readBytes(u),o}else if(a==247){o.type="endSysEx";var u=e.readVarInt();return o.data=e.readBytes(u),o}else throw"Unrecognised MIDI event type byte: "+a;else{var f;if((a&128)===0){if(r===null)throw"Running status byte encountered before status byte";f=a,a=r,o.running=!0}else f=e.readUInt8(),r=a;var d=a>>4;switch(o.channel=a&15,d){case 8:return o.type="noteOff",o.noteNumber=f,o.velocity=e.readUInt8(),o;case 9:var p=e.readUInt8();return o.type=p===0?"noteOff":"noteOn",o.noteNumber=f,o.velocity=p,p===0&&(o.byte9=!0),o;case 10:return o.type="noteAftertouch",o.noteNumber=f,o.amount=e.readUInt8(),o;case 11:return o.type="controller",o.controllerType=f,o.value=e.readUInt8(),o;case 12:return o.type="programChange",o.programNumber=f,o;case 13:return o.type="channelAftertouch",o.amount=f,o;case 14:return o.type="pitchBend",o.value=f+(e.readUInt8()<<7)-8192,o;default:throw"Unrecognised MIDI event type: "+d}}}}function Ze(t){this.buffer=t,this.bufferLen=this.buffer.length,this.pos=0}Ze.prototype.eof=function(){return this.pos>=this.bufferLen};Ze.prototype.readUInt8=function(){var t=this.buffer[this.pos];return this.pos+=1,t};Ze.prototype.readInt8=function(){var t=this.readUInt8();return t&128?t-256:t};Ze.prototype.readUInt16=function(){var t=this.readUInt8(),e=this.readUInt8();return(t<<8)+e};Ze.prototype.readInt16=function(){var t=this.readUInt16();return t&32768?t-65536:t};Ze.prototype.readUInt24=function(){var t=this.readUInt8(),e=this.readUInt8(),n=this.readUInt8();return(t<<16)+(e<<8)+n};Ze.prototype.readInt24=function(){var t=this.readUInt24();return t&8388608?t-16777216:t};Ze.prototype.readUInt32=function(){var t=this.readUInt8(),e=this.readUInt8(),n=this.readUInt8(),i=this.readUInt8();return(t<<24)+(e<<16)+(n<<8)+i};Ze.prototype.readBytes=function(t){var e=this.buffer.slice(this.pos,this.pos+t);return this.pos+=t,e};Ze.prototype.readString=function(t){var e=this.readBytes(t);return String.fromCharCode.apply(null,e)};Ze.prototype.readVarInt=function(){for(var t=0;!this.eof();){var e=this.readUInt8();if(e&128)t+=e&127,t<<=7;else return t+e}return t};Ze.prototype.readChunk=function(){var t=this.readString(4),e=this.readUInt32(),n=this.readBytes(e);return{id:t,length:e,data:n}};var xd=Td;function Ad(t,e){if(typeof t!="object")throw"Invalid MIDI data";e=e||{};var n=t.header||{},i=t.tracks||[],r,s=i.length,o=new De;for(Id(o,n,s),r=0;r<s;r++)Od(o,i[r],e);return o.buffer}function Id(t,e,n){var i=e.format==null?1:e.format,r=128;e.timeDivision?r=e.timeDivision:e.ticksPerFrame&&e.framesPerSecond?r=-(e.framesPerSecond&255)<<8|e.ticksPerFrame&255:e.ticksPerBeat&&(r=e.ticksPerBeat&32767);var s=new De;s.writeUInt16(i),s.writeUInt16(n),s.writeUInt16(r),t.writeChunk("MThd",s.buffer)}function Od(t,e,n){var i=new De,r,s=e.length,o=null;for(r=0;r<s;r++)(n.running===!1||!n.running&&!e[r].running)&&(o=null),o=Md(i,e[r],o,n.useByte9ForNoteOff);t.writeChunk("MTrk",i.buffer)}function Md(t,e,n,i){var r=e.type,s=e.deltaTime,o=e.text||"",a=e.data||[],l=null;switch(t.writeVarInt(s),r){case"sequenceNumber":t.writeUInt8(255),t.writeUInt8(0),t.writeVarInt(2),t.writeUInt16(e.number);break;case"text":t.writeUInt8(255),t.writeUInt8(1),t.writeVarInt(o.length),t.writeString(o);break;case"copyrightNotice":t.writeUInt8(255),t.writeUInt8(2),t.writeVarInt(o.length),t.writeString(o);break;case"trackName":t.writeUInt8(255),t.writeUInt8(3),t.writeVarInt(o.length),t.writeString(o);break;case"instrumentName":t.writeUInt8(255),t.writeUInt8(4),t.writeVarInt(o.length),t.writeString(o);break;case"lyrics":t.writeUInt8(255),t.writeUInt8(5),t.writeVarInt(o.length),t.writeString(o);break;case"marker":t.writeUInt8(255),t.writeUInt8(6),t.writeVarInt(o.length),t.writeString(o);break;case"cuePoint":t.writeUInt8(255),t.writeUInt8(7),t.writeVarInt(o.length),t.writeString(o);break;case"channelPrefix":t.writeUInt8(255),t.writeUInt8(32),t.writeVarInt(1),t.writeUInt8(e.channel);break;case"portPrefix":t.writeUInt8(255),t.writeUInt8(33),t.writeVarInt(1),t.writeUInt8(e.port);break;case"endOfTrack":t.writeUInt8(255),t.writeUInt8(47),t.writeVarInt(0);break;case"setTempo":t.writeUInt8(255),t.writeUInt8(81),t.writeVarInt(3),t.writeUInt24(e.microsecondsPerBeat);break;case"smpteOffset":t.writeUInt8(255),t.writeUInt8(84),t.writeVarInt(5);var u={24:0,25:32,29:64,30:96},c=e.hour&31|u[e.frameRate];t.writeUInt8(c),t.writeUInt8(e.min),t.writeUInt8(e.sec),t.writeUInt8(e.frame),t.writeUInt8(e.subFrame);break;case"timeSignature":t.writeUInt8(255),t.writeUInt8(88),t.writeVarInt(4),t.writeUInt8(e.numerator);var h=Math.floor(Math.log(e.denominator)/Math.LN2)&255;t.writeUInt8(h),t.writeUInt8(e.metronome),t.writeUInt8(e.thirtyseconds||8);break;case"keySignature":t.writeUInt8(255),t.writeUInt8(89),t.writeVarInt(2),t.writeInt8(e.key),t.writeUInt8(e.scale);break;case"sequencerSpecific":t.writeUInt8(255),t.writeUInt8(127),t.writeVarInt(a.length),t.writeBytes(a);break;case"unknownMeta":e.metatypeByte!=null&&(t.writeUInt8(255),t.writeUInt8(e.metatypeByte),t.writeVarInt(a.length),t.writeBytes(a));break;case"sysEx":t.writeUInt8(240),t.writeVarInt(a.length),t.writeBytes(a);break;case"endSysEx":t.writeUInt8(247),t.writeVarInt(a.length),t.writeBytes(a);break;case"noteOff":var f=i!==!1&&e.byte9||i&&e.velocity==0?144:128;l=f|e.channel,l!==n&&t.writeUInt8(l),t.writeUInt8(e.noteNumber),t.writeUInt8(e.velocity);break;case"noteOn":l=144|e.channel,l!==n&&t.writeUInt8(l),t.writeUInt8(e.noteNumber),t.writeUInt8(e.velocity);break;case"noteAftertouch":l=160|e.channel,l!==n&&t.writeUInt8(l),t.writeUInt8(e.noteNumber),t.writeUInt8(e.amount);break;case"controller":l=176|e.channel,l!==n&&t.writeUInt8(l),t.writeUInt8(e.controllerType),t.writeUInt8(e.value);break;case"programChange":l=192|e.channel,l!==n&&t.writeUInt8(l),t.writeUInt8(e.programNumber);break;case"channelAftertouch":l=208|e.channel,l!==n&&t.writeUInt8(l),t.writeUInt8(e.amount);break;case"pitchBend":l=224|e.channel,l!==n&&t.writeUInt8(l);var d=8192+e.value,p=d&127,g=d>>7&127;t.writeUInt8(p),t.writeUInt8(g);break;default:throw"Unrecognized event type: "+r}return l}function De(){this.buffer=[]}De.prototype.writeUInt8=function(t){this.buffer.push(t&255)};De.prototype.writeInt8=De.prototype.writeUInt8;De.prototype.writeUInt16=function(t){var e=t>>8&255,n=t&255;this.writeUInt8(e),this.writeUInt8(n)};De.prototype.writeInt16=De.prototype.writeUInt16;De.prototype.writeUInt24=function(t){var e=t>>16&255,n=t>>8&255,i=t&255;this.writeUInt8(e),this.writeUInt8(n),this.writeUInt8(i)};De.prototype.writeInt24=De.prototype.writeUInt24;De.prototype.writeUInt32=function(t){var e=t>>24&255,n=t>>16&255,i=t>>8&255,r=t&255;this.writeUInt8(e),this.writeUInt8(n),this.writeUInt8(i),this.writeUInt8(r)};De.prototype.writeInt32=De.prototype.writeUInt32;De.prototype.writeBytes=function(t){this.buffer=this.buffer.concat(Array.prototype.slice.call(t,0))};De.prototype.writeString=function(t){var e,n=t.length,i=[];for(e=0;e<n;e++)i.push(t.codePointAt(e));this.writeBytes(i)};De.prototype.writeVarInt=function(t){if(t<0)throw"Cannot write negative variable-length integer";if(t<=127)this.writeUInt8(t);else{var e=t,n=[];for(n.push(e&127),e>>=7;e;){var i=e&127|128;n.push(i),e>>=7}this.writeBytes(n.reverse())}};De.prototype.writeChunk=function(t,e){this.writeString(t),this.writeUInt32(e.length),this.writeBytes(e)};var Nd=Ad,Ed=Fr.parseMidi=xd;Fr.writeMidi=Nd;var lr={},an={};Object.defineProperty(an,"__esModule",{value:!0});an.insert=an.search=void 0;function al(t,e,n){n===void 0&&(n="ticks");var i=0,r=t.length,s=r;if(r>0&&t[r-1][n]<=e)return r-1;for(;i<s;){var o=Math.floor(i+(s-i)/2),a=t[o],l=t[o+1];if(a[n]===e){for(var u=o;u<t.length;u++){var c=t[u];c[n]===e&&(o=u)}return o}else{if(a[n]<e&&l[n]>e)return o;a[n]>e?s=o:a[n]<e&&(i=o+1)}}return-1}an.search=al;function Vd(t,e,n){if(n===void 0&&(n="ticks"),t.length){var i=al(t,e[n],n);t.splice(i+1,0,e)}else t.push(e)}an.insert=Vd;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Header=t.keySignatureKeys=void 0;var e=an,n=new WeakMap;t.keySignatureKeys=["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"];var i=function(){function r(s){var o=this;if(this.tempos=[],this.timeSignatures=[],this.keySignatures=[],this.meta=[],this.name="",n.set(this,480),s){n.set(this,s.header.ticksPerBeat),s.tracks.forEach(function(l){l.forEach(function(u){u.meta&&(u.type==="timeSignature"?o.timeSignatures.push({ticks:u.absoluteTime,timeSignature:[u.numerator,u.denominator]}):u.type==="setTempo"?o.tempos.push({bpm:6e7/u.microsecondsPerBeat,ticks:u.absoluteTime}):u.type==="keySignature"&&o.keySignatures.push({key:t.keySignatureKeys[u.key+7],scale:u.scale===0?"major":"minor",ticks:u.absoluteTime}))})});var a=0;s.tracks[0].forEach(function(l){a+=l.deltaTime,l.meta&&(l.type==="trackName"?o.name=l.text:(l.type==="text"||l.type==="cuePoint"||l.type==="marker"||l.type==="lyrics")&&o.meta.push({text:l.text,ticks:a,type:l.type}))}),this.update()}}return r.prototype.update=function(){var s=this,o=0,a=0;this.tempos.sort(function(l,u){return l.ticks-u.ticks}),this.tempos.forEach(function(l,u){var c=u>0?s.tempos[u-1].bpm:s.tempos[0].bpm,h=l.ticks/s.ppq-a,f=60/c*h;l.time=f+o,o=l.time,a+=h}),this.timeSignatures.sort(function(l,u){return l.ticks-u.ticks}),this.timeSignatures.forEach(function(l,u){var c=u>0?s.timeSignatures[u-1]:s.timeSignatures[0],h=(l.ticks-c.ticks)/s.ppq,f=h/c.timeSignature[0]/(c.timeSignature[1]/4);c.measures=c.measures||0,l.measures=f+c.measures})},r.prototype.ticksToSeconds=function(s){var o=(0,e.search)(this.tempos,s);if(o!==-1){var a=this.tempos[o],l=a.time,u=(s-a.ticks)/this.ppq;return l+60/a.bpm*u}else{var c=s/this.ppq;return 60/120*c}},r.prototype.ticksToMeasures=function(s){var o=(0,e.search)(this.timeSignatures,s);if(o!==-1){var a=this.timeSignatures[o],l=(s-a.ticks)/this.ppq;return a.measures+l/(a.timeSignature[0]/a.timeSignature[1])/4}else return s/this.ppq/4},Object.defineProperty(r.prototype,"ppq",{get:function(){return n.get(this)},enumerable:!1,configurable:!0}),r.prototype.secondsToTicks=function(s){var o=(0,e.search)(this.tempos,s,"time");if(o!==-1){var a=this.tempos[o],l=a.time,u=s-l,c=u/(60/a.bpm);return Math.round(a.ticks+c*this.ppq)}else{var h=s/.5;return Math.round(h*this.ppq)}},r.prototype.toJSON=function(){return{keySignatures:this.keySignatures,meta:this.meta,name:this.name,ppq:this.ppq,tempos:this.tempos.map(function(s){return{bpm:s.bpm,ticks:s.ticks}}),timeSignatures:this.timeSignatures}},r.prototype.fromJSON=function(s){this.name=s.name,this.tempos=s.tempos.map(function(o){return Object.assign({},o)}),this.timeSignatures=s.timeSignatures.map(function(o){return Object.assign({},o)}),this.keySignatures=s.keySignatures.map(function(o){return Object.assign({},o)}),this.meta=s.meta.map(function(o){return Object.assign({},o)}),n.set(this,s.ppq),this.update()},r.prototype.setTempo=function(s){this.tempos=[{bpm:s,ticks:0}],this.update()},r}();t.Header=i})(lr);var li={},Us={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ControlChange=t.controlChangeIds=t.controlChangeNames=void 0,t.controlChangeNames={1:"modulationWheel",2:"breath",4:"footController",5:"portamentoTime",7:"volume",8:"balance",10:"pan",64:"sustain",65:"portamentoTime",66:"sostenuto",67:"softPedal",68:"legatoFootswitch",84:"portamentoControl"},t.controlChangeIds=Object.keys(t.controlChangeNames).reduce(function(r,s){return r[t.controlChangeNames[s]]=s,r},{});var e=new WeakMap,n=new WeakMap,i=function(){function r(s,o){e.set(this,o),n.set(this,s.controllerType),this.ticks=s.absoluteTime,this.value=s.value}return Object.defineProperty(r.prototype,"number",{get:function(){return n.get(this)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"name",{get:function(){return t.controlChangeNames[this.number]?t.controlChangeNames[this.number]:null},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"time",{get:function(){var s=e.get(this);return s.ticksToSeconds(this.ticks)},set:function(s){var o=e.get(this);this.ticks=o.secondsToTicks(s)},enumerable:!1,configurable:!0}),r.prototype.toJSON=function(){return{number:this.number,ticks:this.ticks,time:this.time,value:this.value}},r}();t.ControlChange=i})(Us);var Pr={};Object.defineProperty(Pr,"__esModule",{value:!0});Pr.createControlChanges=void 0;var Gi=Us;function Dd(){return new Proxy({},{get:function(t,e){if(t[e])return t[e];if(Gi.controlChangeIds.hasOwnProperty(e))return t[Gi.controlChangeIds[e]]},set:function(t,e,n){return Gi.controlChangeIds.hasOwnProperty(e)?t[Gi.controlChangeIds[e]]=n:t[e]=n,!0}})}Pr.createControlChanges=Dd;var Rr={};Object.defineProperty(Rr,"__esModule",{value:!0});Rr.PitchBend=void 0;var vs=new WeakMap,Fd=function(){function t(e,n){vs.set(this,n),this.ticks=e.absoluteTime,this.value=e.value}return Object.defineProperty(t.prototype,"time",{get:function(){var e=vs.get(this);return e.ticksToSeconds(this.ticks)},set:function(e){var n=vs.get(this);this.ticks=n.secondsToTicks(e)},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return{ticks:this.ticks,time:this.time,value:this.value}},t}();Rr.PitchBend=Fd;var qr={},Lt={};Object.defineProperty(Lt,"__esModule",{value:!0});Lt.DrumKitByPatchID=Lt.InstrumentFamilyByID=Lt.instrumentByPatchID=void 0;Lt.instrumentByPatchID=["acoustic grand piano","bright acoustic piano","electric grand piano","honky-tonk piano","electric piano 1","electric piano 2","harpsichord","clavi","celesta","glockenspiel","music box","vibraphone","marimba","xylophone","tubular bells","dulcimer","drawbar organ","percussive organ","rock organ","church organ","reed organ","accordion","harmonica","tango accordion","acoustic guitar (nylon)","acoustic guitar (steel)","electric guitar (jazz)","electric guitar (clean)","electric guitar (muted)","overdriven guitar","distortion guitar","guitar harmonics","acoustic bass","electric bass (finger)","electric bass (pick)","fretless bass","slap bass 1","slap bass 2","synth bass 1","synth bass 2","violin","viola","cello","contrabass","tremolo strings","pizzicato strings","orchestral harp","timpani","string ensemble 1","string ensemble 2","synthstrings 1","synthstrings 2","choir aahs","voice oohs","synth voice","orchestra hit","trumpet","trombone","tuba","muted trumpet","french horn","brass section","synthbrass 1","synthbrass 2","soprano sax","alto sax","tenor sax","baritone sax","oboe","english horn","bassoon","clarinet","piccolo","flute","recorder","pan flute","blown bottle","shakuhachi","whistle","ocarina","lead 1 (square)","lead 2 (sawtooth)","lead 3 (calliope)","lead 4 (chiff)","lead 5 (charang)","lead 6 (voice)","lead 7 (fifths)","lead 8 (bass + lead)","pad 1 (new age)","pad 2 (warm)","pad 3 (polysynth)","pad 4 (choir)","pad 5 (bowed)","pad 6 (metallic)","pad 7 (halo)","pad 8 (sweep)","fx 1 (rain)","fx 2 (soundtrack)","fx 3 (crystal)","fx 4 (atmosphere)","fx 5 (brightness)","fx 6 (goblins)","fx 7 (echoes)","fx 8 (sci-fi)","sitar","banjo","shamisen","koto","kalimba","bag pipe","fiddle","shanai","tinkle bell","agogo","steel drums","woodblock","taiko drum","melodic tom","synth drum","reverse cymbal","guitar fret noise","breath noise","seashore","bird tweet","telephone ring","helicopter","applause","gunshot"];Lt.InstrumentFamilyByID=["piano","chromatic percussion","organ","guitar","bass","strings","ensemble","brass","reed","pipe","synth lead","synth pad","synth effects","world","percussive","sound effects"];Lt.DrumKitByPatchID={0:"standard kit",8:"room kit",16:"power kit",24:"electronic kit",25:"tr-808 kit",32:"jazz kit",40:"brush kit",48:"orchestra kit",56:"sound fx kit"};Object.defineProperty(qr,"__esModule",{value:!0});qr.Instrument=void 0;var Zi=Lt,ua=new WeakMap,Pd=function(){function t(e,n){if(this.number=0,ua.set(this,n),this.number=0,e){var i=e.find(function(r){return r.type==="programChange"});i&&(this.number=i.programNumber)}}return Object.defineProperty(t.prototype,"name",{get:function(){return this.percussion?Zi.DrumKitByPatchID[this.number]:Zi.instrumentByPatchID[this.number]},set:function(e){var n=Zi.instrumentByPatchID.indexOf(e);n!==-1&&(this.number=n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"family",{get:function(){return this.percussion?"drums":Zi.InstrumentFamilyByID[Math.floor(this.number/8)]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"percussion",{get:function(){var e=ua.get(this);return e.channel===9},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return{family:this.family,number:this.number,name:this.name}},t.prototype.fromJSON=function(e){this.number=e.number},t}();qr.Instrument=Pd;var Br={};Object.defineProperty(Br,"__esModule",{value:!0});Br.Note=void 0;function Rd(t){var e=Math.floor(t/12)-1;return ll(t)+e.toString()}function ll(t){var e=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],n=t%12;return e[n]}function qd(t){var e=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return e.indexOf(t)}var Bd=function(){var t=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,e={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13};return function(n){var i=t.exec(n),r=i[1],s=i[2],o=e[r.toLowerCase()];return o+(parseInt(s,10)+1)*12}}(),On=new WeakMap,Ld=function(){function t(e,n,i){On.set(this,i),this.midi=e.midi,this.velocity=e.velocity,this.noteOffVelocity=n.velocity,this.ticks=e.ticks,this.durationTicks=n.ticks-e.ticks}return Object.defineProperty(t.prototype,"name",{get:function(){return Rd(this.midi)},set:function(e){this.midi=Bd(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"octave",{get:function(){return Math.floor(this.midi/12)-1},set:function(e){var n=e-this.octave;this.midi+=n*12},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pitch",{get:function(){return ll(this.midi)},set:function(e){this.midi=12*(this.octave+1)+qd(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){var e=On.get(this);return e.ticksToSeconds(this.ticks+this.durationTicks)-e.ticksToSeconds(this.ticks)},set:function(e){var n=On.get(this),i=n.secondsToTicks(this.time+e);this.durationTicks=i-this.ticks},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"time",{get:function(){var e=On.get(this);return e.ticksToSeconds(this.ticks)},set:function(e){var n=On.get(this);this.ticks=n.secondsToTicks(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bars",{get:function(){var e=On.get(this);return e.ticksToMeasures(this.ticks)},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return{duration:this.duration,durationTicks:this.durationTicks,midi:this.midi,name:this.name,ticks:this.ticks,time:this.time,velocity:this.velocity}},t}();Br.Note=Ld;Object.defineProperty(li,"__esModule",{value:!0});li.Track=void 0;var _s=an,jd=Us,Ud=Pr,Wd=Rr,ca=qr,$d=Br,Xi=new WeakMap,zd=function(){function t(e,n){var i=this;if(this.name="",this.notes=[],this.controlChanges=(0,Ud.createControlChanges)(),this.pitchBends=[],Xi.set(this,n),e){var r=e.find(function(f){return f.type==="trackName"});this.name=r?r.text:""}if(this.instrument=new ca.Instrument(e,this),this.channel=0,e){for(var s=e.filter(function(f){return f.type==="noteOn"}),o=e.filter(function(f){return f.type==="noteOff"}),a=function(){var f=s.shift();l.channel=f.channel;var d=o.findIndex(function(g){return g.noteNumber===f.noteNumber&&g.absoluteTime>=f.absoluteTime});if(d!==-1){var p=o.splice(d,1)[0];l.addNote({durationTicks:p.absoluteTime-f.absoluteTime,midi:f.noteNumber,noteOffVelocity:p.velocity/127,ticks:f.absoluteTime,velocity:f.velocity/127})}},l=this;s.length;)a();var u=e.filter(function(f){return f.type==="controller"});u.forEach(function(f){i.addCC({number:f.controllerType,ticks:f.absoluteTime,value:f.value/127})});var c=e.filter(function(f){return f.type==="pitchBend"});c.forEach(function(f){i.addPitchBend({ticks:f.absoluteTime,value:f.value/Math.pow(2,13)})});var h=e.find(function(f){return f.type==="endOfTrack"});this.endOfTrackTicks=h!==void 0?h.absoluteTime:void 0}}return t.prototype.addNote=function(e){var n=Xi.get(this),i=new $d.Note({midi:0,ticks:0,velocity:1},{ticks:0,velocity:0},n);return Object.assign(i,e),(0,_s.insert)(this.notes,i,"ticks"),this},t.prototype.addCC=function(e){var n=Xi.get(this),i=new jd.ControlChange({controllerType:e.number},n);return delete e.number,Object.assign(i,e),Array.isArray(this.controlChanges[i.number])||(this.controlChanges[i.number]=[]),(0,_s.insert)(this.controlChanges[i.number],i,"ticks"),this},t.prototype.addPitchBend=function(e){var n=Xi.get(this),i=new Wd.PitchBend({},n);return Object.assign(i,e),(0,_s.insert)(this.pitchBends,i,"ticks"),this},Object.defineProperty(t.prototype,"duration",{get:function(){if(!this.notes.length)return 0;for(var e=this.notes[this.notes.length-1].time+this.notes[this.notes.length-1].duration,n=0;n<this.notes.length-1;n++){var i=this.notes[n].time+this.notes[n].duration;e<i&&(e=i)}return e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"durationTicks",{get:function(){if(!this.notes.length)return 0;for(var e=this.notes[this.notes.length-1].ticks+this.notes[this.notes.length-1].durationTicks,n=0;n<this.notes.length-1;n++){var i=this.notes[n].ticks+this.notes[n].durationTicks;e<i&&(e=i)}return e},enumerable:!1,configurable:!0}),t.prototype.fromJSON=function(e){var n=this;this.name=e.name,this.channel=e.channel,this.instrument=new ca.Instrument(void 0,this),this.instrument.fromJSON(e.instrument),e.endOfTrackTicks!==void 0&&(this.endOfTrackTicks=e.endOfTrackTicks);for(var i in e.controlChanges)e.controlChanges[i]&&e.controlChanges[i].forEach(function(r){n.addCC({number:r.number,ticks:r.ticks,value:r.value})});e.notes.forEach(function(r){n.addNote({durationTicks:r.durationTicks,midi:r.midi,ticks:r.ticks,velocity:r.velocity})})},t.prototype.toJSON=function(){for(var e={},n=0;n<127;n++)this.controlChanges.hasOwnProperty(n)&&(e[n]=this.controlChanges[n].map(function(r){return r.toJSON()}));var i={channel:this.channel,controlChanges:e,pitchBends:this.pitchBends.map(function(r){return r.toJSON()}),instrument:this.instrument.toJSON(),name:this.name,notes:this.notes.map(function(r){return r.toJSON()})};return this.endOfTrackTicks!==void 0&&(i.endOfTrackTicks=this.endOfTrackTicks),i},t}();li.Track=zd;var Lr={};function Hd(t){var e=[];return ul(t,e),e}function ul(t,e){for(var n=0;n<t.length;n++){var i=t[n];Array.isArray(i)?ul(i,e):e.push(i)}}var Gd=Object.freeze(Object.defineProperty({__proto__:null,flatten:Hd},Symbol.toStringTag,{value:"Module"})),Zd=Sd(Gd),Ft=Nn&&Nn.__spreadArray||function(t,e,n){if(n||arguments.length===2)for(var i=0,r=e.length,s;i<r;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))};Object.defineProperty(Lr,"__esModule",{value:!0});Lr.encode=void 0;var Xd=Fr,Qd=lr,Yd=Zd;function Kd(t,e){return[{absoluteTime:t.ticks,channel:e,deltaTime:0,noteNumber:t.midi,type:"noteOn",velocity:Math.floor(t.velocity*127)},{absoluteTime:t.ticks+t.durationTicks,channel:e,deltaTime:0,noteNumber:t.midi,type:"noteOff",velocity:Math.floor(t.noteOffVelocity*127)}]}function Jd(t){return(0,Yd.flatten)(t.notes.map(function(e){return Kd(e,t.channel)}))}function ef(t,e){return{absoluteTime:t.ticks,channel:e,controllerType:t.number,deltaTime:0,type:"controller",value:Math.floor(t.value*127)}}function tf(t){for(var e=[],n=0;n<127;n++)t.controlChanges.hasOwnProperty(n)&&t.controlChanges[n].forEach(function(i){e.push(ef(i,t.channel))});return e}function nf(t,e){return{absoluteTime:t.ticks,channel:e,deltaTime:0,type:"pitchBend",value:t.value}}function rf(t){var e=[];return t.pitchBends.forEach(function(n){e.push(nf(n,t.channel))}),e}function sf(t){return{absoluteTime:0,channel:t.channel,deltaTime:0,programNumber:t.instrument.number,type:"programChange"}}function of(t){return{absoluteTime:0,deltaTime:0,meta:!0,text:t,type:"trackName"}}function af(t){return{absoluteTime:t.ticks,deltaTime:0,meta:!0,microsecondsPerBeat:Math.floor(6e7/t.bpm),type:"setTempo"}}function lf(t){return{absoluteTime:t.ticks,deltaTime:0,denominator:t.timeSignature[1],meta:!0,metronome:24,numerator:t.timeSignature[0],thirtyseconds:8,type:"timeSignature"}}function uf(t){var e=Qd.keySignatureKeys.indexOf(t.key);return{absoluteTime:t.ticks,deltaTime:0,key:e+7,meta:!0,scale:t.scale==="major"?0:1,type:"keySignature"}}function cf(t){return{absoluteTime:t.ticks,deltaTime:0,meta:!0,text:t.text,type:t.type}}function hf(t){var e={header:{format:1,numTracks:t.tracks.length+1,ticksPerBeat:t.header.ppq},tracks:Ft([Ft(Ft(Ft(Ft([{absoluteTime:0,deltaTime:0,meta:!0,text:t.header.name,type:"trackName"}],t.header.keySignatures.map(function(n){return uf(n)}),!0),t.header.meta.map(function(n){return cf(n)}),!0),t.header.tempos.map(function(n){return af(n)}),!0),t.header.timeSignatures.map(function(n){return lf(n)}),!0)],t.tracks.map(function(n){return Ft(Ft(Ft([of(n.name),sf(n)],Jd(n),!0),tf(n),!0),rf(n),!0)}),!0)};return e.tracks=e.tracks.map(function(n){n=n.sort(function(r,s){return r.absoluteTime-s.absoluteTime});var i=0;return n.forEach(function(r){r.deltaTime=r.absoluteTime-i,i=r.absoluteTime,delete r.absoluteTime}),n.push({deltaTime:0,meta:!0,type:"endOfTrack"}),n}),new Uint8Array((0,Xd.writeMidi)(e))}Lr.encode=hf;(function(t){var e=Nn&&Nn.__awaiter||function(h,f,d,p){function g(m){return m instanceof d?m:new d(function(w){w(m)})}return new(d||(d=Promise))(function(m,w){function b(v){try{T(p.next(v))}catch(_){w(_)}}function C(v){try{T(p.throw(v))}catch(_){w(_)}}function T(v){v.done?m(v.value):g(v.value).then(b,C)}T((p=p.apply(h,f||[])).next())})},n=Nn&&Nn.__generator||function(h,f){var d={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},p,g,m,w;return w={next:b(0),throw:b(1),return:b(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function b(T){return function(v){return C([T,v])}}function C(T){if(p)throw new TypeError("Generator is already executing.");for(;d;)try{if(p=1,g&&(m=T[0]&2?g.return:T[0]?g.throw||((m=g.return)&&m.call(g),0):g.next)&&!(m=m.call(g,T[1])).done)return m;switch(g=0,m&&(T=[T[0]&2,m.value]),T[0]){case 0:case 1:m=T;break;case 4:return d.label++,{value:T[1],done:!1};case 5:d.label++,g=T[1],T=[0];continue;case 7:T=d.ops.pop(),d.trys.pop();continue;default:if(m=d.trys,!(m=m.length>0&&m[m.length-1])&&(T[0]===6||T[0]===2)){d=0;continue}if(T[0]===3&&(!m||T[1]>m[0]&&T[1]<m[3])){d.label=T[1];break}if(T[0]===6&&d.label<m[1]){d.label=m[1],m=T;break}if(m&&d.label<m[2]){d.label=m[2],d.ops.push(T);break}m[2]&&d.ops.pop(),d.trys.pop();continue}T=f.call(h,d)}catch(v){T=[6,v],g=0}finally{p=m=0}if(T[0]&5)throw T[1];return{value:T[0]?T[1]:void 0,done:!0}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Header=t.Track=t.Midi=void 0;var i=Fr,r=lr,s=li,o=Lr,a=function(){function h(f){var d=this,p=null;if(f){var g=f instanceof ArrayBuffer?new Uint8Array(f):f;p=(0,i.parseMidi)(g),p.tracks.forEach(function(m){var w=0;m.forEach(function(b){w+=b.deltaTime,b.absoluteTime=w})}),p.tracks=c(p.tracks)}this.header=new r.Header(p),this.tracks=[],f&&(this.tracks=p.tracks.map(function(m){return new s.Track(m,d.header)}),p.header.format===1&&this.tracks[0].duration===0&&this.tracks.shift())}return h.fromUrl=function(f){return e(this,void 0,void 0,function(){var d,p;return n(this,function(g){switch(g.label){case 0:return[4,fetch(f)];case 1:return d=g.sent(),d.ok?[4,d.arrayBuffer()]:[3,3];case 2:return p=g.sent(),[2,new h(p)];case 3:throw new Error("Could not load '".concat(f,"'"))}})})},Object.defineProperty(h.prototype,"name",{get:function(){return this.header.name},set:function(f){this.header.name=f},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"duration",{get:function(){var f=this.tracks.map(function(d){return d.duration});return Math.max.apply(Math,f)},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"durationTicks",{get:function(){var f=this.tracks.map(function(d){return d.durationTicks});return Math.max.apply(Math,f)},enumerable:!1,configurable:!0}),h.prototype.addTrack=function(){var f=new s.Track(void 0,this.header);return this.tracks.push(f),f},h.prototype.toArray=function(){return(0,o.encode)(this)},h.prototype.toJSON=function(){return{header:this.header.toJSON(),tracks:this.tracks.map(function(f){return f.toJSON()})}},h.prototype.fromJSON=function(f){var d=this;this.header=new r.Header,this.header.fromJSON(f.header),this.tracks=f.tracks.map(function(p){var g=new s.Track(void 0,d.header);return g.fromJSON(p),g})},h.prototype.clone=function(){var f=new h;return f.fromJSON(this.toJSON()),f},h}();t.Midi=a;var l=li;Object.defineProperty(t,"Track",{enumerable:!0,get:function(){return l.Track}});var u=lr;Object.defineProperty(t,"Header",{enumerable:!0,get:function(){return u.Header}});function c(h){for(var f=[],d=0;d<h.length;d++)for(var p=f.length,g=new Map,m=Array(16).fill(0),w=0,b=h[d];w<b.length;w++){var C=b[w],T=p,v=C.channel;if(v!==void 0){C.type==="programChange"&&(m[v]=C.programNumber);var _=m[v],y="".concat(_," ").concat(v);g.has(y)?T=g.get(y):(T=p+g.size,g.set(y,T))}f[T]||f.push([]),f[T].push(C)}return f}})(ol);const cl="14.7.77",ha=(t,e,n)=>({endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}),da=(t,e,n)=>({endTime:e,insertTime:n,type:"linearRampToValue",value:t}),xs=(t,e)=>({startTime:e,type:"setValue",value:t}),hl=(t,e,n)=>({duration:n,startTime:e,type:"setValueCurve",values:t}),dl=(t,e,{startTime:n,target:i,timeConstant:r})=>i+(e-i)*Math.exp((n-t)/r),En=t=>t.type==="exponentialRampToValue",ur=t=>t.type==="linearRampToValue",Rt=t=>En(t)||ur(t),Ws=t=>t.type==="setValue",xt=t=>t.type==="setValueCurve",cr=(t,e,n,i)=>{const r=t[e];return r===void 0?i:Rt(r)||Ws(r)?r.value:xt(r)?r.values[r.values.length-1]:dl(n,cr(t,e-1,r.startTime,i),r)},fa=(t,e,n,i,r)=>n===void 0?[i.insertTime,r]:Rt(n)?[n.endTime,n.value]:Ws(n)?[n.startTime,n.value]:xt(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,cr(t,e-1,n.startTime,r)],As=t=>t.type==="cancelAndHold",Is=t=>t.type==="cancelScheduledValues",Pt=t=>As(t)||Is(t)?t.cancelTime:En(t)||ur(t)?t.endTime:t.startTime,pa=(t,e,n,{endTime:i,value:r})=>n===r?r:0<n&&0<r||n<0&&r<0?n*(r/n)**((t-e)/(i-e)):0,ma=(t,e,n,{endTime:i,value:r})=>n+(t-e)/(i-e)*(r-n),df=(t,e)=>{const n=Math.floor(e),i=Math.ceil(e);return n===i?t[n]:(1-(e-n))*t[n]+(1-(i-e))*t[i]},ff=(t,{duration:e,startTime:n,values:i})=>{const r=(t-n)/e*(i.length-1);return df(i,r)},Qi=t=>t.type==="setTarget";class pf{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const n=Pt(e);if(As(e)||Is(e)){const i=this._automationEvents.findIndex(s=>Is(e)&&xt(s)?s.startTime+s.duration>=n:Pt(s)>=n),r=this._automationEvents[i];if(i!==-1&&(this._automationEvents=this._automationEvents.slice(0,i)),As(e)){const s=this._automationEvents[this._automationEvents.length-1];if(r!==void 0&&Rt(r)){if(Qi(s))throw new Error("The internal list is malformed.");const o=xt(s)?s.startTime+s.duration:Pt(s),a=xt(s)?s.values[s.values.length-1]:s.value,l=En(r)?pa(n,o,a,r):ma(n,o,a,r),u=En(r)?ha(l,n,this._currenTime):da(l,n,this._currenTime);this._automationEvents.push(u)}s!==void 0&&Qi(s)&&this._automationEvents.push(xs(this.getValue(n),n)),s!==void 0&&xt(s)&&s.startTime+s.duration>n&&(this._automationEvents[this._automationEvents.length-1]=hl(new Float32Array([6,7]),s.startTime,n-s.startTime))}}else{const i=this._automationEvents.findIndex(o=>Pt(o)>n),r=i===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[i-1];if(r!==void 0&&xt(r)&&Pt(r)+r.duration>n)return!1;const s=En(e)?ha(e.value,e.endTime,this._currenTime):ur(e)?da(e.value,n,this._currenTime):e;if(i===-1)this._automationEvents.push(s);else{if(xt(e)&&n+e.duration>Pt(this._automationEvents[i]))return!1;this._automationEvents.splice(i,0,s)}}return!0}flush(e){const n=this._automationEvents.findIndex(i=>Pt(i)>e);if(n>1){const i=this._automationEvents.slice(n-1),r=i[0];Qi(r)&&i.unshift(xs(cr(this._automationEvents,n-2,r.startTime,this._defaultValue),r.startTime)),this._automationEvents=i}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const n=this._automationEvents.findIndex(o=>Pt(o)>e),i=this._automationEvents[n],r=(n===-1?this._automationEvents.length:n)-1,s=this._automationEvents[r];if(s!==void 0&&Qi(s)&&(i===void 0||!Rt(i)||i.insertTime>e))return dl(e,cr(this._automationEvents,r-1,s.startTime,this._defaultValue),s);if(s!==void 0&&Ws(s)&&(i===void 0||!Rt(i)))return s.value;if(s!==void 0&&xt(s)&&(i===void 0||!Rt(i)||s.startTime+s.duration>e))return e<s.startTime+s.duration?ff(e,s):s.values[s.values.length-1];if(s!==void 0&&Rt(s)&&(i===void 0||!Rt(i)))return s.value;if(i!==void 0&&En(i)){const[o,a]=fa(this._automationEvents,r,s,i,this._defaultValue);return pa(e,o,a,i)}if(i!==void 0&&ur(i)){const[o,a]=fa(this._automationEvents,r,s,i,this._defaultValue);return ma(e,o,a,i)}return this._defaultValue}}const mf=t=>({cancelTime:t,type:"cancelAndHold"}),gf=t=>({cancelTime:t,type:"cancelScheduledValues"}),vf=(t,e)=>({endTime:e,type:"exponentialRampToValue",value:t}),_f=(t,e)=>({endTime:e,type:"linearRampToValue",value:t}),yf=(t,e,n)=>({startTime:e,target:t,timeConstant:n,type:"setTarget"}),bf=()=>new DOMException("","AbortError"),wf=t=>(e,n,[i,r,s],o)=>{t(e[r],[n,i,s],a=>a[0]===n&&a[1]===i,o)},Sf=t=>(e,n,i)=>{const r=[];for(let s=0;s<i.numberOfInputs;s+=1)r.push(new Set);t.set(e,{activeInputs:r,outputs:new Set,passiveInputs:new WeakMap,renderer:n})},Tf=t=>(e,n)=>{t.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:n})},Pn=new WeakSet,fl=new WeakMap,$s=new WeakMap,pl=new WeakMap,zs=new WeakMap,jr=new WeakMap,ml=new WeakMap,Os=new WeakMap,Ms=new WeakMap,Ns=new WeakMap,gl={construct(){return gl}},kf=t=>{try{const e=new Proxy(t,gl);new e}catch{return!1}return!0},ga=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,va=(t,e)=>{const n=[];let i=t.replace(/^[\s]+/,""),r=i.match(ga);for(;r!==null;){const s=r[1].slice(1,-1),o=r[0].replace(/([\s]+)?;?$/,"").replace(s,new URL(s,e).toString());n.push(o),i=i.slice(r[0].length).replace(/^[\s]+/,""),r=i.match(ga)}return[n.join(";"),i]},_a=t=>{if(t!==void 0&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},ya=t=>{if(!kf(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(t.prototype===null||typeof t.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},Cf=(t,e,n,i,r,s,o,a,l,u,c,h,f)=>{let d=0;return(p,g,m={credentials:"omit"})=>{const w=c.get(p);if(w!==void 0&&w.has(g))return Promise.resolve();const b=u.get(p);if(b!==void 0){const v=b.get(g);if(v!==void 0)return v}const C=s(p),T=C.audioWorklet===void 0?r(g).then(([v,_])=>{const[y,S]=va(v,_),A=`${y};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${S}
})})(window,'_AWGS')`;return n(A)}).then(()=>{const v=f._AWGS.pop();if(v===void 0)throw new SyntaxError;i(C.currentTime,C.sampleRate,()=>v(class{},void 0,(_,y)=>{if(_.trim()==="")throw e();const S=Ms.get(C);if(S!==void 0){if(S.has(_))throw e();ya(y),_a(y.parameterDescriptors),S.set(_,y)}else ya(y),_a(y.parameterDescriptors),Ms.set(C,new Map([[_,y]]))},C.sampleRate,void 0,void 0))}):Promise.all([r(g),Promise.resolve(t(h,h))]).then(([[v,_],y])=>{const S=d+1;d=S;const[A,I]=va(v,_),F=`${A};((AudioWorkletProcessor,registerProcessor)=>{${I}
})(${y?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${y?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${y?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${S}',class extends AudioWorkletProcessor{process(){return !1}})`,W=new Blob([F],{type:"application/javascript; charset=utf-8"}),j=URL.createObjectURL(W);return C.audioWorklet.addModule(j,m).then(()=>{if(a(C))return C;const O=o(C);return O.audioWorklet.addModule(j,m).then(()=>O)}).then(O=>{if(l===null)throw new SyntaxError;try{new l(O,`__sac${S}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(j))});return b===void 0?u.set(p,new Map([[g,T]])):b.set(g,T),T.then(()=>{const v=c.get(p);v===void 0?c.set(p,new Set([g])):v.add(g)}).finally(()=>{const v=u.get(p);v!==void 0&&v.delete(g)}),T}},ft=(t,e)=>{const n=t.get(e);if(n===void 0)throw new Error("A value with the given key could not be found.");return n},Ur=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(n.length===0)throw Error("No element was found.");const[i]=n;return t.delete(i),i},vl=(t,e,n,i)=>{const r=ft(t,e),s=Ur(r,o=>o[0]===n&&o[1]===i);return r.size===0&&t.delete(e),s},Ii=t=>ft(ml,t),Rn=t=>{if(Pn.has(t))throw new Error("The AudioNode is already stored.");Pn.add(t),Ii(t).forEach(e=>e(!0))},_l=t=>"port"in t,Oi=t=>{if(!Pn.has(t))throw new Error("The AudioNode is not stored.");Pn.delete(t),Ii(t).forEach(e=>e(!1))},Es=(t,e)=>{!_l(t)&&e.every(n=>n.size===0)&&Oi(t)},xf=(t,e,n,i,r,s,o,a,l,u,c,h,f)=>{const d=new WeakMap;return(p,g,m,w,b)=>{const{activeInputs:C,passiveInputs:T}=s(g),{outputs:v}=s(p),_=a(p),y=S=>{const A=l(g),I=l(p);if(S){const M=vl(T,p,m,w);t(C,p,M,!1),!b&&!h(p)&&n(I,A,m,w),f(g)&&Rn(g)}else{const M=i(C,p,m,w);e(T,w,M,!1),!b&&!h(p)&&r(I,A,m,w);const N=o(g);if(N===0)c(g)&&Es(g,C);else{const V=d.get(g);V!==void 0&&clearTimeout(V),d.set(g,setTimeout(()=>{c(g)&&Es(g,C)},N*1e3))}}};return u(v,[g,m,w],S=>S[0]===g&&S[1]===m&&S[2]===w,!0)?(_.add(y),c(p)?t(C,p,[m,w,y],!0):e(T,w,[p,m,y],!0),!0):!1}},Af=t=>(e,n,[i,r,s],o)=>{const a=e.get(i);a===void 0?e.set(i,new Set([[r,n,s]])):t(a,[r,n,s],l=>l[0]===r&&l[1]===n,o)},If=t=>(e,n)=>{const i=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(i).connect(e.destination);const r=()=>{n.removeEventListener("ended",r),n.disconnect(i),i.disconnect()};n.addEventListener("ended",r)},Of=t=>(e,n)=>{t(e).add(n)},Mf={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},Nf=(t,e,n,i,r,s)=>class extends t{constructor(a,l){const u=r(a),c={...Mf,...l},h=i(u,c),f=s(u)?e():null;super(a,!1,h,f),this._nativeAnalyserNode=h}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){const l=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=l,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){const l=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=l,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}},Ue=(t,e)=>t.context===e,Ef=(t,e,n)=>()=>{const i=new WeakMap,r=async(s,o)=>{let a=e(s);if(!Ue(a,o)){const u={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=t(o,u)}return i.set(o,a),await n(s,o,a),a};return{render(s,o){const a=i.get(o);return a!==void 0?Promise.resolve(a):r(s,o)}}},hr=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},wt=()=>new DOMException("","IndexSizeError"),Hs=t=>{t.getChannelData=(e=>n=>{try{return e.call(t,n)}catch(i){throw i.code===12?wt():i}})(t.getChannelData)},Vf={numberOfChannels:1},Df=(t,e,n,i,r,s,o,a)=>{let l=null;return class yl{constructor(c){if(r===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:h,numberOfChannels:f,sampleRate:d}={...Vf,...c};l===null&&(l=new r(1,1,44100));const p=i!==null&&e(s,s)?new i({length:h,numberOfChannels:f,sampleRate:d}):l.createBuffer(f,h,d);if(p.numberOfChannels===0)throw n();return typeof p.copyFromChannel!="function"?(o(p),Hs(p)):e(hr,()=>hr(p))||a(p),t.add(p),p}static[Symbol.hasInstance](c){return c!==null&&typeof c=="object"&&Object.getPrototypeOf(c)===yl.prototype||t.has(c)}}},Qe=-34028234663852886e22,ze=-Qe,Ot=t=>Pn.has(t),Ff={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},Pf=(t,e,n,i,r,s,o,a)=>class extends t{constructor(u,c){const h=s(u),f={...Ff,...c},d=r(h,f),p=o(h),g=p?e():null;super(u,!1,d,g),this._audioBufferSourceNodeRenderer=g,this._isBufferNullified=!1,this._isBufferSet=f.buffer!==null,this._nativeAudioBufferSourceNode=d,this._onended=null,this._playbackRate=n(this,p,d.playbackRate,ze,Qe)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(u){if(this._nativeAudioBufferSourceNode.buffer=u,u!==null){if(this._isBufferSet)throw i();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(u){this._nativeAudioBufferSourceNode.loop=u}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(u){this._nativeAudioBufferSourceNode.loopEnd=u}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(u){this._nativeAudioBufferSourceNode.loopStart=u}get onended(){return this._onended}set onended(u){const c=typeof u=="function"?a(this,u):null;this._nativeAudioBufferSourceNode.onended=c;const h=this._nativeAudioBufferSourceNode.onended;this._onended=h!==null&&h===c?u:h}get playbackRate(){return this._playbackRate}start(u=0,c=0,h){if(this._nativeAudioBufferSourceNode.start(u,c,h),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=h===void 0?[u,c]:[u,c,h]),this.context.state!=="closed"){Rn(this);const f=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",f),Ot(this)&&Oi(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",f)}}stop(u=0){this._nativeAudioBufferSourceNode.stop(u),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=u)}},Rf=(t,e,n,i,r)=>()=>{const s=new WeakMap;let o=null,a=null;const l=async(u,c)=>{let h=n(u);const f=Ue(h,c);if(!f){const d={buffer:h.buffer,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,loop:h.loop,loopEnd:h.loopEnd,loopStart:h.loopStart,playbackRate:h.playbackRate.value};h=e(c,d),o!==null&&h.start(...o),a!==null&&h.stop(a)}return s.set(c,h),f?await t(c,u.playbackRate,h.playbackRate):await i(c,u.playbackRate,h.playbackRate),await r(u,c,h),h};return{set start(u){o=u},set stop(u){a=u},render(u,c){const h=s.get(c);return h!==void 0?Promise.resolve(h):l(u,c)}}},qf=t=>"playbackRate"in t,Bf=t=>"frequency"in t&&"gain"in t,Lf=t=>"offset"in t,jf=t=>!("frequency"in t)&&"gain"in t,Uf=t=>"detune"in t&&"frequency"in t,Wf=t=>"pan"in t,He=t=>ft(fl,t),Mi=t=>ft(pl,t),Vs=(t,e)=>{const{activeInputs:n}=He(t);n.forEach(r=>r.forEach(([s])=>{e.includes(t)||Vs(s,[...e,t])}));const i=qf(t)?[t.playbackRate]:_l(t)?Array.from(t.parameters.values()):Bf(t)?[t.Q,t.detune,t.frequency,t.gain]:Lf(t)?[t.offset]:jf(t)?[t.gain]:Uf(t)?[t.detune,t.frequency]:Wf(t)?[t.pan]:[];for(const r of i){const s=Mi(r);s!==void 0&&s.activeInputs.forEach(([o])=>Vs(o,e))}Ot(t)&&Oi(t)},bl=t=>{Vs(t.destination,[])},$f=t=>t===void 0||typeof t=="number"||typeof t=="string"&&(t==="balanced"||t==="interactive"||t==="playback"),zf=(t,e,n,i,r,s,o,a,l)=>class extends t{constructor(c={}){if(l===null)throw new Error("Missing the native AudioContext constructor.");let h;try{h=new l(c)}catch(p){throw p.code===12&&p.message==="sampleRate is not in range"?n():p}if(h===null)throw i();if(!$f(c.latencyHint))throw new TypeError(`The provided value '${c.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(c.sampleRate!==void 0&&h.sampleRate!==c.sampleRate)throw n();super(h,2);const{latencyHint:f}=c,{sampleRate:d}=h;if(this._baseLatency=typeof h.baseLatency=="number"?h.baseLatency:f==="balanced"?512/d:f==="interactive"||f===void 0?256/d:f==="playback"?1024/d:Math.max(2,Math.min(128,Math.round(f*d/128)))*128/d,this._nativeAudioContext=h,l.name==="webkitAudioContext"?(this._nativeGainNode=h.createGain(),this._nativeOscillatorNode=h.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(h.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,h.state==="running"){this._state="suspended";const p=()=>{this._state==="suspended"&&(this._state=null),h.removeEventListener("statechange",p)};h.addEventListener("statechange",p)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),bl(this)}))}createMediaElementSource(c){return new r(this,{mediaElement:c})}createMediaStreamDestination(){return new s(this)}createMediaStreamSource(c){return new o(this,{mediaStream:c})}createMediaStreamTrackSource(c){return new a(this,{mediaStreamTrack:c})}resume(){return this._state==="suspended"?new Promise((c,h)=>{const f=()=>{this._nativeAudioContext.removeEventListener("statechange",f),this._nativeAudioContext.state==="running"?c():this.resume().then(c,h)};this._nativeAudioContext.addEventListener("statechange",f)}):this._nativeAudioContext.resume().catch(c=>{throw c===void 0||c.code===15?e():c})}suspend(){return this._nativeAudioContext.suspend().catch(c=>{throw c===void 0?e():c})}},Hf=(t,e,n,i,r,s,o,a)=>class extends t{constructor(u,c){const h=s(u),f=o(h),d=r(h,c,f),p=f?e(a):null;super(u,!1,d,p),this._isNodeOfNativeOfflineAudioContext=f,this._nativeAudioDestinationNode=d}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(u){if(this._isNodeOfNativeOfflineAudioContext)throw i();if(u>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=u}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(u){if(this._isNodeOfNativeOfflineAudioContext)throw i();this._nativeAudioDestinationNode.channelCountMode=u}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},Gf=t=>{const e=new WeakMap,n=async(i,r)=>{const s=r.destination;return e.set(r,s),await t(i,r,s),s};return{render(i,r){const s=e.get(r);return s!==void 0?Promise.resolve(s):n(i,r)}}},Zf=(t,e,n,i,r,s,o,a)=>(l,u)=>{const c=u.listener,h=()=>{const v=new Float32Array(1),_=e(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),y=o(u);let S=!1,A=[0,0,-1,0,1,0],I=[0,0,0];const M=()=>{if(S)return;S=!0;const W=i(u,256,9,0);W.onaudioprocess=({inputBuffer:j})=>{const O=[s(j,v,0),s(j,v,1),s(j,v,2),s(j,v,3),s(j,v,4),s(j,v,5)];O.some((L,x)=>L!==A[x])&&(c.setOrientation(...O),A=O);const P=[s(j,v,6),s(j,v,7),s(j,v,8)];P.some((L,x)=>L!==I[x])&&(c.setPosition(...P),I=P)},_.connect(W)},N=W=>j=>{j!==A[W]&&(A[W]=j,c.setOrientation(...A))},V=W=>j=>{j!==I[W]&&(I[W]=j,c.setPosition(...I))},F=(W,j,O)=>{const P=n(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:j});P.connect(_,0,W),P.start(),Object.defineProperty(P.offset,"defaultValue",{get(){return j}});const L=t({context:l},y,P.offset,ze,Qe);return a(L,"value",x=>()=>x.call(L),x=>E=>{try{x.call(L,E)}catch(q){if(q.code!==9)throw q}M(),y&&O(E)}),L.cancelAndHoldAtTime=(x=>y?()=>{throw r()}:(...E)=>{const q=x.apply(L,E);return M(),q})(L.cancelAndHoldAtTime),L.cancelScheduledValues=(x=>y?()=>{throw r()}:(...E)=>{const q=x.apply(L,E);return M(),q})(L.cancelScheduledValues),L.exponentialRampToValueAtTime=(x=>y?()=>{throw r()}:(...E)=>{const q=x.apply(L,E);return M(),q})(L.exponentialRampToValueAtTime),L.linearRampToValueAtTime=(x=>y?()=>{throw r()}:(...E)=>{const q=x.apply(L,E);return M(),q})(L.linearRampToValueAtTime),L.setTargetAtTime=(x=>y?()=>{throw r()}:(...E)=>{const q=x.apply(L,E);return M(),q})(L.setTargetAtTime),L.setValueAtTime=(x=>y?()=>{throw r()}:(...E)=>{const q=x.apply(L,E);return M(),q})(L.setValueAtTime),L.setValueCurveAtTime=(x=>y?()=>{throw r()}:(...E)=>{const q=x.apply(L,E);return M(),q})(L.setValueCurveAtTime),L};return{forwardX:F(0,0,N(0)),forwardY:F(1,0,N(1)),forwardZ:F(2,-1,N(2)),positionX:F(6,0,V(0)),positionY:F(7,0,V(1)),positionZ:F(8,0,V(2)),upX:F(3,0,N(3)),upY:F(4,1,N(4)),upZ:F(5,0,N(5))}},{forwardX:f,forwardY:d,forwardZ:p,positionX:g,positionY:m,positionZ:w,upX:b,upY:C,upZ:T}=c.forwardX===void 0?h():c;return{get forwardX(){return f},get forwardY(){return d},get forwardZ(){return p},get positionX(){return g},get positionY(){return m},get positionZ(){return w},get upX(){return b},get upY(){return C},get upZ(){return T}}},dr=t=>"context"in t,Ni=t=>dr(t[0]),pn=(t,e,n,i)=>{for(const r of t)if(n(r)){if(i)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},ba=(t,e,[n,i],r)=>{pn(t,[e,n,i],s=>s[0]===e&&s[1]===n,r)},wa=(t,[e,n,i],r)=>{const s=t.get(e);s===void 0?t.set(e,new Set([[n,i]])):pn(s,[n,i],o=>o[0]===n,r)},Wn=t=>"inputs"in t,fr=(t,e,n,i)=>{if(Wn(e)){const r=e.inputs[i];return t.connect(r,n,0),[r,n,0]}return t.connect(e,n,i),[e,n,i]},wl=(t,e,n)=>{for(const i of t)if(i[0]===e&&i[1]===n)return t.delete(i),i;return null},Xf=(t,e,n)=>Ur(t,i=>i[0]===e&&i[1]===n),Sl=(t,e)=>{if(!Ii(t).delete(e))throw new Error("Missing the expected event listener.")},Tl=(t,e,n)=>{const i=ft(t,e),r=Ur(i,s=>s[0]===n);return i.size===0&&t.delete(e),r},pr=(t,e,n,i)=>{Wn(e)?t.disconnect(e.inputs[i],n,0):t.disconnect(e,n,i)},ve=t=>ft($s,t),ui=t=>ft(zs,t),ln=t=>Os.has(t),er=t=>!Pn.has(t),Sa=(t,e)=>new Promise(n=>{if(e!==null)n(!0);else{const i=t.createScriptProcessor(256,1,1),r=t.createGain(),s=t.createBuffer(1,2,44100),o=s.getChannelData(0);o[0]=1,o[1]=1;const a=t.createBufferSource();a.buffer=s,a.loop=!0,a.connect(i).connect(t.destination),a.connect(r),a.disconnect(r),i.onaudioprocess=l=>{const u=l.inputBuffer.getChannelData(0);Array.prototype.some.call(u,c=>c===1)?n(!0):n(!1),a.stop(),i.onaudioprocess=null,a.disconnect(i),i.disconnect(t.destination)},a.start()}}),ys=(t,e)=>{const n=new Map;for(const i of t)for(const r of i){const s=n.get(r);n.set(r,s===void 0?1:s+1)}n.forEach((i,r)=>e(r,i))},mr=t=>"context"in t,Qf=t=>{const e=new Map;t.connect=(n=>(i,r=0,s=0)=>{const o=mr(i)?n(i,r,s):n(i,r),a=e.get(i);return a===void 0?e.set(i,[{input:s,output:r}]):a.every(l=>l.input!==s||l.output!==r)&&a.push({input:s,output:r}),o})(t.connect.bind(t)),t.disconnect=(n=>(i,r,s)=>{if(n.apply(t),i===void 0)e.clear();else if(typeof i=="number")for(const[o,a]of e){const l=a.filter(u=>u.output!==i);l.length===0?e.delete(o):e.set(o,l)}else if(e.has(i))if(r===void 0)e.delete(i);else{const o=e.get(i);if(o!==void 0){const a=o.filter(l=>l.output!==r&&(l.input!==s||s===void 0));a.length===0?e.delete(i):e.set(i,a)}}for(const[o,a]of e)a.forEach(l=>{mr(o)?t.connect(o,l.output,l.input):t.connect(o,l.output)})})(t.disconnect)},Yf=(t,e,n,i)=>{const{activeInputs:r,passiveInputs:s}=Mi(e),{outputs:o}=He(t),a=Ii(t),l=u=>{const c=ve(t),h=ui(e);if(u){const f=Tl(s,t,n);ba(r,t,f,!1),!i&&!ln(t)&&c.connect(h,n)}else{const f=Xf(r,t,n);wa(s,f,!1),!i&&!ln(t)&&c.disconnect(h,n)}};return pn(o,[e,n],u=>u[0]===e&&u[1]===n,!0)?(a.add(l),Ot(t)?ba(r,t,[n,l],!0):wa(s,[t,n,l],!0),!0):!1},Kf=(t,e,n,i)=>{const{activeInputs:r,passiveInputs:s}=He(e),o=wl(r[i],t,n);return o===null?[vl(s,t,n,i)[2],!1]:[o[2],!0]},Jf=(t,e,n)=>{const{activeInputs:i,passiveInputs:r}=Mi(e),s=wl(i,t,n);return s===null?[Tl(r,t,n)[1],!1]:[s[2],!0]},Gs=(t,e,n,i,r)=>{const[s,o]=Kf(t,n,i,r);if(s!==null&&(Sl(t,s),o&&!e&&!ln(t)&&pr(ve(t),ve(n),i,r)),Ot(n)){const{activeInputs:a}=He(n);Es(n,a)}},Zs=(t,e,n,i)=>{const[r,s]=Jf(t,n,i);r!==null&&(Sl(t,r),s&&!e&&!ln(t)&&ve(t).disconnect(ui(n),i))},ep=(t,e)=>{const n=He(t),i=[];for(const r of n.outputs)Ni(r)?Gs(t,e,...r):Zs(t,e,...r),i.push(r[0]);return n.outputs.clear(),i},tp=(t,e,n)=>{const i=He(t),r=[];for(const s of i.outputs)s[1]===n&&(Ni(s)?Gs(t,e,...s):Zs(t,e,...s),r.push(s[0]),i.outputs.delete(s));return r},np=(t,e,n,i,r)=>{const s=He(t);return Array.from(s.outputs).filter(o=>o[0]===n&&(i===void 0||o[1]===i)&&(r===void 0||o[2]===r)).map(o=>(Ni(o)?Gs(t,e,...o):Zs(t,e,...o),s.outputs.delete(o),o[0]))},ip=(t,e,n,i,r,s,o,a,l,u,c,h,f,d,p,g)=>class extends u{constructor(w,b,C,T){super(C),this._context=w,this._nativeAudioNode=C;const v=c(w);h(v)&&n(Sa,()=>Sa(v,g))!==!0&&Qf(C),$s.set(this,C),ml.set(this,new Set),w.state!=="closed"&&b&&Rn(this),t(this,T,C)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(w){this._nativeAudioNode.channelCount=w}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(w){this._nativeAudioNode.channelCountMode=w}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(w){this._nativeAudioNode.channelInterpretation=w}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(w,b=0,C=0){if(b<0||b>=this._nativeAudioNode.numberOfOutputs)throw r();const T=c(this._context),v=p(T);if(f(w)||d(w))throw s();if(dr(w)){const S=ve(w);try{const I=fr(this._nativeAudioNode,S,b,C),M=er(this);(v||M)&&this._nativeAudioNode.disconnect(...I),this.context.state!=="closed"&&!M&&er(w)&&Rn(w)}catch(I){throw I.code===12?s():I}if(e(this,w,b,C,v)){const I=l([this],w);ys(I,i(v))}return w}const _=ui(w);if(_.name==="playbackRate"&&_.maxValue===1024)throw o();try{this._nativeAudioNode.connect(_,b),(v||er(this))&&this._nativeAudioNode.disconnect(_,b)}catch(S){throw S.code===12?s():S}if(Yf(this,w,b,v)){const S=l([this],w);ys(S,i(v))}}disconnect(w,b,C){let T;const v=c(this._context),_=p(v);if(w===void 0)T=ep(this,_);else if(typeof w=="number"){if(w<0||w>=this.numberOfOutputs)throw r();T=tp(this,_,w)}else{if(b!==void 0&&(b<0||b>=this.numberOfOutputs)||dr(w)&&C!==void 0&&(C<0||C>=w.numberOfInputs))throw r();if(T=np(this,_,w,b,C),T.length===0)throw s()}for(const y of T){const S=l([this],y);ys(S,a)}}},rp=(t,e,n,i,r,s,o,a,l,u,c,h,f)=>(d,p,g,m=null,w=null)=>{const b=new pf(g.defaultValue),C=p?i(b):null,T={get defaultValue(){return g.defaultValue},get maxValue(){return m===null?g.maxValue:m},get minValue(){return w===null?g.minValue:w},get value(){return g.value},set value(v){g.value=v,T.setValueAtTime(v,d.context.currentTime)},cancelAndHoldAtTime(v){if(typeof g.cancelAndHoldAtTime=="function")C===null&&b.flush(d.context.currentTime),b.add(r(v)),g.cancelAndHoldAtTime(v);else{const _=Array.from(b).pop();C===null&&b.flush(d.context.currentTime),b.add(r(v));const y=Array.from(b).pop();g.cancelScheduledValues(v),_!==y&&y!==void 0&&(y.type==="exponentialRampToValue"?g.exponentialRampToValueAtTime(y.value,y.endTime):y.type==="linearRampToValue"?g.linearRampToValueAtTime(y.value,y.endTime):y.type==="setValue"?g.setValueAtTime(y.value,y.startTime):y.type==="setValueCurve"&&g.setValueCurveAtTime(y.values,y.startTime,y.duration))}return T},cancelScheduledValues(v){return C===null&&b.flush(d.context.currentTime),b.add(s(v)),g.cancelScheduledValues(v),T},exponentialRampToValueAtTime(v,_){if(v===0)throw new RangeError;if(!Number.isFinite(_)||_<0)throw new RangeError;return C===null&&b.flush(d.context.currentTime),b.add(o(v,_)),g.exponentialRampToValueAtTime(v,_),T},linearRampToValueAtTime(v,_){return C===null&&b.flush(d.context.currentTime),b.add(a(v,_)),g.linearRampToValueAtTime(v,_),T},setTargetAtTime(v,_,y){return C===null&&b.flush(d.context.currentTime),b.add(l(v,_,y)),g.setTargetAtTime(v,_,y),T},setValueAtTime(v,_){return C===null&&b.flush(d.context.currentTime),b.add(u(v,_)),g.setValueAtTime(v,_),T},setValueCurveAtTime(v,_,y){const S=v instanceof Float32Array?v:new Float32Array(v);if(h!==null&&h.name==="webkitAudioContext"){const A=_+y,I=d.context.sampleRate,M=Math.ceil(_*I),N=Math.floor(A*I),V=N-M,F=new Float32Array(V);for(let j=0;j<V;j+=1){const O=(S.length-1)/y*((M+j)/I-_),P=Math.floor(O),L=Math.ceil(O);F[j]=P===L?S[P]:(1-(O-P))*S[P]+(1-(L-O))*S[L]}C===null&&b.flush(d.context.currentTime),b.add(c(F,_,y)),g.setValueCurveAtTime(F,_,y);const W=N/I;W<A&&f(T,F[F.length-1],W),f(T,S[S.length-1],A)}else C===null&&b.flush(d.context.currentTime),b.add(c(S,_,y)),g.setValueCurveAtTime(S,_,y);return T}};return n.set(T,g),e.set(T,d),t(T,C),T},sp=t=>({replay(e){for(const n of t)if(n.type==="exponentialRampToValue"){const{endTime:i,value:r}=n;e.exponentialRampToValueAtTime(r,i)}else if(n.type==="linearRampToValue"){const{endTime:i,value:r}=n;e.linearRampToValueAtTime(r,i)}else if(n.type==="setTarget"){const{startTime:i,target:r,timeConstant:s}=n;e.setTargetAtTime(r,i,s)}else if(n.type==="setValue"){const{startTime:i,value:r}=n;e.setValueAtTime(r,i)}else if(n.type==="setValueCurve"){const{duration:i,startTime:r,values:s}=n;e.setValueCurveAtTime(s,r,i)}else throw new Error("Can't apply an unknown automation.")}});class kl{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,n=null){return this._map.forEach((i,r)=>e.call(n,i,r,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const op={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},ap=(t,e,n,i,r,s,o,a,l,u,c,h,f,d)=>class extends e{constructor(g,m,w){var b;const C=a(g),T=l(C),v=c({...op,...w});f(v);const _=Ms.get(C),y=_==null?void 0:_.get(m),S=T||C.state!=="closed"?C:(b=o(C))!==null&&b!==void 0?b:C,A=r(S,T?null:g.baseLatency,u,m,y,v),I=T?i(m,v,y):null;super(g,!0,A,I);const M=[];A.parameters.forEach((V,F)=>{const W=n(this,T,V);M.push([F,W])}),this._nativeAudioWorkletNode=A,this._onprocessorerror=null,this._parameters=new kl(M),T&&t(C,this);const{activeInputs:N}=s(this);h(A,N)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(g){const m=typeof g=="function"?d(this,g):null;this._nativeAudioWorkletNode.onprocessorerror=m;const w=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=w!==null&&w===m?g:w}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function gr(t,e,n,i,r){if(typeof t.copyFromChannel=="function")e[n].byteLength===0&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],i,r);else{const s=t.getChannelData(i);if(e[n].byteLength===0)e[n]=s.slice(r,r+128);else{const o=new Float32Array(s.buffer,r*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(o)}}}const Cl=(t,e,n,i,r)=>{typeof t.copyToChannel=="function"?e[n].byteLength!==0&&t.copyToChannel(e[n],i,r):e[n].byteLength!==0&&t.getChannelData(i).set(e[n],r)},vr=(t,e)=>{const n=[];for(let i=0;i<t;i+=1){const r=[],s=typeof e=="number"?e:e[i];for(let o=0;o<s;o+=1)r.push(new Float32Array(128));n.push(r)}return n},lp=(t,e)=>{const n=ft(Ns,t),i=ve(e);return ft(n,i)},up=async(t,e,n,i,r,s,o)=>{const a=e===null?Math.ceil(t.context.length/128)*128:e.length,l=i.channelCount*i.numberOfInputs,u=r.reduce((m,w)=>m+w,0),c=u===0?null:n.createBuffer(u,a,n.sampleRate);if(s===void 0)throw new Error("Missing the processor constructor.");const h=He(t),f=await lp(n,t),d=vr(i.numberOfInputs,i.channelCount),p=vr(i.numberOfOutputs,r),g=Array.from(t.parameters.keys()).reduce((m,w)=>({...m,[w]:new Float32Array(128)}),{});for(let m=0;m<a;m+=128){if(i.numberOfInputs>0&&e!==null)for(let w=0;w<i.numberOfInputs;w+=1)for(let b=0;b<i.channelCount;b+=1)gr(e,d[w],b,b,m);s.parameterDescriptors!==void 0&&e!==null&&s.parameterDescriptors.forEach(({name:w},b)=>{gr(e,g,w,l+b,m)});for(let w=0;w<i.numberOfInputs;w+=1)for(let b=0;b<r[w];b+=1)p[w][b].byteLength===0&&(p[w][b]=new Float32Array(128));try{const w=d.map((C,T)=>h.activeInputs[T].size===0?[]:C),b=o(m/n.sampleRate,n.sampleRate,()=>f.process(w,p,g));if(c!==null)for(let C=0,T=0;C<i.numberOfOutputs;C+=1){for(let v=0;v<r[C];v+=1)Cl(c,p[C],v,T+v,m);T+=r[C]}if(!b)break}catch(w){t.dispatchEvent(new ErrorEvent("processorerror",{colno:w.colno,filename:w.filename,lineno:w.lineno,message:w.message}));break}}return c},cp=(t,e,n,i,r,s,o,a,l,u,c,h,f,d,p,g)=>(m,w,b)=>{const C=new WeakMap;let T=null;const v=async(_,y)=>{let S=c(_),A=null;const I=Ue(S,y),M=Array.isArray(w.outputChannelCount)?w.outputChannelCount:Array.from(w.outputChannelCount);if(h===null){const N=M.reduce((j,O)=>j+O,0),V=r(y,{channelCount:Math.max(1,N),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,N)}),F=[];for(let j=0;j<_.numberOfOutputs;j+=1)F.push(i(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:M[j]}));const W=o(y,{channelCount:w.channelCount,channelCountMode:w.channelCountMode,channelInterpretation:w.channelInterpretation,gain:1});W.connect=e.bind(null,F),W.disconnect=l.bind(null,F),A=[V,F,W]}else I||(S=new h(y,m));if(C.set(y,A===null?S:A[2]),A!==null){if(T===null){if(b===void 0)throw new Error("Missing the processor constructor.");if(f===null)throw new Error("Missing the native OfflineAudioContext constructor.");const O=_.channelCount*_.numberOfInputs,P=b.parameterDescriptors===void 0?0:b.parameterDescriptors.length,L=O+P;T=up(_,L===0?null:await(async()=>{const E=new f(L,Math.ceil(_.context.length/128)*128,y.sampleRate),q=[],$=[];for(let X=0;X<w.numberOfInputs;X+=1)q.push(o(E,{channelCount:w.channelCount,channelCountMode:w.channelCountMode,channelInterpretation:w.channelInterpretation,gain:1})),$.push(r(E,{channelCount:w.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:w.channelCount}));const ee=await Promise.all(Array.from(_.parameters.values()).map(async X=>{const Y=s(E,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:X.value});return await d(E,X,Y.offset),Y})),K=i(E,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,O+P)});for(let X=0;X<w.numberOfInputs;X+=1){q[X].connect($[X]);for(let Y=0;Y<w.channelCount;Y+=1)$[X].connect(K,Y,X*w.channelCount+Y)}for(const[X,Y]of ee.entries())Y.connect(K,0,O+X),Y.start(0);return K.connect(E.destination),await Promise.all(q.map(X=>p(_,E,X))),g(E)})(),y,w,M,b,u)}const N=await T,V=n(y,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[F,W,j]=A;N!==null&&(V.buffer=N,V.start(0)),V.connect(F);for(let O=0,P=0;O<_.numberOfOutputs;O+=1){const L=W[O];for(let x=0;x<M[O];x+=1)F.connect(L,P+x,x);P+=M[O]}return j}if(I)for(const[N,V]of _.parameters.entries())await t(y,V,S.parameters.get(N));else for(const[N,V]of _.parameters.entries())await d(y,V,S.parameters.get(N));return await p(_,y,S),S};return{render(_,y){a(y,_);const S=C.get(y);return S!==void 0?Promise.resolve(S):v(_,y)}}},hp=(t,e,n,i,r,s,o,a,l,u,c,h,f,d,p,g,m,w,b,C)=>class extends p{constructor(v,_){super(v,_),this._nativeContext=v,this._audioWorklet=t===void 0?void 0:{addModule:(y,S)=>t(this,y,S)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new r(this)}createBuffer(v,_,y){return new n({length:_,numberOfChannels:v,sampleRate:y})}createBufferSource(){return new i(this)}createChannelMerger(v=6){return new s(this,{numberOfInputs:v})}createChannelSplitter(v=6){return new o(this,{numberOfOutputs:v})}createConstantSource(){return new a(this)}createConvolver(){return new l(this)}createDelay(v=1){return new c(this,{maxDelayTime:v})}createDynamicsCompressor(){return new h(this)}createGain(){return new f(this)}createIIRFilter(v,_){return new d(this,{feedback:_,feedforward:v})}createOscillator(){return new g(this)}createPanner(){return new m(this)}createPeriodicWave(v,_,y={disableNormalization:!1}){return new w(this,{...y,imag:_,real:v})}createStereoPanner(){return new b(this)}createWaveShaper(){return new C(this)}decodeAudioData(v,_,y){return u(this._nativeContext,v).then(S=>(typeof _=="function"&&_(S),S),S=>{throw typeof y=="function"&&y(S),S})}},dp={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},fp=(t,e,n,i,r,s,o,a)=>class extends t{constructor(u,c){const h=s(u),f={...dp,...c},d=r(h,f),p=o(h),g=p?n():null;super(u,!1,d,g),this._Q=e(this,p,d.Q,ze,Qe),this._detune=e(this,p,d.detune,1200*Math.log2(ze),-1200*Math.log2(ze)),this._frequency=e(this,p,d.frequency,u.sampleRate/2,0),this._gain=e(this,p,d.gain,40*Math.log10(ze),Qe),this._nativeBiquadFilterNode=d,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(u){this._nativeBiquadFilterNode.type=u}getFrequencyResponse(u,c,h){try{this._nativeBiquadFilterNode.getFrequencyResponse(u,c,h)}catch(f){throw f.code===11?i():f}if(u.length!==c.length||c.length!==h.length)throw i()}},pp=(t,e,n,i,r)=>()=>{const s=new WeakMap,o=async(a,l)=>{let u=n(a);const c=Ue(u,l);if(!c){const h={Q:u.Q.value,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,detune:u.detune.value,frequency:u.frequency.value,gain:u.gain.value,type:u.type};u=e(l,h)}return s.set(l,u),c?(await t(l,a.Q,u.Q),await t(l,a.detune,u.detune),await t(l,a.frequency,u.frequency),await t(l,a.gain,u.gain)):(await i(l,a.Q,u.Q),await i(l,a.detune,u.detune),await i(l,a.frequency,u.frequency),await i(l,a.gain,u.gain)),await r(a,l,u),u};return{render(a,l){const u=s.get(l);return u!==void 0?Promise.resolve(u):o(a,l)}}},mp=(t,e)=>(n,i)=>{const r=e.get(n);if(r!==void 0)return r;const s=t.get(n);if(s!==void 0)return s;try{const o=i();return o instanceof Promise?(t.set(n,o),o.catch(()=>!1).then(a=>(t.delete(n),e.set(n,a),a))):(e.set(n,o),o)}catch{return e.set(n,!1),!1}},gp={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},vp=(t,e,n,i,r)=>class extends t{constructor(o,a){const l=i(o),u={...gp,...a},c=n(l,u),h=r(l)?e():null;super(o,!1,c,h)}},_p=(t,e,n)=>()=>{const i=new WeakMap,r=async(s,o)=>{let a=e(s);if(!Ue(a,o)){const u={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=t(o,u)}return i.set(o,a),await n(s,o,a),a};return{render(s,o){const a=i.get(o);return a!==void 0?Promise.resolve(a):r(s,o)}}},yp={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},bp=(t,e,n,i,r,s)=>class extends t{constructor(a,l){const u=i(a),c=s({...yp,...l}),h=n(u,c),f=r(u)?e():null;super(a,!1,h,f)}},wp=(t,e,n)=>()=>{const i=new WeakMap,r=async(s,o)=>{let a=e(s);if(!Ue(a,o)){const u={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=t(o,u)}return i.set(o,a),await n(s,o,a),a};return{render(s,o){const a=i.get(o);return a!==void 0?Promise.resolve(a):r(s,o)}}},Sp=t=>(e,n,i)=>t(n,e,i),Tp=t=>(e,n,i=0,r=0)=>{const s=e[i];if(s===void 0)throw t();return mr(n)?s.connect(n,0,r):s.connect(n,0)},kp=t=>(e,n)=>{const i=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),r=e.createBuffer(1,2,44100);return i.buffer=r,i.loop=!0,i.connect(n),i.start(),()=>{i.stop(),i.disconnect(n)}},Cp={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},xp=(t,e,n,i,r,s,o)=>class extends t{constructor(l,u){const c=r(l),h={...Cp,...u},f=i(c,h),d=s(c),p=d?n():null;super(l,!1,f,p),this._constantSourceNodeRenderer=p,this._nativeConstantSourceNode=f,this._offset=e(this,d,f.offset,ze,Qe),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(l){const u=typeof l=="function"?o(this,l):null;this._nativeConstantSourceNode.onended=u;const c=this._nativeConstantSourceNode.onended;this._onended=c!==null&&c===u?l:c}start(l=0){if(this._nativeConstantSourceNode.start(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=l),this.context.state!=="closed"){Rn(this);const u=()=>{this._nativeConstantSourceNode.removeEventListener("ended",u),Ot(this)&&Oi(this)};this._nativeConstantSourceNode.addEventListener("ended",u)}}stop(l=0){this._nativeConstantSourceNode.stop(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=l)}},Ap=(t,e,n,i,r)=>()=>{const s=new WeakMap;let o=null,a=null;const l=async(u,c)=>{let h=n(u);const f=Ue(h,c);if(!f){const d={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,offset:h.offset.value};h=e(c,d),o!==null&&h.start(o),a!==null&&h.stop(a)}return s.set(c,h),f?await t(c,u.offset,h.offset):await i(c,u.offset,h.offset),await r(u,c,h),h};return{set start(u){o=u},set stop(u){a=u},render(u,c){const h=s.get(c);return h!==void 0?Promise.resolve(h):l(u,c)}}},Ip=t=>e=>(t[0]=e,t[0]),Op={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Mp=(t,e,n,i,r,s)=>class extends t{constructor(a,l){const u=i(a),c={...Op,...l},h=n(u,c),d=r(u)?e():null;super(a,!1,h,d),this._isBufferNullified=!1,this._nativeConvolverNode=h,c.buffer!==null&&s(this,c.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){const l=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=l.createBuffer(1,1,l.sampleRate),this._isBufferNullified=!0,s(this,0)}else this._isBufferNullified=!1,s(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}},Np=(t,e,n)=>()=>{const i=new WeakMap,r=async(s,o)=>{let a=e(s);if(!Ue(a,o)){const u={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=t(o,u)}return i.set(o,a),Wn(a)?await n(s,o,a.inputs[0]):await n(s,o,a),a};return{render(s,o){const a=i.get(o);return a!==void 0?Promise.resolve(a):r(s,o)}}},Ep=(t,e)=>(n,i,r)=>{if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(n,i,r)}catch(s){throw s.name==="SyntaxError"?t():s}},Vp=()=>new DOMException("","DataCloneError"),Ta=t=>{const{port1:e,port2:n}=new MessageChannel;return new Promise(i=>{const r=()=>{n.onmessage=null,e.close(),n.close(),i()};n.onmessage=()=>r();try{e.postMessage(t,[t])}finally{r()}})},Dp=(t,e,n,i,r,s,o,a,l,u,c)=>(h,f)=>{const d=o(h)?h:s(h);if(r.has(f)){const p=n();return Promise.reject(p)}try{r.add(f)}catch{}return e(l,()=>l(d))?d.decodeAudioData(f).then(p=>(Ta(f).catch(()=>{}),e(a,()=>a(p))||c(p),t.add(p),p)):new Promise((p,g)=>{const m=async()=>{try{await Ta(f)}catch{}},w=b=>{g(b),m()};try{d.decodeAudioData(f,b=>{typeof b.copyFromChannel!="function"&&(u(b),Hs(b)),t.add(b),m().then(()=>p(b))},b=>{w(b===null?i():b)})}catch(b){w(b)}})},Fp=(t,e,n,i,r,s,o,a)=>(l,u)=>{const c=e.get(l);if(c===void 0)throw new Error("Missing the expected cycle count.");const h=s(l.context),f=a(h);if(c===u){if(e.delete(l),!f&&o(l)){const d=i(l),{outputs:p}=n(l);for(const g of p)if(Ni(g)){const m=i(g[0]);t(d,m,g[1],g[2])}else{const m=r(g[0]);d.connect(m,g[1])}}}else e.set(l,c-u)},Pp={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},Rp=(t,e,n,i,r,s,o)=>class extends t{constructor(l,u){const c=r(l),h={...Pp,...u},f=i(c,h),d=s(c),p=d?n(h.maxDelayTime):null;super(l,!1,f,p),this._delayTime=e(this,d,f.delayTime),o(this,h.maxDelayTime)}get delayTime(){return this._delayTime}},qp=(t,e,n,i,r)=>s=>{const o=new WeakMap,a=async(l,u)=>{let c=n(l);const h=Ue(c,u);if(!h){const f={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,delayTime:c.delayTime.value,maxDelayTime:s};c=e(u,f)}return o.set(u,c),h?await t(u,l.delayTime,c.delayTime):await i(u,l.delayTime,c.delayTime),await r(l,u,c),c};return{render(l,u){const c=o.get(u);return c!==void 0?Promise.resolve(c):a(l,u)}}},Bp=t=>(e,n,i,r)=>t(e[r],s=>s[0]===n&&s[1]===i),Lp=t=>(e,n)=>{t(e).delete(n)},jp=t=>"delayTime"in t,Up=(t,e,n)=>function i(r,s){const o=dr(s)?s:n(t,s);if(jp(o))return[];if(r[0]===o)return[r];if(r.includes(o))return[];const{outputs:a}=e(o);return Array.from(a).map(l=>i([...r,o],l[0])).reduce((l,u)=>l.concat(u),[])},Yi=(t,e,n)=>{const i=e[n];if(i===void 0)throw t();return i},Wp=t=>(e,n=void 0,i=void 0,r=0)=>n===void 0?e.forEach(s=>s.disconnect()):typeof n=="number"?Yi(t,e,n).disconnect():mr(n)?i===void 0?e.forEach(s=>s.disconnect(n)):r===void 0?Yi(t,e,i).disconnect(n,0):Yi(t,e,i).disconnect(n,0,r):i===void 0?e.forEach(s=>s.disconnect(n)):Yi(t,e,i).disconnect(n,0),$p={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},zp=(t,e,n,i,r,s,o,a)=>class extends t{constructor(u,c){const h=s(u),f={...$p,...c},d=i(h,f),p=o(h),g=p?n():null;super(u,!1,d,g),this._attack=e(this,p,d.attack),this._knee=e(this,p,d.knee),this._nativeDynamicsCompressorNode=d,this._ratio=e(this,p,d.ratio),this._release=e(this,p,d.release),this._threshold=e(this,p,d.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(u){const c=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=u,u>2)throw this._nativeDynamicsCompressorNode.channelCount=c,r()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(u){const c=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=u,u==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=c,r()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},Hp=(t,e,n,i,r)=>()=>{const s=new WeakMap,o=async(a,l)=>{let u=n(a);const c=Ue(u,l);if(!c){const h={attack:u.attack.value,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,knee:u.knee.value,ratio:u.ratio.value,release:u.release.value,threshold:u.threshold.value};u=e(l,h)}return s.set(l,u),c?(await t(l,a.attack,u.attack),await t(l,a.knee,u.knee),await t(l,a.ratio,u.ratio),await t(l,a.release,u.release),await t(l,a.threshold,u.threshold)):(await i(l,a.attack,u.attack),await i(l,a.knee,u.knee),await i(l,a.ratio,u.ratio),await i(l,a.release,u.release),await i(l,a.threshold,u.threshold)),await r(a,l,u),u};return{render(a,l){const u=s.get(l);return u!==void 0?Promise.resolve(u):o(a,l)}}},Gp=()=>new DOMException("","EncodingError"),Zp=t=>e=>new Promise((n,i)=>{if(t===null){i(new SyntaxError);return}const r=t.document.head;if(r===null)i(new SyntaxError);else{const s=t.document.createElement("script"),o=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(o),l=t.onerror,u=()=>{t.onerror=l,URL.revokeObjectURL(a)};t.onerror=(c,h,f,d,p)=>{if(h===a||h===t.location.href&&f===1&&d===1)return u(),i(p),!1;if(l!==null)return l(c,h,f,d,p)},s.onerror=()=>{u(),i(new SyntaxError)},s.onload=()=>{u(),n()},s.src=a,s.type="module",r.appendChild(s)}}),Xp=t=>class{constructor(n){this._nativeEventTarget=n,this._listeners=new WeakMap}addEventListener(n,i,r){if(i!==null){let s=this._listeners.get(i);s===void 0&&(s=t(this,i),typeof i=="function"&&this._listeners.set(i,s)),this._nativeEventTarget.addEventListener(n,s,r)}}dispatchEvent(n){return this._nativeEventTarget.dispatchEvent(n)}removeEventListener(n,i,r){const s=i===null?void 0:this._listeners.get(i);this._nativeEventTarget.removeEventListener(n,s===void 0?null:s,r)}},Qp=t=>(e,n,i)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get(){return Math.round(e*n)}},currentTime:{configurable:!0,get(){return e}}});try{return i()}finally{t!==null&&(delete t.currentFrame,delete t.currentTime)}},Yp=t=>async e=>{try{const n=await fetch(e);if(n.ok)return[await n.text(),n.url]}catch{}throw t()},Kp={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},Jp=(t,e,n,i,r,s)=>class extends t{constructor(a,l){const u=r(a),c={...Kp,...l},h=i(u,c),f=s(u),d=f?n():null;super(a,!1,h,d),this._gain=e(this,f,h.gain,ze,Qe)}get gain(){return this._gain}},em=(t,e,n,i,r)=>()=>{const s=new WeakMap,o=async(a,l)=>{let u=n(a);const c=Ue(u,l);if(!c){const h={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,gain:u.gain.value};u=e(l,h)}return s.set(l,u),c?await t(l,a.gain,u.gain):await i(l,a.gain,u.gain),await r(a,l,u),u};return{render(a,l){const u=s.get(l);return u!==void 0?Promise.resolve(u):o(a,l)}}},tm=(t,e)=>n=>e(t,n),nm=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer},im=t=>e=>{var n;return(n=t.get(e))!==null&&n!==void 0?n:0},rm=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer},sm=t=>e=>t.get(e),qe=()=>new DOMException("","InvalidStateError"),om=t=>e=>{const n=t.get(e);if(n===void 0)throw qe();return n},am=(t,e)=>n=>{let i=t.get(n);if(i!==void 0)return i;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return i=new e(1,1,44100),t.set(n,i),i},lm=t=>e=>{const n=t.get(e);if(n===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return n},Wr=()=>new DOMException("","InvalidAccessError"),um=t=>{t.getFrequencyResponse=(e=>(n,i,r)=>{if(n.length!==i.length||i.length!==r.length)throw Wr();return e.call(t,n,i,r)})(t.getFrequencyResponse)},cm={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},hm=(t,e,n,i,r,s)=>class extends t{constructor(a,l){const u=i(a),c=r(u),h={...cm,...l},f=e(u,c?null:a.baseLatency,h),d=c?n(h.feedback,h.feedforward):null;super(a,!1,f,d),um(f),this._nativeIIRFilterNode=f,s(this,1)}getFrequencyResponse(a,l,u){return this._nativeIIRFilterNode.getFrequencyResponse(a,l,u)}},xl=(t,e,n,i,r,s,o,a,l,u,c)=>{const h=u.length;let f=a;for(let d=0;d<h;d+=1){let p=n[0]*u[d];for(let g=1;g<r;g+=1){const m=f-g&l-1;p+=n[g]*s[m],p-=t[g]*o[m]}for(let g=r;g<i;g+=1)p+=n[g]*s[f-g&l-1];for(let g=r;g<e;g+=1)p-=t[g]*o[f-g&l-1];s[f]=u[d],o[f]=p,f=f+1&l-1,c[d]=p}return f},dm=(t,e,n,i)=>{const r=n instanceof Float64Array?n:new Float64Array(n),s=i instanceof Float64Array?i:new Float64Array(i),o=r.length,a=s.length,l=Math.min(o,a);if(r[0]!==1){for(let p=0;p<o;p+=1)s[p]/=r[0];for(let p=1;p<a;p+=1)r[p]/=r[0]}const u=32,c=new Float32Array(u),h=new Float32Array(u),f=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),d=t.numberOfChannels;for(let p=0;p<d;p+=1){const g=t.getChannelData(p),m=f.getChannelData(p);c.fill(0),h.fill(0),xl(r,o,s,a,l,c,h,0,u,g,m)}return f},fm=(t,e,n,i,r)=>(s,o)=>{const a=new WeakMap;let l=null;const u=async(c,h)=>{let f=null,d=e(c);const p=Ue(d,h);if(h.createIIRFilter===void 0?f=t(h,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):p||(d=h.createIIRFilter(o,s)),a.set(h,f===null?d:f),f!==null){if(l===null){if(n===null)throw new Error("Missing the native OfflineAudioContext constructor.");const m=new n(c.context.destination.channelCount,c.context.length,h.sampleRate);l=(async()=>{await i(c,m,m.destination);const w=await r(m);return dm(w,h,s,o)})()}const g=await l;return f.buffer=g,f.start(0),f}return await i(c,h,d),d};return{render(c,h){const f=a.get(h);return f!==void 0?Promise.resolve(f):u(c,h)}}},pm=(t,e,n,i,r,s)=>o=>(a,l)=>{const u=t.get(a);if(u===void 0){if(!o&&s(a)){const c=i(a),{outputs:h}=n(a);for(const f of h)if(Ni(f)){const d=i(f[0]);e(c,d,f[1],f[2])}else{const d=r(f[0]);c.disconnect(d,f[1])}}t.set(a,l)}else t.set(a,u+l)},mm=(t,e)=>n=>{const i=t.get(n);return e(i)||e(n)},gm=(t,e)=>n=>t.has(n)||e(n),vm=(t,e)=>n=>t.has(n)||e(n),_m=(t,e)=>n=>{const i=t.get(n);return e(i)||e(n)},ym=t=>e=>t!==null&&e instanceof t,bm=t=>e=>t!==null&&typeof t.AudioNode=="function"&&e instanceof t.AudioNode,wm=t=>e=>t!==null&&typeof t.AudioParam=="function"&&e instanceof t.AudioParam,Sm=(t,e)=>n=>t(n)||e(n),Tm=t=>e=>t!==null&&e instanceof t,km=t=>t!==null&&t.isSecureContext,Cm=(t,e,n,i)=>class extends t{constructor(s,o){const a=n(s),l=e(a,o);if(i(a))throw TypeError();super(s,!0,l,null),this._nativeMediaElementAudioSourceNode=l}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},xm={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Am=(t,e,n,i)=>class extends t{constructor(s,o){const a=n(s);if(i(a))throw new TypeError;const l={...xm,...o},u=e(a,l);super(s,!1,u,null),this._nativeMediaStreamAudioDestinationNode=u}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},Im=(t,e,n,i)=>class extends t{constructor(s,o){const a=n(s),l=e(a,o);if(i(a))throw new TypeError;super(s,!0,l,null),this._nativeMediaStreamAudioSourceNode=l}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},Om=(t,e,n)=>class extends t{constructor(r,s){const o=n(r),a=e(o,s);super(r,!0,a,null)}},Mm=(t,e,n,i,r,s)=>class extends n{constructor(a,l){super(a),this._nativeContext=a,jr.set(this,a),i(a)&&r.set(a,new Set),this._destination=new t(this,l),this._listener=e(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){const l=typeof a=="function"?s(this,a):null;this._nativeContext.onstatechange=l;const u=this._nativeContext.onstatechange;this._onstatechange=u!==null&&u===l?a:u}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},ci=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,()=>{});return n===void 0?!1:(n.catch(()=>{}),!0)}catch{}return!1},Nm=(t,e)=>(n,i,r)=>{const s=new Set;return n.connect=(o=>(a,l=0,u=0)=>{const c=s.size===0;if(e(a))return o.call(n,a,l,u),t(s,[a,l,u],h=>h[0]===a&&h[1]===l&&h[2]===u,!0),c&&i(),a;o.call(n,a,l),t(s,[a,l],h=>h[0]===a&&h[1]===l,!0),c&&i()})(n.connect),n.disconnect=(o=>(a,l,u)=>{const c=s.size>0;if(a===void 0)o.apply(n),s.clear();else if(typeof a=="number"){o.call(n,a);for(const f of s)f[1]===a&&s.delete(f)}else{e(a)?o.call(n,a,l,u):o.call(n,a,l);for(const f of s)f[0]===a&&(l===void 0||f[1]===l)&&(u===void 0||f[2]===u)&&s.delete(f)}const h=s.size===0;c&&h&&r()})(n.disconnect),n},be=(t,e,n)=>{const i=e[n];i!==void 0&&i!==t[n]&&(t[n]=i)},Fe=(t,e)=>{be(t,e,"channelCount"),be(t,e,"channelCountMode"),be(t,e,"channelInterpretation")},ka=t=>typeof t.getFloatTimeDomainData=="function",Em=t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const i=Math.max(n.length,t.fftSize);for(let r=0;r<i;r+=1)e[r]=(n[r]-128)*.0078125;return e}},Vm=(t,e)=>(n,i)=>{const r=n.createAnalyser();if(Fe(r,i),!(i.maxDecibels>i.minDecibels))throw e();return be(r,i,"fftSize"),be(r,i,"maxDecibels"),be(r,i,"minDecibels"),be(r,i,"smoothingTimeConstant"),t(ka,()=>ka(r))||Em(r),r},Dm=t=>t===null?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null,Se=(t,e,n)=>{const i=e[n];i!==void 0&&i!==t[n].value&&(t[n].value=i)},Fm=t=>{t.start=(e=>{let n=!1;return(i=0,r=0,s)=>{if(n)throw qe();e.call(t,i,r,s),n=!0}})(t.start)},Xs=t=>{t.start=(e=>(n=0,i=0,r)=>{if(typeof r=="number"&&r<0||i<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,i,r)})(t.start)},Qs=t=>{t.stop=(e=>(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})(t.stop)},Pm=(t,e,n,i,r,s,o,a,l,u,c)=>(h,f)=>{const d=h.createBufferSource();return Fe(d,f),Se(d,f,"playbackRate"),be(d,f,"buffer"),be(d,f,"loop"),be(d,f,"loopEnd"),be(d,f,"loopStart"),e(n,()=>n(h))||Fm(d),e(i,()=>i(h))||l(d),e(r,()=>r(h))||u(d,h),e(s,()=>s(h))||Xs(d),e(o,()=>o(h))||c(d,h),e(a,()=>a(h))||Qs(d),t(h,d),d},Rm=t=>t===null?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null,qm=(t,e)=>(n,i,r)=>{const s=n.destination;if(s.channelCount!==i)try{s.channelCount=i}catch{}r&&s.channelCountMode!=="explicit"&&(s.channelCountMode="explicit"),s.maxChannelCount===0&&Object.defineProperty(s,"maxChannelCount",{value:i});const o=t(n,{channelCount:i,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return e(o,"channelCount",a=>()=>a.call(o),a=>l=>{a.call(o,l);try{s.channelCount=l}catch(u){if(l>s.maxChannelCount)throw u}}),e(o,"channelCountMode",a=>()=>a.call(o),a=>l=>{a.call(o,l),s.channelCountMode=l}),e(o,"channelInterpretation",a=>()=>a.call(o),a=>l=>{a.call(o,l),s.channelInterpretation=l}),Object.defineProperty(o,"maxChannelCount",{get:()=>s.maxChannelCount}),o.connect(s),o},Bm=t=>t===null?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null,Lm=t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}},jm=(t,e,n,i,r)=>(s,o,a,l,u,c)=>{if(a!==null)try{const h=new a(s,l,c),f=new Map;let d=null;if(Object.defineProperties(h,{channelCount:{get:()=>c.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>d,set:p=>{typeof d=="function"&&h.removeEventListener("processorerror",d),d=typeof p=="function"?p:null,typeof d=="function"&&h.addEventListener("processorerror",d)}}}),h.addEventListener=(p=>(...g)=>{if(g[0]==="processorerror"){const m=typeof g[1]=="function"?g[1]:typeof g[1]=="object"&&g[1]!==null&&typeof g[1].handleEvent=="function"?g[1].handleEvent:null;if(m!==null){const w=f.get(g[1]);w!==void 0?g[1]=w:(g[1]=b=>{b.type==="error"?(Object.defineProperties(b,{type:{value:"processorerror"}}),m(b)):m(new ErrorEvent(g[0],{...b}))},f.set(m,g[1]))}}return p.call(h,"error",g[1],g[2]),p.call(h,...g)})(h.addEventListener),h.removeEventListener=(p=>(...g)=>{if(g[0]==="processorerror"){const m=f.get(g[1]);m!==void 0&&(f.delete(g[1]),g[1]=m)}return p.call(h,"error",g[1],g[2]),p.call(h,g[0],g[1],g[2])})(h.removeEventListener),c.numberOfOutputs!==0){const p=n(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return h.connect(p).connect(s.destination),r(h,()=>p.disconnect(),()=>p.connect(s.destination))}return h}catch(h){throw h.code===11?i():h}if(u===void 0)throw i();return Lm(c),e(s,o,u,c)},Al=(t,e)=>t===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),Um=t=>new Promise((e,n)=>{const{port1:i,port2:r}=new MessageChannel;i.onmessage=({data:s})=>{i.close(),r.close(),e(s)},i.onmessageerror=({data:s})=>{i.close(),r.close(),n(s)},r.postMessage(t)}),Wm=async(t,e)=>{const n=await Um(e);return new t(n)},$m=(t,e,n,i)=>{let r=Ns.get(t);r===void 0&&(r=new WeakMap,Ns.set(t,r));const s=Wm(n,i);return r.set(e,s),s},zm=(t,e,n,i,r,s,o,a,l,u,c,h,f)=>(d,p,g,m)=>{if(m.numberOfInputs===0&&m.numberOfOutputs===0)throw l();const w=Array.isArray(m.outputChannelCount)?m.outputChannelCount:Array.from(m.outputChannelCount);if(w.some(z=>z<1))throw l();if(w.length!==m.numberOfOutputs)throw e();if(m.channelCountMode!=="explicit")throw l();const b=m.channelCount*m.numberOfInputs,C=w.reduce((z,J)=>z+J,0),T=g.parameterDescriptors===void 0?0:g.parameterDescriptors.length;if(b+T>6||C>6)throw l();const v=new MessageChannel,_=[],y=[];for(let z=0;z<m.numberOfInputs;z+=1)_.push(o(d,{channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation,gain:1})),y.push(r(d,{channelCount:m.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:m.channelCount}));const S=[];if(g.parameterDescriptors!==void 0)for(const{defaultValue:z,maxValue:J,minValue:_e,name:le}of g.parameterDescriptors){const ne=s(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:m.parameterData[le]!==void 0?m.parameterData[le]:z===void 0?0:z});Object.defineProperties(ne.offset,{defaultValue:{get:()=>z===void 0?0:z},maxValue:{get:()=>J===void 0?ze:J},minValue:{get:()=>_e===void 0?Qe:_e}}),S.push(ne)}const A=i(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,b+T)}),I=Al(p,d.sampleRate),M=a(d,I,b+T,Math.max(1,C)),N=r(d,{channelCount:Math.max(1,C),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,C)}),V=[];for(let z=0;z<m.numberOfOutputs;z+=1)V.push(i(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:w[z]}));for(let z=0;z<m.numberOfInputs;z+=1){_[z].connect(y[z]);for(let J=0;J<m.channelCount;J+=1)y[z].connect(A,J,z*m.channelCount+J)}const F=new kl(g.parameterDescriptors===void 0?[]:g.parameterDescriptors.map(({name:z},J)=>{const _e=S[J];return _e.connect(A,0,b+J),_e.start(0),[z,_e.offset]}));A.connect(M);let W=m.channelInterpretation,j=null;const O=m.numberOfOutputs===0?[M]:V,P={get bufferSize(){return I},get channelCount(){return m.channelCount},set channelCount(z){throw n()},get channelCountMode(){return m.channelCountMode},set channelCountMode(z){throw n()},get channelInterpretation(){return W},set channelInterpretation(z){for(const J of _)J.channelInterpretation=z;W=z},get context(){return M.context},get inputs(){return _},get numberOfInputs(){return m.numberOfInputs},get numberOfOutputs(){return m.numberOfOutputs},get onprocessorerror(){return j},set onprocessorerror(z){typeof j=="function"&&P.removeEventListener("processorerror",j),j=typeof z=="function"?z:null,typeof j=="function"&&P.addEventListener("processorerror",j)},get parameters(){return F},get port(){return v.port2},addEventListener(...z){return M.addEventListener(z[0],z[1],z[2])},connect:t.bind(null,O),disconnect:u.bind(null,O),dispatchEvent(...z){return M.dispatchEvent(z[0])},removeEventListener(...z){return M.removeEventListener(z[0],z[1],z[2])}},L=new Map;v.port1.addEventListener=(z=>(...J)=>{if(J[0]==="message"){const _e=typeof J[1]=="function"?J[1]:typeof J[1]=="object"&&J[1]!==null&&typeof J[1].handleEvent=="function"?J[1].handleEvent:null;if(_e!==null){const le=L.get(J[1]);le!==void 0?J[1]=le:(J[1]=ne=>{c(d.currentTime,d.sampleRate,()=>_e(ne))},L.set(_e,J[1]))}}return z.call(v.port1,J[0],J[1],J[2])})(v.port1.addEventListener),v.port1.removeEventListener=(z=>(...J)=>{if(J[0]==="message"){const _e=L.get(J[1]);_e!==void 0&&(L.delete(J[1]),J[1]=_e)}return z.call(v.port1,J[0],J[1],J[2])})(v.port1.removeEventListener);let x=null;Object.defineProperty(v.port1,"onmessage",{get:()=>x,set:z=>{typeof x=="function"&&v.port1.removeEventListener("message",x),x=typeof z=="function"?z:null,typeof x=="function"&&(v.port1.addEventListener("message",x),v.port1.start())}}),g.prototype.port=v.port1;let E=null;$m(d,P,g,m).then(z=>E=z);const $=vr(m.numberOfInputs,m.channelCount),ee=vr(m.numberOfOutputs,w),K=g.parameterDescriptors===void 0?[]:g.parameterDescriptors.reduce((z,{name:J})=>({...z,[J]:new Float32Array(128)}),{});let X=!0;const Y=()=>{m.numberOfOutputs>0&&M.disconnect(N);for(let z=0,J=0;z<m.numberOfOutputs;z+=1){const _e=V[z];for(let le=0;le<w[z];le+=1)N.disconnect(_e,J+le,le);J+=w[z]}},R=new Map;M.onaudioprocess=({inputBuffer:z,outputBuffer:J})=>{if(E!==null){const _e=h(P);for(let le=0;le<I;le+=128){for(let ne=0;ne<m.numberOfInputs;ne+=1)for(let se=0;se<m.channelCount;se+=1)gr(z,$[ne],se,se,le);g.parameterDescriptors!==void 0&&g.parameterDescriptors.forEach(({name:ne},se)=>{gr(z,K,ne,b+se,le)});for(let ne=0;ne<m.numberOfInputs;ne+=1)for(let se=0;se<w[ne];se+=1)ee[ne][se].byteLength===0&&(ee[ne][se]=new Float32Array(128));try{const ne=$.map((Ne,tt)=>{if(_e[tt].size>0)return R.set(tt,I/128),Ne;const _n=R.get(tt);return _n===void 0?[]:(Ne.every(Xn=>Xn.every(Yr=>Yr===0))&&(_n===1?R.delete(tt):R.set(tt,_n-1)),Ne)});X=c(d.currentTime+le/d.sampleRate,d.sampleRate,()=>E.process(ne,ee,K));for(let Ne=0,tt=0;Ne<m.numberOfOutputs;Ne+=1){for(let Gt=0;Gt<w[Ne];Gt+=1)Cl(J,ee[Ne],Gt,tt+Gt,le);tt+=w[Ne]}}catch(ne){X=!1,P.dispatchEvent(new ErrorEvent("processorerror",{colno:ne.colno,filename:ne.filename,lineno:ne.lineno,message:ne.message}))}if(!X){for(let ne=0;ne<m.numberOfInputs;ne+=1){_[ne].disconnect(y[ne]);for(let se=0;se<m.channelCount;se+=1)y[le].disconnect(A,se,ne*m.channelCount+se)}if(g.parameterDescriptors!==void 0){const ne=g.parameterDescriptors.length;for(let se=0;se<ne;se+=1){const Ne=S[se];Ne.disconnect(A,0,b+se),Ne.stop()}}A.disconnect(M),M.onaudioprocess=null,U?Y():Re();break}}}};let U=!1;const he=o(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),Me=()=>M.connect(he).connect(d.destination),Re=()=>{M.disconnect(he),he.disconnect()},st=()=>{if(X){Re(),m.numberOfOutputs>0&&M.connect(N);for(let z=0,J=0;z<m.numberOfOutputs;z+=1){const _e=V[z];for(let le=0;le<w[z];le+=1)N.connect(_e,J+le,le);J+=w[z]}}U=!0},vn=()=>{X&&(Me(),Y()),U=!1};return Me(),f(P,st,vn)},Il=(t,e)=>{const n=t.createBiquadFilter();return Fe(n,e),Se(n,e,"Q"),Se(n,e,"detune"),Se(n,e,"frequency"),Se(n,e,"gain"),be(n,e,"type"),n},Hm=(t,e)=>(n,i)=>{const r=n.createChannelMerger(i.numberOfInputs);return t!==null&&t.name==="webkitAudioContext"&&e(n,r),Fe(r,i),r},Gm=t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:n=>{if(n!==e)throw qe()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:n=>{if(n!=="explicit")throw qe()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:n=>{if(n!=="discrete")throw qe()}})},Ei=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return Fe(n,e),Gm(n),n},Zm=(t,e,n,i,r)=>(s,o)=>{if(s.createConstantSource===void 0)return n(s,o);const a=s.createConstantSource();return Fe(a,o),Se(a,o,"offset"),e(i,()=>i(s))||Xs(a),e(r,()=>r(s))||Qs(a),t(s,a),a},$n=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),Xm=(t,e,n,i)=>(r,{offset:s,...o})=>{const a=r.createBuffer(1,2,44100),l=e(r,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),u=n(r,{...o,gain:s}),c=a.getChannelData(0);c[0]=1,c[1]=1,l.buffer=a,l.loop=!0;const h={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(p){u.channelCount=p},get channelCountMode(){return u.channelCountMode},set channelCountMode(p){u.channelCountMode=p},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(p){u.channelInterpretation=p},get context(){return u.context},get inputs(){return[]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get offset(){return u.gain},get onended(){return l.onended},set onended(p){l.onended=p},addEventListener(...p){return l.addEventListener(p[0],p[1],p[2])},dispatchEvent(...p){return l.dispatchEvent(p[0])},removeEventListener(...p){return l.removeEventListener(p[0],p[1],p[2])},start(p=0){l.start.call(l,p)},stop(p=0){l.stop.call(l,p)}},f=()=>l.connect(u),d=()=>l.disconnect(u);return t(r,l),i($n(h,u),f,d)},Qm=(t,e)=>(n,i)=>{const r=n.createConvolver();if(Fe(r,i),i.disableNormalization===r.normalize&&(r.normalize=!i.disableNormalization),be(r,i,"buffer"),i.channelCount>2||(e(r,"channelCount",s=>()=>s.call(r),s=>o=>{if(o>2)throw t();return s.call(r,o)}),i.channelCountMode==="max"))throw t();return e(r,"channelCountMode",s=>()=>s.call(r),s=>o=>{if(o==="max")throw t();return s.call(r,o)}),r},Ol=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return Fe(n,e),Se(n,e,"delayTime"),n},Ym=t=>(e,n)=>{const i=e.createDynamicsCompressor();if(Fe(i,n),n.channelCount>2||n.channelCountMode==="max")throw t();return Se(i,n,"attack"),Se(i,n,"knee"),Se(i,n,"ratio"),Se(i,n,"release"),Se(i,n,"threshold"),i},Je=(t,e)=>{const n=t.createGain();return Fe(n,e),Se(n,e,"gain"),n},Km=t=>(e,n,i)=>{if(e.createIIRFilter===void 0)return t(e,n,i);const r=e.createIIRFilter(i.feedforward,i.feedback);return Fe(r,i),r};function Jm(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function eg(t,e){return[t[0]*e[0]-t[1]*e[1],t[0]*e[1]+t[1]*e[0]]}function Ca(t,e){let n=[0,0];for(let i=t.length-1;i>=0;i-=1)n=eg(n,e),n[0]+=t[i];return n}const tg=(t,e,n,i)=>(r,s,{channelCount:o,channelCountMode:a,channelInterpretation:l,feedback:u,feedforward:c})=>{const h=Al(s,r.sampleRate),f=u instanceof Float64Array?u:new Float64Array(u),d=c instanceof Float64Array?c:new Float64Array(c),p=f.length,g=d.length,m=Math.min(p,g);if(p===0||p>20)throw i();if(f[0]===0)throw e();if(g===0||g>20)throw i();if(d[0]===0)throw e();if(f[0]!==1){for(let S=0;S<g;S+=1)d[S]/=f[0];for(let S=1;S<p;S+=1)f[S]/=f[0]}const w=n(r,h,o,o);w.channelCount=o,w.channelCountMode=a,w.channelInterpretation=l;const b=32,C=[],T=[],v=[];for(let S=0;S<o;S+=1){C.push(0);const A=new Float32Array(b),I=new Float32Array(b);A.fill(0),I.fill(0),T.push(A),v.push(I)}w.onaudioprocess=S=>{const A=S.inputBuffer,I=S.outputBuffer,M=A.numberOfChannels;for(let N=0;N<M;N+=1){const V=A.getChannelData(N),F=I.getChannelData(N);C[N]=xl(f,p,d,g,m,T[N],v[N],C[N],b,V,F)}};const _=r.sampleRate/2;return $n({get bufferSize(){return h},get channelCount(){return w.channelCount},set channelCount(S){w.channelCount=S},get channelCountMode(){return w.channelCountMode},set channelCountMode(S){w.channelCountMode=S},get channelInterpretation(){return w.channelInterpretation},set channelInterpretation(S){w.channelInterpretation=S},get context(){return w.context},get inputs(){return[w]},get numberOfInputs(){return w.numberOfInputs},get numberOfOutputs(){return w.numberOfOutputs},addEventListener(...S){return w.addEventListener(S[0],S[1],S[2])},dispatchEvent(...S){return w.dispatchEvent(S[0])},getFrequencyResponse(S,A,I){if(S.length!==A.length||A.length!==I.length)throw t();const M=S.length;for(let N=0;N<M;N+=1){const V=-Math.PI*(S[N]/_),F=[Math.cos(V),Math.sin(V)],W=Ca(d,F),j=Ca(f,F),O=Jm(W,j);A[N]=Math.sqrt(O[0]*O[0]+O[1]*O[1]),I[N]=Math.atan2(O[1],O[0])}},removeEventListener(...S){return w.removeEventListener(S[0],S[1],S[2])}},w)},ng=(t,e)=>t.createMediaElementSource(e.mediaElement),ig=(t,e)=>{const n=t.createMediaStreamDestination();return Fe(n,e),n.numberOfOutputs===1&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n},rg=(t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort((s,o)=>s.id<o.id?-1:s.id>o.id?1:0);const i=n.slice(0,1),r=t.createMediaStreamSource(new MediaStream(i));return Object.defineProperty(r,"mediaStream",{value:e}),r},sg=(t,e)=>(n,{mediaStreamTrack:i})=>{if(typeof n.createMediaStreamTrackSource=="function")return n.createMediaStreamTrackSource(i);const r=new MediaStream([i]),s=n.createMediaStreamSource(r);if(i.kind!=="audio")throw t();if(e(n))throw new TypeError;return s},og=t=>t===null?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null,ag=(t,e,n,i,r,s)=>(o,a)=>{const l=o.createOscillator();return Fe(l,a),Se(l,a,"detune"),Se(l,a,"frequency"),a.periodicWave!==void 0?l.setPeriodicWave(a.periodicWave):be(l,a,"type"),e(n,()=>n(o))||Xs(l),e(i,()=>i(o))||s(l,o),e(r,()=>r(o))||Qs(l),t(o,l),l},lg=t=>(e,n)=>{const i=e.createPanner();return i.orientationX===void 0?t(e,n):(Fe(i,n),Se(i,n,"orientationX"),Se(i,n,"orientationY"),Se(i,n,"orientationZ"),Se(i,n,"positionX"),Se(i,n,"positionY"),Se(i,n,"positionZ"),be(i,n,"coneInnerAngle"),be(i,n,"coneOuterAngle"),be(i,n,"coneOuterGain"),be(i,n,"distanceModel"),be(i,n,"maxDistance"),be(i,n,"panningModel"),be(i,n,"refDistance"),be(i,n,"rolloffFactor"),i)},ug=(t,e,n,i,r,s,o,a,l,u)=>(c,{coneInnerAngle:h,coneOuterAngle:f,coneOuterGain:d,distanceModel:p,maxDistance:g,orientationX:m,orientationY:w,orientationZ:b,panningModel:C,positionX:T,positionY:v,positionZ:_,refDistance:y,rolloffFactor:S,...A})=>{const I=c.createPanner();if(A.channelCount>2||A.channelCountMode==="max")throw o();Fe(I,A);const M={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},N=n(c,{...M,channelInterpretation:"speakers",numberOfInputs:6}),V=i(c,{...A,gain:1}),F=i(c,{...M,gain:1}),W=i(c,{...M,gain:0}),j=i(c,{...M,gain:0}),O=i(c,{...M,gain:0}),P=i(c,{...M,gain:0}),L=i(c,{...M,gain:0}),x=r(c,256,6,1),E=s(c,{...M,curve:new Float32Array([1,1]),oversample:"none"});let q=[m,w,b],$=[T,v,_];const ee=new Float32Array(1);x.onaudioprocess=({inputBuffer:R})=>{const U=[l(R,ee,0),l(R,ee,1),l(R,ee,2)];U.some((Me,Re)=>Me!==q[Re])&&(I.setOrientation(...U),q=U);const he=[l(R,ee,3),l(R,ee,4),l(R,ee,5)];he.some((Me,Re)=>Me!==$[Re])&&(I.setPosition(...he),$=he)},Object.defineProperty(W.gain,"defaultValue",{get:()=>0}),Object.defineProperty(j.gain,"defaultValue",{get:()=>0}),Object.defineProperty(O.gain,"defaultValue",{get:()=>0}),Object.defineProperty(P.gain,"defaultValue",{get:()=>0}),Object.defineProperty(L.gain,"defaultValue",{get:()=>0});const K={get bufferSize(){},get channelCount(){return I.channelCount},set channelCount(R){if(R>2)throw o();V.channelCount=R,I.channelCount=R},get channelCountMode(){return I.channelCountMode},set channelCountMode(R){if(R==="max")throw o();V.channelCountMode=R,I.channelCountMode=R},get channelInterpretation(){return I.channelInterpretation},set channelInterpretation(R){V.channelInterpretation=R,I.channelInterpretation=R},get coneInnerAngle(){return I.coneInnerAngle},set coneInnerAngle(R){I.coneInnerAngle=R},get coneOuterAngle(){return I.coneOuterAngle},set coneOuterAngle(R){I.coneOuterAngle=R},get coneOuterGain(){return I.coneOuterGain},set coneOuterGain(R){if(R<0||R>1)throw e();I.coneOuterGain=R},get context(){return I.context},get distanceModel(){return I.distanceModel},set distanceModel(R){I.distanceModel=R},get inputs(){return[V]},get maxDistance(){return I.maxDistance},set maxDistance(R){if(R<0)throw new RangeError;I.maxDistance=R},get numberOfInputs(){return I.numberOfInputs},get numberOfOutputs(){return I.numberOfOutputs},get orientationX(){return F.gain},get orientationY(){return W.gain},get orientationZ(){return j.gain},get panningModel(){return I.panningModel},set panningModel(R){I.panningModel=R},get positionX(){return O.gain},get positionY(){return P.gain},get positionZ(){return L.gain},get refDistance(){return I.refDistance},set refDistance(R){if(R<0)throw new RangeError;I.refDistance=R},get rolloffFactor(){return I.rolloffFactor},set rolloffFactor(R){if(R<0)throw new RangeError;I.rolloffFactor=R},addEventListener(...R){return V.addEventListener(R[0],R[1],R[2])},dispatchEvent(...R){return V.dispatchEvent(R[0])},removeEventListener(...R){return V.removeEventListener(R[0],R[1],R[2])}};h!==K.coneInnerAngle&&(K.coneInnerAngle=h),f!==K.coneOuterAngle&&(K.coneOuterAngle=f),d!==K.coneOuterGain&&(K.coneOuterGain=d),p!==K.distanceModel&&(K.distanceModel=p),g!==K.maxDistance&&(K.maxDistance=g),m!==K.orientationX.value&&(K.orientationX.value=m),w!==K.orientationY.value&&(K.orientationY.value=w),b!==K.orientationZ.value&&(K.orientationZ.value=b),C!==K.panningModel&&(K.panningModel=C),T!==K.positionX.value&&(K.positionX.value=T),v!==K.positionY.value&&(K.positionY.value=v),_!==K.positionZ.value&&(K.positionZ.value=_),y!==K.refDistance&&(K.refDistance=y),S!==K.rolloffFactor&&(K.rolloffFactor=S),(q[0]!==1||q[1]!==0||q[2]!==0)&&I.setOrientation(...q),($[0]!==0||$[1]!==0||$[2]!==0)&&I.setPosition(...$);const X=()=>{V.connect(I),t(V,E,0,0),E.connect(F).connect(N,0,0),E.connect(W).connect(N,0,1),E.connect(j).connect(N,0,2),E.connect(O).connect(N,0,3),E.connect(P).connect(N,0,4),E.connect(L).connect(N,0,5),N.connect(x).connect(c.destination)},Y=()=>{V.disconnect(I),a(V,E,0,0),E.disconnect(F),F.disconnect(N),E.disconnect(W),W.disconnect(N),E.disconnect(j),j.disconnect(N),E.disconnect(O),O.disconnect(N),E.disconnect(P),P.disconnect(N),E.disconnect(L),L.disconnect(N),N.disconnect(x),x.disconnect(c.destination)};return u($n(K,I),X,Y)},cg=t=>(e,{disableNormalization:n,imag:i,real:r})=>{const s=i instanceof Float32Array?i:new Float32Array(i),o=r instanceof Float32Array?r:new Float32Array(r),a=e.createPeriodicWave(o,s,{disableNormalization:n});if(Array.from(i).length<2)throw t();return a},Vi=(t,e,n,i)=>t.createScriptProcessor(e,n,i),hg=(t,e)=>(n,i)=>{const r=i.channelCountMode;if(r==="clamped-max")throw e();if(n.createStereoPanner===void 0)return t(n,i);const s=n.createStereoPanner();return Fe(s,i),Se(s,i,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>r,set:o=>{if(o!==r)throw e()}}),s},dg=(t,e,n,i,r,s)=>{const a=new Float32Array([1,1]),l=Math.PI/2,u={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},c={...u,oversample:"none"},h=(p,g,m,w)=>{const b=new Float32Array(16385),C=new Float32Array(16385);for(let A=0;A<16385;A+=1){const I=A/16384*l;b[A]=Math.cos(I),C[A]=Math.sin(I)}const T=n(p,{...u,gain:0}),v=i(p,{...c,curve:b}),_=i(p,{...c,curve:a}),y=n(p,{...u,gain:0}),S=i(p,{...c,curve:C});return{connectGraph(){g.connect(T),g.connect(_.inputs===void 0?_:_.inputs[0]),g.connect(y),_.connect(m),m.connect(v.inputs===void 0?v:v.inputs[0]),m.connect(S.inputs===void 0?S:S.inputs[0]),v.connect(T.gain),S.connect(y.gain),T.connect(w,0,0),y.connect(w,0,1)},disconnectGraph(){g.disconnect(T),g.disconnect(_.inputs===void 0?_:_.inputs[0]),g.disconnect(y),_.disconnect(m),m.disconnect(v.inputs===void 0?v:v.inputs[0]),m.disconnect(S.inputs===void 0?S:S.inputs[0]),v.disconnect(T.gain),S.disconnect(y.gain),T.disconnect(w,0,0),y.disconnect(w,0,1)}}},f=(p,g,m,w)=>{const b=new Float32Array(16385),C=new Float32Array(16385),T=new Float32Array(16385),v=new Float32Array(16385),_=Math.floor(16385/2);for(let O=0;O<16385;O+=1)if(O>_){const P=(O-_)/(16384-_)*l;b[O]=Math.cos(P),C[O]=Math.sin(P),T[O]=0,v[O]=1}else{const P=O/(16384-_)*l;b[O]=1,C[O]=0,T[O]=Math.cos(P),v[O]=Math.sin(P)}const y=e(p,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),S=n(p,{...u,gain:0}),A=i(p,{...c,curve:b}),I=n(p,{...u,gain:0}),M=i(p,{...c,curve:C}),N=i(p,{...c,curve:a}),V=n(p,{...u,gain:0}),F=i(p,{...c,curve:T}),W=n(p,{...u,gain:0}),j=i(p,{...c,curve:v});return{connectGraph(){g.connect(y),g.connect(N.inputs===void 0?N:N.inputs[0]),y.connect(S,0),y.connect(I,0),y.connect(V,1),y.connect(W,1),N.connect(m),m.connect(A.inputs===void 0?A:A.inputs[0]),m.connect(M.inputs===void 0?M:M.inputs[0]),m.connect(F.inputs===void 0?F:F.inputs[0]),m.connect(j.inputs===void 0?j:j.inputs[0]),A.connect(S.gain),M.connect(I.gain),F.connect(V.gain),j.connect(W.gain),S.connect(w,0,0),V.connect(w,0,0),I.connect(w,0,1),W.connect(w,0,1)},disconnectGraph(){g.disconnect(y),g.disconnect(N.inputs===void 0?N:N.inputs[0]),y.disconnect(S,0),y.disconnect(I,0),y.disconnect(V,1),y.disconnect(W,1),N.disconnect(m),m.disconnect(A.inputs===void 0?A:A.inputs[0]),m.disconnect(M.inputs===void 0?M:M.inputs[0]),m.disconnect(F.inputs===void 0?F:F.inputs[0]),m.disconnect(j.inputs===void 0?j:j.inputs[0]),A.disconnect(S.gain),M.disconnect(I.gain),F.disconnect(V.gain),j.disconnect(W.gain),S.disconnect(w,0,0),V.disconnect(w,0,0),I.disconnect(w,0,1),W.disconnect(w,0,1)}}},d=(p,g,m,w,b)=>{if(g===1)return h(p,m,w,b);if(g===2)return f(p,m,w,b);throw r()};return(p,{channelCount:g,channelCountMode:m,pan:w,...b})=>{if(m==="max")throw r();const C=t(p,{...b,channelCount:1,channelCountMode:m,numberOfInputs:2}),T=n(p,{...b,channelCount:g,channelCountMode:m,gain:1}),v=n(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:w});let{connectGraph:_,disconnectGraph:y}=d(p,g,T,v,C);Object.defineProperty(v.gain,"defaultValue",{get:()=>0}),Object.defineProperty(v.gain,"maxValue",{get:()=>1}),Object.defineProperty(v.gain,"minValue",{get:()=>-1});const S={get bufferSize(){},get channelCount(){return T.channelCount},set channelCount(N){T.channelCount!==N&&(A&&y(),{connectGraph:_,disconnectGraph:y}=d(p,N,T,v,C),A&&_()),T.channelCount=N},get channelCountMode(){return T.channelCountMode},set channelCountMode(N){if(N==="clamped-max"||N==="max")throw r();T.channelCountMode=N},get channelInterpretation(){return T.channelInterpretation},set channelInterpretation(N){T.channelInterpretation=N},get context(){return T.context},get inputs(){return[T]},get numberOfInputs(){return T.numberOfInputs},get numberOfOutputs(){return T.numberOfOutputs},get pan(){return v.gain},addEventListener(...N){return T.addEventListener(N[0],N[1],N[2])},dispatchEvent(...N){return T.dispatchEvent(N[0])},removeEventListener(...N){return T.removeEventListener(N[0],N[1],N[2])}};let A=!1;const I=()=>{_(),A=!0},M=()=>{y(),A=!1};return s($n(S,C),I,M)}},fg=(t,e,n,i,r,s,o)=>(a,l)=>{const u=a.createWaveShaper();if(s!==null&&s.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return n(a,l);Fe(u,l);const c=l.curve===null||l.curve instanceof Float32Array?l.curve:new Float32Array(l.curve);if(c!==null&&c.length<2)throw e();be(u,{curve:c},"curve"),be(u,l,"oversample");let h=null,f=!1;return o(u,"curve",g=>()=>g.call(u),g=>m=>(g.call(u,m),f&&(i(m)&&h===null?h=t(a,u):!i(m)&&h!==null&&(h(),h=null)),m)),r(u,()=>{f=!0,i(u.curve)&&(h=t(a,u))},()=>{f=!1,h!==null&&(h(),h=null)})},pg=(t,e,n,i,r)=>(s,{curve:o,oversample:a,...l})=>{const u=s.createWaveShaper(),c=s.createWaveShaper();Fe(u,l),Fe(c,l);const h=n(s,{...l,gain:1}),f=n(s,{...l,gain:-1}),d=n(s,{...l,gain:1}),p=n(s,{...l,gain:-1});let g=null,m=!1,w=null;const b={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(v){h.channelCount=v,f.channelCount=v,u.channelCount=v,d.channelCount=v,c.channelCount=v,p.channelCount=v},get channelCountMode(){return u.channelCountMode},set channelCountMode(v){h.channelCountMode=v,f.channelCountMode=v,u.channelCountMode=v,d.channelCountMode=v,c.channelCountMode=v,p.channelCountMode=v},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(v){h.channelInterpretation=v,f.channelInterpretation=v,u.channelInterpretation=v,d.channelInterpretation=v,c.channelInterpretation=v,p.channelInterpretation=v},get context(){return u.context},get curve(){return w},set curve(v){if(v!==null&&v.length<2)throw e();if(v===null)u.curve=v,c.curve=v;else{const _=v.length,y=new Float32Array(_+2-_%2),S=new Float32Array(_+2-_%2);y[0]=v[0],S[0]=-v[_-1];const A=Math.ceil((_+1)/2),I=(_+1)/2-1;for(let M=1;M<A;M+=1){const N=M/A*I,V=Math.floor(N),F=Math.ceil(N);y[M]=V===F?v[V]:(1-(N-V))*v[V]+(1-(F-N))*v[F],S[M]=V===F?-v[_-1-V]:-((1-(N-V))*v[_-1-V])-(1-(F-N))*v[_-1-F]}y[A]=_%2===1?v[A-1]:(v[A-2]+v[A-1])/2,u.curve=y,c.curve=S}w=v,m&&(i(w)&&g===null?g=t(s,h):g!==null&&(g(),g=null))},get inputs(){return[h]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get oversample(){return u.oversample},set oversample(v){u.oversample=v,c.oversample=v},addEventListener(...v){return h.addEventListener(v[0],v[1],v[2])},dispatchEvent(...v){return h.dispatchEvent(v[0])},removeEventListener(...v){return h.removeEventListener(v[0],v[1],v[2])}};o!==null&&(b.curve=o instanceof Float32Array?o:new Float32Array(o)),a!==b.oversample&&(b.oversample=a);const C=()=>{h.connect(u).connect(d),h.connect(f).connect(c).connect(p).connect(d),m=!0,i(w)&&(g=t(s,h))},T=()=>{h.disconnect(u),u.disconnect(d),h.disconnect(f),f.disconnect(c),c.disconnect(p),p.disconnect(d),m=!1,g!==null&&(g(),g=null)};return r($n(b,d),C,T)},Xe=()=>new DOMException("","NotSupportedError"),mg={numberOfChannels:1},gg=(t,e,n,i,r)=>class extends t{constructor(o,a,l){let u;if(typeof o=="number"&&a!==void 0&&l!==void 0)u={length:a,numberOfChannels:o,sampleRate:l};else if(typeof o=="object")u=o;else throw new Error("The given parameters are not valid.");const{length:c,numberOfChannels:h,sampleRate:f}={...mg,...u},d=i(h,c,f);e(ci,()=>ci(d))||d.addEventListener("statechange",(()=>{let p=0;const g=m=>{this._state==="running"&&(p>0?(d.removeEventListener("statechange",g),m.stopImmediatePropagation(),this._waitForThePromiseToSettle(m)):p+=1)};return g})()),super(d,h),this._length=c,this._nativeOfflineAudioContext=d,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(n()):(this._state="running",r(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,bl(this)}))}_waitForThePromiseToSettle(o){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(o):setTimeout(()=>this._waitForThePromiseToSettle(o))}},vg={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},_g=(t,e,n,i,r,s,o)=>class extends t{constructor(l,u){const c=r(l),h={...vg,...u},f=n(c,h),d=s(c),p=d?i():null,g=l.sampleRate/2;super(l,!1,f,p),this._detune=e(this,d,f.detune,153600,-153600),this._frequency=e(this,d,f.frequency,g,-g),this._nativeOscillatorNode=f,this._onended=null,this._oscillatorNodeRenderer=p,this._oscillatorNodeRenderer!==null&&h.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=h.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(l){const u=typeof l=="function"?o(this,l):null;this._nativeOscillatorNode.onended=u;const c=this._nativeOscillatorNode.onended;this._onended=c!==null&&c===u?l:c}get type(){return this._nativeOscillatorNode.type}set type(l){this._nativeOscillatorNode.type=l,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(l){this._nativeOscillatorNode.setPeriodicWave(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=l)}start(l=0){if(this._nativeOscillatorNode.start(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=l),this.context.state!=="closed"){Rn(this);const u=()=>{this._nativeOscillatorNode.removeEventListener("ended",u),Ot(this)&&Oi(this)};this._nativeOscillatorNode.addEventListener("ended",u)}}stop(l=0){this._nativeOscillatorNode.stop(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=l)}},yg=(t,e,n,i,r)=>()=>{const s=new WeakMap;let o=null,a=null,l=null;const u=async(c,h)=>{let f=n(c);const d=Ue(f,h);if(!d){const p={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,detune:f.detune.value,frequency:f.frequency.value,periodicWave:o===null?void 0:o,type:f.type};f=e(h,p),a!==null&&f.start(a),l!==null&&f.stop(l)}return s.set(h,f),d?(await t(h,c.detune,f.detune),await t(h,c.frequency,f.frequency)):(await i(h,c.detune,f.detune),await i(h,c.frequency,f.frequency)),await r(c,h,f),f};return{set periodicWave(c){o=c},set start(c){a=c},set stop(c){l=c},render(c,h){const f=s.get(h);return f!==void 0?Promise.resolve(f):u(c,h)}}},bg={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},wg=(t,e,n,i,r,s,o)=>class extends t{constructor(l,u){const c=r(l),h={...bg,...u},f=n(c,h),d=s(c),p=d?i():null;super(l,!1,f,p),this._nativePannerNode=f,this._orientationX=e(this,d,f.orientationX,ze,Qe),this._orientationY=e(this,d,f.orientationY,ze,Qe),this._orientationZ=e(this,d,f.orientationZ,ze,Qe),this._positionX=e(this,d,f.positionX,ze,Qe),this._positionY=e(this,d,f.positionY,ze,Qe),this._positionZ=e(this,d,f.positionZ,ze,Qe),o(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(l){this._nativePannerNode.coneInnerAngle=l}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(l){this._nativePannerNode.coneOuterAngle=l}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(l){this._nativePannerNode.coneOuterGain=l}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(l){this._nativePannerNode.distanceModel=l}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(l){this._nativePannerNode.maxDistance=l}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(l){this._nativePannerNode.panningModel=l}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(l){this._nativePannerNode.refDistance=l}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(l){this._nativePannerNode.rolloffFactor=l}},Sg=(t,e,n,i,r,s,o,a,l,u)=>()=>{const c=new WeakMap;let h=null;const f=async(d,p)=>{let g=null,m=s(d);const w={channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation},b={...w,coneInnerAngle:m.coneInnerAngle,coneOuterAngle:m.coneOuterAngle,coneOuterGain:m.coneOuterGain,distanceModel:m.distanceModel,maxDistance:m.maxDistance,panningModel:m.panningModel,refDistance:m.refDistance,rolloffFactor:m.rolloffFactor},C=Ue(m,p);if("bufferSize"in m)g=i(p,{...w,gain:1});else if(!C){const T={...b,orientationX:m.orientationX.value,orientationY:m.orientationY.value,orientationZ:m.orientationZ.value,positionX:m.positionX.value,positionY:m.positionY.value,positionZ:m.positionZ.value};m=r(p,T)}if(c.set(p,g===null?m:g),g!==null){if(h===null){if(o===null)throw new Error("Missing the native OfflineAudioContext constructor.");const M=new o(6,d.context.length,p.sampleRate),N=e(M,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});N.connect(M.destination),h=(async()=>{const V=await Promise.all([d.orientationX,d.orientationY,d.orientationZ,d.positionX,d.positionY,d.positionZ].map(async(F,W)=>{const j=n(M,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:W===0?1:0});return await a(M,F,j.offset),j}));for(let F=0;F<6;F+=1)V[F].connect(N,0,F),V[F].start(0);return u(M)})()}const T=await h,v=i(p,{...w,gain:1});await l(d,p,v);const _=[];for(let M=0;M<T.numberOfChannels;M+=1)_.push(T.getChannelData(M));let y=[_[0][0],_[1][0],_[2][0]],S=[_[3][0],_[4][0],_[5][0]],A=i(p,{...w,gain:1}),I=r(p,{...b,orientationX:y[0],orientationY:y[1],orientationZ:y[2],positionX:S[0],positionY:S[1],positionZ:S[2]});v.connect(A).connect(I.inputs[0]),I.connect(g);for(let M=128;M<T.length;M+=128){const N=[_[0][M],_[1][M],_[2][M]],V=[_[3][M],_[4][M],_[5][M]];if(N.some((F,W)=>F!==y[W])||V.some((F,W)=>F!==S[W])){y=N,S=V;const F=M/p.sampleRate;A.gain.setValueAtTime(0,F),A=i(p,{...w,gain:0}),I=r(p,{...b,orientationX:y[0],orientationY:y[1],orientationZ:y[2],positionX:S[0],positionY:S[1],positionZ:S[2]}),A.gain.setValueAtTime(1,F),v.connect(A).connect(I.inputs[0]),I.connect(g)}}return g}return C?(await t(p,d.orientationX,m.orientationX),await t(p,d.orientationY,m.orientationY),await t(p,d.orientationZ,m.orientationZ),await t(p,d.positionX,m.positionX),await t(p,d.positionY,m.positionY),await t(p,d.positionZ,m.positionZ)):(await a(p,d.orientationX,m.orientationX),await a(p,d.orientationY,m.orientationY),await a(p,d.orientationZ,m.orientationZ),await a(p,d.positionX,m.positionX),await a(p,d.positionY,m.positionY),await a(p,d.positionZ,m.positionZ)),Wn(m)?await l(d,p,m.inputs[0]):await l(d,p,m),m};return{render(d,p){const g=c.get(p);return g!==void 0?Promise.resolve(g):f(d,p)}}},Tg={disableNormalization:!1},kg=(t,e,n,i)=>class Ml{constructor(s,o){const a=e(s),l=i({...Tg,...o}),u=t(a,l);return n.add(u),u}static[Symbol.hasInstance](s){return s!==null&&typeof s=="object"&&Object.getPrototypeOf(s)===Ml.prototype||n.has(s)}},Cg=(t,e)=>(n,i,r)=>(t(i).replay(r),e(i,n,r)),xg=(t,e,n)=>async(i,r,s)=>{const o=t(i);await Promise.all(o.activeInputs.map((a,l)=>Array.from(a).map(async([u,c])=>{const f=await e(u).render(u,r),d=i.context.destination;!n(u)&&(i!==d||!n(i))&&f.connect(s,c,l)})).reduce((a,l)=>[...a,...l],[]))},Ag=(t,e,n)=>async(i,r,s)=>{const o=e(i);await Promise.all(Array.from(o.activeInputs).map(async([a,l])=>{const c=await t(a).render(a,r);n(a)||c.connect(s,l)}))},Ig=(t,e,n,i)=>r=>t(ci,()=>ci(r))?Promise.resolve(t(i,i)).then(s=>{if(!s){const o=n(r,512,0,1);r.oncomplete=()=>{o.onaudioprocess=null,o.disconnect()},o.onaudioprocess=()=>r.currentTime,o.connect(r.destination)}return r.startRendering()}):new Promise(s=>{const o=e(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});r.oncomplete=a=>{o.disconnect(),s(a.renderedBuffer)},o.connect(r.destination),r.startRendering()}),Og=t=>(e,n)=>{t.set(e,n)},Mg=t=>(e,n)=>t.set(e,n),Ng=(t,e,n,i,r,s,o,a)=>(l,u)=>n(l).render(l,u).then(()=>Promise.all(Array.from(i(u)).map(c=>n(c).render(c,u)))).then(()=>r(u)).then(c=>(typeof c.copyFromChannel!="function"?(o(c),Hs(c)):e(s,()=>s(c))||a(c),t.add(c),c)),Eg={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},Vg=(t,e,n,i,r,s)=>class extends t{constructor(a,l){const u=r(a),c={...Eg,...l},h=n(u,c),f=s(u),d=f?i():null;super(a,!1,h,d),this._pan=e(this,f,h.pan)}get pan(){return this._pan}},Dg=(t,e,n,i,r)=>()=>{const s=new WeakMap,o=async(a,l)=>{let u=n(a);const c=Ue(u,l);if(!c){const h={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,pan:u.pan.value};u=e(l,h)}return s.set(l,u),c?await t(l,a.pan,u.pan):await i(l,a.pan,u.pan),Wn(u)?await r(a,l,u.inputs[0]):await r(a,l,u),u};return{render(a,l){const u=s.get(l);return u!==void 0?Promise.resolve(u):o(a,l)}}},Fg=t=>()=>{if(t===null)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0},Pg=(t,e)=>async()=>{if(t===null)return!0;if(e===null)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),i=new e(1,128,44100),r=URL.createObjectURL(n);let s=!1,o=!1;try{await i.audioWorklet.addModule(r);const a=new t(i,"a",{numberOfOutputs:0}),l=i.createOscillator();a.port.onmessage=()=>s=!0,a.onprocessorerror=()=>o=!0,l.connect(a),l.start(0),await i.startRendering()}catch{}finally{URL.revokeObjectURL(r)}return s&&!o},Rg=(t,e)=>()=>{if(e===null)return Promise.resolve(!1);const n=new e(1,1,44100),i=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(r=>{n.oncomplete=()=>{i.disconnect(),r(n.currentTime!==0)},n.startRendering()})},qg=()=>new DOMException("","UnknownError"),Bg={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},Lg=(t,e,n,i,r,s,o)=>class extends t{constructor(l,u){const c=r(l),h={...Bg,...u},f=n(c,h),p=s(c)?i():null;super(l,!0,f,p),this._isCurveNullified=!1,this._nativeWaveShaperNode=f,o(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(l){if(l===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(l.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=l}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(l){this._nativeWaveShaperNode.oversample=l}},jg=(t,e,n)=>()=>{const i=new WeakMap,r=async(s,o)=>{let a=e(s);if(!Ue(a,o)){const u={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=t(o,u)}return i.set(o,a),Wn(a)?await n(s,o,a.inputs[0]):await n(s,o,a),a};return{render(s,o){const a=i.get(o);return a!==void 0?Promise.resolve(a):r(s,o)}}},Ug=()=>typeof window=="undefined"?null:window,Wg=(t,e)=>n=>{n.copyFromChannel=(i,r,s=0)=>{const o=t(s),a=t(r);if(a>=n.numberOfChannels)throw e();const l=n.length,u=n.getChannelData(a),c=i.length;for(let h=o<0?-o:0;h+o<l&&h<c;h+=1)i[h]=u[h+o]},n.copyToChannel=(i,r,s=0)=>{const o=t(s),a=t(r);if(a>=n.numberOfChannels)throw e();const l=n.length,u=n.getChannelData(a),c=i.length;for(let h=o<0?-o:0;h+o<l&&h<c;h+=1)u[h+o]=i[h]}},$g=t=>e=>{e.copyFromChannel=(n=>(i,r,s=0)=>{const o=t(s),a=t(r);if(o<e.length)return n.call(e,i,a,o)})(e.copyFromChannel),e.copyToChannel=(n=>(i,r,s=0)=>{const o=t(s),a=t(r);if(o<e.length)return n.call(e,i,a,o)})(e.copyToChannel)},zg=t=>(e,n)=>{const i=n.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=i),t(e,"buffer",r=>()=>{const s=r.call(e);return s===i?null:s},r=>s=>r.call(e,s===null?i:s))},Hg=(t,e)=>(n,i)=>{i.channelCount=1,i.channelCountMode="explicit",Object.defineProperty(i,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(i,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});const r=n.createBufferSource();e(i,()=>{const a=i.numberOfInputs;for(let l=0;l<a;l+=1)r.connect(i,0,l)},()=>r.disconnect(i))},Nl=(t,e,n)=>t.copyFromChannel===void 0?t.getChannelData(n)[0]:(t.copyFromChannel(e,n),e[0]),El=t=>{if(t===null)return!1;const e=t.length;return e%2!==0?t[Math.floor(e/2)]!==0:t[e/2-1]+t[e/2]!==0},Di=(t,e,n,i)=>{let r=t;for(;!r.hasOwnProperty(e);)r=Object.getPrototypeOf(r);const{get:s,set:o}=Object.getOwnPropertyDescriptor(r,e);Object.defineProperty(t,e,{get:n(s),set:i(o)})},Gg=t=>({...t,outputChannelCount:t.outputChannelCount!==void 0?t.outputChannelCount:t.numberOfInputs===1&&t.numberOfOutputs===1?[t.channelCount]:Array.from({length:t.numberOfOutputs},()=>1)}),Zg=t=>({...t,channelCount:t.numberOfOutputs}),Xg=t=>{const{imag:e,real:n}=t;return e===void 0?n===void 0?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,()=>0),real:n}:n===void 0?{...t,imag:e,real:Array.from(e,()=>0)}:{...t,imag:e,real:n}},Vl=(t,e,n)=>{try{t.setValueAtTime(e,n)}catch(i){if(i.code!==9)throw i;Vl(t,e,n+1e-7)}},Qg=t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},Yg=t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0},Kg=t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},Ys=t=>{const e=t.createOscillator();try{e.start(-1)}catch(n){return n instanceof RangeError}return!1},Dl=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},Ks=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(n){return n instanceof RangeError}return!1},Jg=t=>{const{port1:e,port2:n}=new MessageChannel;try{e.postMessage(t)}finally{e.close(),n.close()}},ev=t=>{t.start=(e=>(n=0,i=0,r)=>{const s=t.buffer,o=s===null?i:Math.min(s.duration,i);s!==null&&o>s.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,o,r)})(t.start)},Fl=(t,e)=>{const n=e.createGain();t.connect(n);const i=(r=>()=>{r.call(t,n),t.removeEventListener("ended",i)})(t.disconnect);t.addEventListener("ended",i),$n(t,n),t.stop=(r=>{let s=!1;return(o=0)=>{if(s)try{r.call(t,o)}catch{n.gain.setValueAtTime(0,o)}else r.call(t,o),s=!0}})(t.stop)},zn=(t,e)=>n=>{const i={value:t};return Object.defineProperties(n,{currentTarget:i,target:i}),typeof e=="function"?e.call(t,n):e.handleEvent.call(t,n)},tv=wf(pn),nv=Af(pn),iv=Bp(Ur),Pl=new WeakMap,rv=im(Pl),mt=mp(new Map,new WeakMap),yt=Ug(),Rl=Vm(mt,wt),Js=nm(He),je=xg(He,Js,ln),sv=Ef(Rl,ve,je),ge=om(jr),Et=og(yt),de=Tm(Et),ql=new WeakMap,Bl=Xp(zn),Fi=Rm(yt),eo=ym(Fi),to=bm(yt),Ll=wm(yt),hi=Bm(yt),Ie=ip(Sf(fl),xf(tv,nv,fr,iv,pr,He,rv,Ii,ve,pn,Ot,ln,er),mt,pm(Os,pr,He,ve,ui,Ot),wt,Wr,Xe,Fp(fr,Os,He,ve,ui,ge,Ot,de),Up(ql,He,ft),Bl,ge,eo,to,Ll,de,hi),ov=Nf(Ie,sv,wt,Rl,ge,de),no=new WeakSet,xa=Dm(yt),jl=Ip(new Uint32Array(1)),io=Wg(jl,wt),ro=$g(jl),av=Df(no,mt,Xe,xa,Et,Fg(xa),io,ro),$r=If(Je),Ul=Ag(Js,Mi,ln),St=Sp(Ul),Hn=Pm($r,mt,Qg,Yg,Kg,Ys,Dl,Ks,ev,zg(Di),Fl),Tt=Cg(rm(Mi),Ul),lv=Rf(St,Hn,ve,Tt,je),gt=rp(Tf(pl),ql,zs,sp,mf,gf,vf,_f,yf,xs,hl,Fi,Vl),uv=Pf(Ie,lv,gt,qe,Hn,ge,de,zn),cv=Hf(Ie,Gf,wt,qe,qm(Je,Di),ge,de,je),hv=pp(St,Il,ve,Tt,je),mn=Mg(Pl),dv=fp(Ie,gt,hv,Wr,Il,ge,de,mn),zt=Nm(pn,to),fv=Hg(qe,zt),Ht=Hm(Fi,fv),pv=_p(Ht,ve,je),mv=vp(Ie,pv,Ht,ge,de),gv=wp(Ei,ve,je),vv=bp(Ie,gv,Ei,ge,de,Zg),_v=Xm($r,Hn,Je,zt),Gn=Zm($r,mt,_v,Ys,Ks),yv=Ap(St,Gn,ve,Tt,je),bv=xp(Ie,gt,yv,Gn,ge,de,zn),Wl=Qm(Xe,Di),wv=Np(Wl,ve,je),Sv=Mp(Ie,wv,Wl,ge,de,mn),Tv=qp(St,Ol,ve,Tt,je),kv=Rp(Ie,gt,Tv,Ol,ge,de,mn),$l=Ym(Xe),Cv=Hp(St,$l,ve,Tt,je),xv=zp(Ie,gt,Cv,$l,Xe,ge,de,mn),Av=em(St,Je,ve,Tt,je),Iv=Jp(Ie,gt,Av,Je,ge,de),Ov=tg(Wr,qe,Vi,Xe),zr=Ig(mt,Je,Vi,Rg(Je,Et)),Mv=fm(Hn,ve,Et,je,zr),Nv=Km(Ov),Ev=hm(Ie,Nv,Mv,ge,de,mn),Vv=Zf(gt,Ht,Gn,Vi,Xe,Nl,de,Di),zl=new WeakMap,Dv=Mm(cv,Vv,Bl,de,zl,zn),Hl=ag($r,mt,Ys,Dl,Ks,Fl),Fv=yg(St,Hl,ve,Tt,je),Pv=_g(Ie,gt,Hl,Fv,ge,de,zn),Gl=kp(Hn),Rv=pg(Gl,qe,Je,El,zt),Hr=fg(Gl,qe,Rv,El,zt,Fi,Di),qv=ug(fr,qe,Ht,Je,Vi,Hr,Xe,pr,Nl,zt),Zl=lg(qv),Bv=Sg(St,Ht,Gn,Je,Zl,ve,Et,Tt,je,zr),Lv=wg(Ie,gt,Zl,Bv,ge,de,mn),jv=cg(wt),Uv=kg(jv,ge,new WeakSet,Xg),Wv=dg(Ht,Ei,Je,Hr,Xe,zt),Xl=hg(Wv,Xe),$v=Dg(St,Xl,ve,Tt,je),zv=Vg(Ie,gt,Xl,$v,ge,de),Hv=jg(Hr,ve,je),Gv=Lg(Ie,qe,Hr,Hv,ge,de,mn),Ql=km(yt),so=Qp(yt),Yl=new WeakMap,Zv=am(Yl,Et),Xv=Ql?Cf(mt,Xe,Zp(yt),so,Yp(bf),ge,Zv,de,hi,new WeakMap,new WeakMap,Pg(hi,Et),yt):void 0,Qv=Sm(eo,de),Yv=Dp(no,mt,Vp,Gp,new WeakSet,ge,Qv,hr,ci,io,ro),Kl=hp(Xv,ov,av,uv,dv,mv,vv,bv,Sv,Yv,kv,xv,Iv,Ev,Dv,Pv,Lv,Uv,zv,Gv),Kv=Cm(Ie,ng,ge,de),Jv=Am(Ie,ig,ge,de),e_=Im(Ie,rg,ge,de),t_=sg(qe,de),n_=Om(Ie,t_,ge),i_=zf(Kl,qe,Xe,qg,Kv,Jv,e_,n_,Fi),oo=lm(zl),r_=Of(oo),Jl=Tp(wt),s_=Lp(oo),eu=Wp(wt),tu=new WeakMap,o_=tm(tu,ft),a_=zm(Jl,wt,qe,Ht,Ei,Gn,Je,Vi,Xe,eu,so,o_,zt),l_=jm(qe,a_,Je,Xe,zt),u_=cp(St,Jl,Hn,Ht,Ei,Gn,Je,s_,eu,so,ve,hi,Et,Tt,je,zr),c_=sm(Yl),h_=Og(tu),Aa=Ql?ap(r_,Ie,gt,u_,l_,He,c_,ge,de,hi,Gg,h_,Jg,zn):void 0,d_=Ep(Xe,Et),f_=Ng(no,mt,Js,oo,zr,hr,io,ro),p_=gg(Kl,mt,qe,d_,f_),m_=mm(jr,eo),g_=gm($s,to),v_=vm(zs,Ll),__=_m(jr,de);function te(t,e){if(!t)throw new Error(e)}function Ut(t,e,n=1/0){if(!(e<=t&&t<=n))throw new RangeError(`Value must be within [${e}, ${n}], got: ${t}`)}function nu(t){!t.isOffline&&t.state!=="running"&&ao('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let iu=console;function y_(...t){iu.log(...t)}function ao(...t){iu.warn(...t)}function at(t){return typeof t=="undefined"}function ae(t){return!at(t)}function b_(t){return typeof t=="function"}function Wt(t){return typeof t=="number"}function nn(t){return Object.prototype.toString.call(t)==="[object Object]"&&t.constructor===Object}function w_(t){return typeof t=="boolean"}function it(t){return Array.isArray(t)}function bt(t){return typeof t=="string"}function Ki(t){return bt(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t)}function S_(t){return new i_(t)}function T_(t,e,n){return new p_(t,e,n)}const rn=typeof self=="object"?self:null,k_=rn&&(rn.hasOwnProperty("AudioContext")||rn.hasOwnProperty("webkitAudioContext"));function C_(t,e,n){return te(ae(Aa),"This node only works in a secure context (https or localhost)"),new Aa(t,e,n)}function vt(t,e,n,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,n):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s}function Oe(t,e,n,i){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(c){try{u(i.next(c))}catch(h){o(h)}}function l(c){try{u(i.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(a,l)}u((i=i.apply(t,e||[])).next())})}class x_{constructor(e,n,i){this._callback=e,this._type=n,this._updateInterval=i,this._createClock()}_createWorker(){const e=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(this._updateInterval*1e3).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),n=URL.createObjectURL(e),i=new Worker(n);i.onmessage=this._callback.bind(this),this._worker=i}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},this._updateInterval*1e3)}_createClock(){if(this._type==="worker")try{this._createWorker()}catch{this._type="timeout",this._createClock()}else this._type==="timeout"&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(e){this._updateInterval=Math.max(e,128/44100),this._type==="worker"&&this._worker.postMessage(Math.max(e*1e3,1))}get type(){return this._type}set type(e){this._disposeClock(),this._type=e,this._createClock()}dispose(){this._disposeClock()}}function un(t){return v_(t)}function jt(t){return g_(t)}function tr(t){return __(t)}function Mn(t){return m_(t)}function ru(t){return t instanceof AudioBuffer}function A_(t,e){return t==="value"||un(e)||jt(e)||ru(e)}function sn(t,...e){if(!e.length)return t;const n=e.shift();if(nn(t)&&nn(n))for(const i in n)A_(i,n[i])?t[i]=n[i]:nn(n[i])?(t[i]||Object.assign(t,{[i]:{}}),sn(t[i],n[i])):Object.assign(t,{[i]:n[i]});return sn(t,...e)}function I_(t,e){return t.length===e.length&&t.every((n,i)=>e[i]===n)}function H(t,e,n=[],i){const r={},s=Array.from(e);if(nn(s[0])&&i&&!Reflect.has(s[0],i)&&(Object.keys(s[0]).some(a=>Reflect.has(t,a))||(sn(r,{[i]:s[0]}),n.splice(n.indexOf(i),1),s.shift())),s.length===1&&nn(s[0]))sn(r,s[0]);else for(let o=0;o<n.length;o++)ae(s[o])&&(r[n[o]]=s[o]);return sn(t,r)}function O_(t){return t.constructor.getDefaults()}function Dn(t,e){return at(t)?e:t}function Ds(t,e){return e.forEach(n=>{Reflect.has(t,n)&&delete t[n]}),t}/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2019 Yotam Mann
 */class Vt{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...e){(this.debug||rn&&this.toString()===rn.TONE_DEBUG_CLASS)&&y_(this,...e)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}Vt.version=cl;const lo=1e-6;function _r(t,e){return t>e+lo}function Fs(t,e){return _r(t,e)||ut(t,e)}function su(t,e){return t+lo<e}function ut(t,e){return Math.abs(t-e)<lo}function M_(t,e,n){return Math.max(Math.min(t,n),e)}class kt extends Vt{constructor(){super(),this.name="Timeline",this._timeline=[];const e=H(kt.getDefaults(),arguments,["memory"]);this.memory=e.memory,this.increasing=e.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(e){if(te(Reflect.has(e,"time"),"Timeline: events must have a time attribute"),e.time=e.time.valueOf(),this.increasing&&this.length){const n=this._timeline[this.length-1];te(Fs(e.time,n.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(e)}else{const n=this._search(e.time);this._timeline.splice(n+1,0,e)}if(this.length>this.memory){const n=this.length-this.memory;this._timeline.splice(0,n)}return this}remove(e){const n=this._timeline.indexOf(e);return n!==-1&&this._timeline.splice(n,1),this}get(e,n="time"){const i=this._search(e,n);return i!==-1?this._timeline[i]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(e,n="time"){const i=this._search(e,n);return i+1<this._timeline.length?this._timeline[i+1]:null}getBefore(e){const n=this._timeline.length;if(n>0&&this._timeline[n-1].time<e)return this._timeline[n-1];const i=this._search(e);return i-1>=0?this._timeline[i-1]:null}cancel(e){if(this._timeline.length>1){let n=this._search(e);if(n>=0)if(ut(this._timeline[n].time,e)){for(let i=n;i>=0&&ut(this._timeline[i].time,e);i--)n=i;this._timeline=this._timeline.slice(0,n)}else this._timeline=this._timeline.slice(0,n+1);else this._timeline=[]}else this._timeline.length===1&&Fs(this._timeline[0].time,e)&&(this._timeline=[]);return this}cancelBefore(e){const n=this._search(e);return n>=0&&(this._timeline=this._timeline.slice(n+1)),this}previousEvent(e){const n=this._timeline.indexOf(e);return n>0?this._timeline[n-1]:null}_search(e,n="time"){if(this._timeline.length===0)return-1;let i=0;const r=this._timeline.length;let s=r;if(r>0&&this._timeline[r-1][n]<=e)return r-1;for(;i<s;){let o=Math.floor(i+(s-i)/2);const a=this._timeline[o],l=this._timeline[o+1];if(ut(a[n],e)){for(let u=o;u<this._timeline.length;u++){const c=this._timeline[u];if(ut(c[n],e))o=u;else break}return o}else{if(su(a[n],e)&&_r(l[n],e))return o;_r(a[n],e)?s=o:i=o+1}}return-1}_iterate(e,n=0,i=this._timeline.length-1){this._timeline.slice(n,i+1).forEach(e)}forEach(e){return this._iterate(e),this}forEachBefore(e,n){const i=this._search(e);return i!==-1&&this._iterate(n,0,i),this}forEachAfter(e,n){const i=this._search(e);return this._iterate(n,i+1),this}forEachBetween(e,n,i){let r=this._search(e),s=this._search(n);return r!==-1&&s!==-1?(this._timeline[r].time!==e&&(r+=1),this._timeline[s].time===n&&(s-=1),this._iterate(i,r,s)):r===-1&&this._iterate(i,0,s),this}forEachFrom(e,n){let i=this._search(e);for(;i>=0&&this._timeline[i].time>=e;)i--;return this._iterate(n,i+1),this}forEachAtTime(e,n){const i=this._search(e);if(i!==-1&&ut(this._timeline[i].time,e)){let r=i;for(let s=i;s>=0&&ut(this._timeline[s].time,e);s--)r=s;this._iterate(s=>{n(s)},r,i)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const ou=[];function Gr(t){ou.push(t)}function N_(t){ou.forEach(e=>e(t))}const au=[];function Zr(t){au.push(t)}function E_(t){au.forEach(e=>e(t))}class Pi extends Vt{constructor(){super(...arguments),this.name="Emitter"}on(e,n){return e.split(/\W+/).forEach(r=>{at(this._events)&&(this._events={}),this._events.hasOwnProperty(r)||(this._events[r]=[]),this._events[r].push(n)}),this}once(e,n){const i=(...r)=>{n(...r),this.off(e,i)};return this.on(e,i),this}off(e,n){return e.split(/\W+/).forEach(r=>{if(at(this._events)&&(this._events={}),this._events.hasOwnProperty(e))if(at(n))this._events[e]=[];else{const s=this._events[e];for(let o=s.length-1;o>=0;o--)s[o]===n&&s.splice(o,1)}}),this}emit(e,...n){if(this._events&&this._events.hasOwnProperty(e)){const i=this._events[e].slice(0);for(let r=0,s=i.length;r<s;r++)i[r].apply(this,n)}return this}static mixin(e){["on","once","off","emit"].forEach(n=>{const i=Object.getOwnPropertyDescriptor(Pi.prototype,n);Object.defineProperty(e.prototype,n,i)})}dispose(){return super.dispose(),this._events=void 0,this}}class lu extends Pi{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class Ri extends lu{constructor(){super(),this.name="Context",this._constants=new Map,this._timeouts=new kt,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;const e=H(Ri.getDefaults(),arguments,["context"]);e.context?this._context=e.context:this._context=S_({latencyHint:e.latencyHint}),this._ticker=new x_(this.emit.bind(this,"tick"),e.clockSource,e.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(e.latencyHint),this.lookAhead=e.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||(N_(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(e,n,i){return this._context.createBuffer(e,n,i)}createChannelMerger(e){return this._context.createChannelMerger(e)}createChannelSplitter(e){return this._context.createChannelSplitter(e)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(e){return this._context.createDelay(e)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(e,n){return this._context.createIIRFilter(e,n)}createPanner(){return this._context.createPanner()}createPeriodicWave(e,n,i){return this._context.createPeriodicWave(e,n,i)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(e){return te(Mn(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(e)}createMediaElementSource(e){return te(Mn(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(e)}createMediaStreamDestination(){return te(Mn(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(e){return this._context.decodeAudioData(e)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(e){te(!this._initialized,"The listener cannot be set after initialization."),this._listener=e}get transport(){return this.initialize(),this._transport}set transport(e){te(!this._initialized,"The transport cannot be set after initialization."),this._transport=e}get draw(){return this.initialize(),this._draw}set draw(e){te(!this._initialized,"Draw cannot be set after initialization."),this._draw=e}get destination(){return this.initialize(),this._destination}set destination(e){te(!this._initialized,"The destination cannot be set after initialization."),this._destination=e}createAudioWorkletNode(e,n){return C_(this.rawContext,e,n)}addAudioWorkletModule(e,n){return Oe(this,void 0,void 0,function*(){te(ae(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(n)||this._workletModules.set(n,this.rawContext.audioWorklet.addModule(e)),yield this._workletModules.get(n)})}workletsAreReady(){return Oe(this,void 0,void 0,function*(){const e=[];this._workletModules.forEach(n=>e.push(n)),yield Promise.all(e)})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(e){this._ticker.updateInterval=e}get clockSource(){return this._ticker.type}set clockSource(e){this._ticker.type=e}get latencyHint(){return this._latencyHint}_setLatencyHint(e){let n=0;if(this._latencyHint=e,bt(e))switch(e){case"interactive":n=.1;break;case"playback":n=.5;break;case"balanced":n=.25;break}this.lookAhead=n,this.updateInterval=n/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return Mn(this._context)?this._context.resume():Promise.resolve()}close(){return Oe(this,void 0,void 0,function*(){Mn(this._context)&&(yield this._context.close()),this._initialized&&E_(this)})}getConstant(e){if(this._constants.has(e))return this._constants.get(e);{const n=this._context.createBuffer(1,128,this._context.sampleRate),i=n.getChannelData(0);for(let s=0;s<i.length;s++)i[s]=e;const r=this._context.createBufferSource();return r.channelCount=1,r.channelCountMode="explicit",r.buffer=n,r.loop=!0,r.start(0),this._constants.set(e,r),r}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(e=>this._constants[e].disconnect()),this}_timeoutLoop(){const e=this.now();let n=this._timeouts.peek();for(;this._timeouts.length&&n&&n.time<=e;)n.callback(),this._timeouts.shift(),n=this._timeouts.peek()}setTimeout(e,n){this._timeoutIds++;const i=this.now();return this._timeouts.add({callback:e,id:this._timeoutIds,time:i+n}),this._timeoutIds}clearTimeout(e){return this._timeouts.forEach(n=>{n.id===e&&this._timeouts.remove(n)}),this}clearInterval(e){return this.clearTimeout(e)}setInterval(e,n){const i=++this._timeoutIds,r=()=>{const s=this.now();this._timeouts.add({callback:()=>{e(),r()},id:i,time:s+n})};return r(),i}}class V_ extends lu{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(e,n,i){return{}}createChannelMerger(e){return{}}createChannelSplitter(e){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(e){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(e,n){return{}}createPanner(){return{}}createPeriodicWave(e,n,i){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(e){return{}}createMediaElementSource(e){return{}}createMediaStreamDestination(){return{}}decodeAudioData(e){return Promise.resolve({})}createAudioWorkletNode(e,n){return{}}get rawContext(){return{}}addAudioWorkletModule(e,n){return Oe(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(e,n){return 0}clearTimeout(e){return this}setInterval(e,n){return 0}clearInterval(e){return this}getConstant(e){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(e){}get destination(){return{}}set destination(e){}now(){return 0}immediate(){return 0}}function Te(t,e){it(e)?e.forEach(n=>Te(t,n)):Object.defineProperty(t,e,{enumerable:!0,writable:!1})}function uu(t,e){it(e)?e.forEach(n=>uu(t,n)):Object.defineProperty(t,e,{writable:!0})}const fe=()=>{};class me extends Vt{constructor(){super(),this.name="ToneAudioBuffer",this.onload=fe;const e=H(me.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=e.reverse,this.onload=e.onload,e.url&&ru(e.url)||e.url instanceof me?this.set(e.url):bt(e.url)&&this.load(e.url).catch(e.onerror)}static getDefaults(){return{onerror:fe,onload:fe,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:ot().sampleRate}set(e){return e instanceof me?e.loaded?this._buffer=e.get():e.onload=()=>{this.set(e),this.onload(this)}:this._buffer=e,this._reversed&&this._reverse(),this}get(){return this._buffer}load(e){return Oe(this,void 0,void 0,function*(){const n=me.load(e).then(i=>{this.set(i),this.onload(this)});me.downloads.push(n);try{yield n}finally{const i=me.downloads.indexOf(n);me.downloads.splice(i,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(e){const n=it(e)&&e[0].length>0,i=n?e.length:1,r=n?e[0].length:e.length,s=ot(),o=s.createBuffer(i,r,s.sampleRate),a=!n&&i===1?[e]:e;for(let l=0;l<i;l++)o.copyToChannel(a[l],l);return this._buffer=o,this}toMono(e){if(Wt(e))this.fromArray(this.toArray(e));else{let n=new Float32Array(this.length);const i=this.numberOfChannels;for(let r=0;r<i;r++){const s=this.toArray(r);for(let o=0;o<s.length;o++)n[o]+=s[o]}n=n.map(r=>r/i),this.fromArray(n)}return this}toArray(e){if(Wt(e))return this.getChannelData(e);if(this.numberOfChannels===1)return this.toArray(0);{const n=[];for(let i=0;i<this.numberOfChannels;i++)n[i]=this.getChannelData(i);return n}}getChannelData(e){return this._buffer?this._buffer.getChannelData(e):new Float32Array(0)}slice(e,n=this.duration){const i=Math.floor(e*this.sampleRate),r=Math.floor(n*this.sampleRate);te(i<r,"The start time must be less than the end time");const s=r-i,o=ot().createBuffer(this.numberOfChannels,s,this.sampleRate);for(let a=0;a<this.numberOfChannels;a++)o.copyToChannel(this.getChannelData(a).subarray(i,r),a);return new me(o)}_reverse(){if(this.loaded)for(let e=0;e<this.numberOfChannels;e++)this.getChannelData(e).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(e){this._reversed!==e&&(this._reversed=e,this._reverse())}static fromArray(e){return new me().fromArray(e)}static fromUrl(e){return Oe(this,void 0,void 0,function*(){return yield new me().load(e)})}static load(e){return Oe(this,void 0,void 0,function*(){const n=e.match(/\[([^\]\[]+\|.+)\]$/);if(n){const a=n[1].split("|");let l=a[0];for(const u of a)if(me.supportsType(u)){l=u;break}e=e.replace(n[0],l)}const i=me.baseUrl===""||me.baseUrl.endsWith("/")?me.baseUrl:me.baseUrl+"/",r=yield fetch(i+e);if(!r.ok)throw new Error(`could not load url: ${e}`);const s=yield r.arrayBuffer();return yield ot().decodeAudioData(s)})}static supportsType(e){const n=e.split("."),i=n[n.length-1];return document.createElement("audio").canPlayType("audio/"+i)!==""}static loaded(){return Oe(this,void 0,void 0,function*(){for(yield Promise.resolve();me.downloads.length;)yield me.downloads[0]})}}me.baseUrl="";me.downloads=[];class uo extends Ri{constructor(){super({clockSource:"offline",context:tr(arguments[0])?arguments[0]:T_(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:tr(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=tr(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(e){return Oe(this,void 0,void 0,function*(){let n=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,n++;const i=Math.floor(this.sampleRate/128);e&&n%i===0&&(yield new Promise(r=>setTimeout(r,1)))}})}render(e=!0){return Oe(this,void 0,void 0,function*(){yield this.workletsAreReady(),yield this._renderClock(e);const n=yield this._context.startRendering();return new me(n)})}close(){return Promise.resolve()}}const cu=new V_;let ii=cu;function ot(){return ii===cu&&k_&&D_(new Ri),ii}function D_(t){Mn(t)?ii=new Ri(t):tr(t)?ii=new uo(t):ii=t}if(rn&&!rn.TONE_SILENCE_LOGGING){const e=` * Tone.js v${cl} * `;console.log(`%c${e}`,"background: #000; color: #fff")}function F_(t){return Math.pow(10,t/20)}function P_(t){return 20*(Math.log(t)/Math.LN10)}function hu(t){return Math.pow(2,t/12)}let Xr=440;function R_(){return Xr}function q_(t){Xr=t}function Kt(t){return Math.round(du(t))}function du(t){return 69+12*Math.log2(t/Xr)}function fu(t){return Xr*Math.pow(2,(t-69)/12)}class co extends Vt{constructor(e,n,i){super(),this.defaultUnits="s",this._val=n,this._units=i,this.context=e,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:e=>this._frequencyToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:e=>this._ticksToUnits(parseInt(e,10)),regexp:/^(\d+)i$/i},m:{method:e=>this._beatsToUnits(parseInt(e,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(e,n)=>{const i=parseInt(e,10),r=n==="."?1.5:1;return i===1?this._beatsToUnits(this._getTimeSignature())*r:this._beatsToUnits(4/i)*r},regexp:/^(\d+)n(\.?)$/i},number:{method:e=>this._expressions[this.defaultUnits].method.call(this,e),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:e=>this._secondsToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:e=>parseInt(e,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:e=>{const n=parseInt(e,10);return this._beatsToUnits(8/(Math.floor(n)*3))},regexp:/^(\d+)t$/i},tr:{method:(e,n,i)=>{let r=0;return e&&e!=="0"&&(r+=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),n&&n!=="0"&&(r+=this._beatsToUnits(parseFloat(n))),i&&i!=="0"&&(r+=this._beatsToUnits(parseFloat(i)/4)),r},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof co&&this.fromType(this._val),at(this._val))return this._noArg();if(bt(this._val)&&at(this._units)){for(const e in this._expressions)if(this._expressions[e].regexp.test(this._val.trim())){this._units=e;break}}else if(nn(this._val)){let e=0;for(const n in this._val)if(ae(this._val[n])){const i=this._val[n];e+=new this.constructor(this.context,n).valueOf()*i}return e}if(ae(this._units)){const e=this._expressions[this._units],n=this._val.toString().trim().match(e.regexp);return n?e.method.apply(this,n.slice(1)):e.method.call(this,this._val)}else return bt(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(e){return 1/e}_beatsToUnits(e){return 60/this._getBpm()*e}_secondsToUnits(e){return e}_ticksToUnits(e){return e*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(e){switch(this._units=void 0,this.defaultUnits){case"s":this._val=e.toSeconds();break;case"i":this._val=e.toTicks();break;case"hz":this._val=e.toFrequency();break;case"midi":this._val=e.toMidi();break}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return this.toSeconds()*1e3}}class dt extends co{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:e=>this._now()+new this.constructor(this.context,e).valueOf(),regexp:/^\+(.+)/},quantize:{method:e=>{const n=new dt(this.context,e).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(n))},regexp:/^@(.+)/}})}quantize(e,n=1){const i=new this.constructor(this.context,e).valueOf(),r=this.valueOf(),a=Math.round(r/i)*i-r;return r+a*n}toNotation(){const e=this.toSeconds(),n=["1m"];for(let s=1;s<9;s++){const o=Math.pow(2,s);n.push(o+"n."),n.push(o+"n"),n.push(o+"t")}n.push("0");let i=n[0],r=new dt(this.context,n[0]).toSeconds();return n.forEach(s=>{const o=new dt(this.context,s).toSeconds();Math.abs(o-e)<Math.abs(r-e)&&(i=s,r=o)}),i}toBarsBeatsSixteenths(){const e=this._beatsToUnits(1);let n=this.valueOf()/e;n=parseFloat(n.toFixed(4));const i=Math.floor(n/this._getTimeSignature());let r=n%1*4;n=Math.floor(n)%this._getTimeSignature();const s=r.toString();return s.length>3&&(r=parseFloat(parseFloat(s).toFixed(3))),[i,n,r].join(":")}toTicks(){const e=this._beatsToUnits(1),n=this.valueOf()/e;return Math.round(n*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return Kt(this.toFrequency())}_now(){return this.context.now()}}class nt extends dt{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return R_()}static set A4(e){q_(e)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(e){return this.defaultUnits==="midi"?e:nt.mtof(e)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(e,n){const r=B_[e.toLowerCase()]+(parseInt(n,10)+1)*12;return this.defaultUnits==="midi"?r:nt.mtof(r)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(e,n,i){let r=1;return e&&e!=="0"&&(r*=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),n&&n!=="0"&&(r*=this._beatsToUnits(parseFloat(n))),i&&i!=="0"&&(r*=this._beatsToUnits(parseFloat(i)/4)),r}}})}transpose(e){return new nt(this.context,this.valueOf()*hu(e))}harmonize(e){return e.map(n=>this.transpose(n))}toMidi(){return Kt(this.valueOf())}toNote(){const e=this.toFrequency(),n=Math.log2(e/nt.A4);let i=Math.round(12*n)+57;const r=Math.floor(i/12);return r<0&&(i+=-12*r),L_[i%12]+r.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const e=this._beatsToUnits(1),n=this.valueOf()/e;return Math.floor(n*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(e){return e}_ticksToUnits(e){return 1/(e*60/(this._getBpm()*this._getPPQ()))}_beatsToUnits(e){return 1/super._beatsToUnits(e)}_secondsToUnits(e){return 1/e}static mtof(e){return fu(e)}static ftom(e){return Kt(e)}}const B_={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},L_=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class ri extends dt{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class Ke extends Vt{constructor(){super();const e=H(Ke.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=e.context}static getDefaults(){return{context:ot()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(e){return new dt(this.context,e).toSeconds()}toFrequency(e){return new nt(this.context,e).toFrequency()}toTicks(e){return new ri(this.context,e).toTicks()}_getPartialProperties(e){const n=this.get();return Object.keys(n).forEach(i=>{at(e[i])&&delete n[i]}),n}get(){const e=O_(this);return Object.keys(e).forEach(n=>{if(Reflect.has(this,n)){const i=this[n];ae(i)&&ae(i.value)&&ae(i.setValueAtTime)?e[n]=i.value:i instanceof Ke?e[n]=i._getPartialProperties(e[n]):it(i)||Wt(i)||bt(i)||w_(i)?e[n]=i:delete e[n]}}),e}set(e){return Object.keys(e).forEach(n=>{Reflect.has(this,n)&&ae(this[n])&&(this[n]&&ae(this[n].value)&&ae(this[n].setValueAtTime)?this[n].value!==e[n]&&(this[n].value=e[n]):this[n]instanceof Ke?this[n].set(e[n]):this[n]=e[n])}),this}}class ho extends kt{constructor(e="stopped"){super(),this.name="StateTimeline",this._initial=e,this.setStateAtTime(this._initial,0)}getValueAtTime(e){const n=this.get(e);return n!==null?n.state:this._initial}setStateAtTime(e,n,i){return Ut(n,0),this.add(Object.assign({},i,{state:e,time:n})),this}getLastState(e,n){const i=this._search(n);for(let r=i;r>=0;r--){const s=this._timeline[r];if(s.state===e)return s}}getNextState(e,n){const i=this._search(n);if(i!==-1)for(let r=i;r<this._timeline.length;r++){const s=this._timeline[r];if(s.state===e)return s}}}class ye extends Ke{constructor(){super(H(ye.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;const e=H(ye.getDefaults(),arguments,["param","units","convert"]);for(te(ae(e.param)&&(un(e.param)||e.param instanceof ye),"param must be an AudioParam");!un(e.param);)e.param=e.param._param;this._swappable=ae(e.swappable)?e.swappable:!1,this._swappable?(this.input=this.context.createGain(),this._param=e.param,this.input.connect(this._param)):this._param=this.input=e.param,this._events=new kt(1e3),this._initialValue=this._param.defaultValue,this.units=e.units,this.convert=e.convert,this._minValue=e.minValue,this._maxValue=e.maxValue,ae(e.value)&&e.value!==this._toType(this._initialValue)&&this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Ke.getDefaults(),{convert:!0,units:"number"})}get value(){const e=this.now();return this.getValueAtTime(e)}set value(e){this.cancelScheduledValues(this.now()),this.setValueAtTime(e,this.now())}get minValue(){return ae(this._minValue)?this._minValue:this.units==="time"||this.units==="frequency"||this.units==="normalRange"||this.units==="positive"||this.units==="transportTime"||this.units==="ticks"||this.units==="bpm"||this.units==="hertz"||this.units==="samples"?0:this.units==="audioRange"?-1:this.units==="decibels"?-1/0:this._param.minValue}get maxValue(){return ae(this._maxValue)?this._maxValue:this.units==="normalRange"||this.units==="audioRange"?1:this._param.maxValue}_is(e,n){return this.units===n}_assertRange(e){return ae(this.maxValue)&&ae(this.minValue)&&Ut(e,this._fromType(this.minValue),this._fromType(this.maxValue)),e}_fromType(e){return this.convert&&!this.overridden?this._is(e,"time")?this.toSeconds(e):this._is(e,"decibels")?F_(e):this._is(e,"frequency")?this.toFrequency(e):e:this.overridden?0:e}_toType(e){return this.convert&&this.units==="decibels"?P_(e):e}setValueAtTime(e,n){const i=this.toSeconds(n),r=this._fromType(e);return te(isFinite(r)&&isFinite(i),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(n)}`),this._assertRange(r),this.log(this.units,"setValueAtTime",e,i),this._events.add({time:i,type:"setValueAtTime",value:r}),this._param.setValueAtTime(r,i),this}getValueAtTime(e){const n=Math.max(this.toSeconds(e),0),i=this._events.getAfter(n),r=this._events.get(n);let s=this._initialValue;if(r===null)s=this._initialValue;else if(r.type==="setTargetAtTime"&&(i===null||i.type==="setValueAtTime")){const o=this._events.getBefore(r.time);let a;o===null?a=this._initialValue:a=o.value,r.type==="setTargetAtTime"&&(s=this._exponentialApproach(r.time,a,r.value,r.constant,n))}else if(i===null)s=r.value;else if(i.type==="linearRampToValueAtTime"||i.type==="exponentialRampToValueAtTime"){let o=r.value;if(r.type==="setTargetAtTime"){const a=this._events.getBefore(r.time);a===null?o=this._initialValue:o=a.value}i.type==="linearRampToValueAtTime"?s=this._linearInterpolate(r.time,o,i.time,i.value,n):s=this._exponentialInterpolate(r.time,o,i.time,i.value,n)}else s=r.value;return this._toType(s)}setRampPoint(e){e=this.toSeconds(e);let n=this.getValueAtTime(e);return this.cancelAndHoldAtTime(e),this._fromType(n)===0&&(n=this._toType(this._minOutput)),this.setValueAtTime(n,e),this}linearRampToValueAtTime(e,n){const i=this._fromType(e),r=this.toSeconds(n);return te(isFinite(i)&&isFinite(r),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(n)}`),this._assertRange(i),this._events.add({time:r,type:"linearRampToValueAtTime",value:i}),this.log(this.units,"linearRampToValueAtTime",e,r),this._param.linearRampToValueAtTime(i,r),this}exponentialRampToValueAtTime(e,n){let i=this._fromType(e);i=ut(i,0)?this._minOutput:i,this._assertRange(i);const r=this.toSeconds(n);return te(isFinite(i)&&isFinite(r),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(n)}`),this._events.add({time:r,type:"exponentialRampToValueAtTime",value:i}),this.log(this.units,"exponentialRampToValueAtTime",e,r),this._param.exponentialRampToValueAtTime(i,r),this}exponentialRampTo(e,n,i){return i=this.toSeconds(i),this.setRampPoint(i),this.exponentialRampToValueAtTime(e,i+this.toSeconds(n)),this}linearRampTo(e,n,i){return i=this.toSeconds(i),this.setRampPoint(i),this.linearRampToValueAtTime(e,i+this.toSeconds(n)),this}targetRampTo(e,n,i){return i=this.toSeconds(i),this.setRampPoint(i),this.exponentialApproachValueAtTime(e,i,n),this}exponentialApproachValueAtTime(e,n,i){n=this.toSeconds(n),i=this.toSeconds(i);const r=Math.log(i+1)/Math.log(200);return this.setTargetAtTime(e,n,r),this.cancelAndHoldAtTime(n+i*.9),this.linearRampToValueAtTime(e,n+i),this}setTargetAtTime(e,n,i){const r=this._fromType(e);te(isFinite(i)&&i>0,"timeConstant must be a number greater than 0");const s=this.toSeconds(n);return this._assertRange(r),te(isFinite(r)&&isFinite(s),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(e)}, ${JSON.stringify(n)}`),this._events.add({constant:i,time:s,type:"setTargetAtTime",value:r}),this.log(this.units,"setTargetAtTime",e,s,i),this._param.setTargetAtTime(r,s,i),this}setValueCurveAtTime(e,n,i,r=1){i=this.toSeconds(i),n=this.toSeconds(n);const s=this._fromType(e[0])*r;this.setValueAtTime(this._toType(s),n);const o=i/(e.length-1);for(let a=1;a<e.length;a++){const l=this._fromType(e[a])*r;this.linearRampToValueAtTime(this._toType(l),n+a*o)}return this}cancelScheduledValues(e){const n=this.toSeconds(e);return te(isFinite(n),`Invalid argument to cancelScheduledValues: ${JSON.stringify(e)}`),this._events.cancel(n),this._param.cancelScheduledValues(n),this.log(this.units,"cancelScheduledValues",n),this}cancelAndHoldAtTime(e){const n=this.toSeconds(e),i=this._fromType(this.getValueAtTime(n));te(isFinite(n),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(e)}`),this.log(this.units,"cancelAndHoldAtTime",n,"value="+i);const r=this._events.get(n),s=this._events.getAfter(n);return r&&ut(r.time,n)?s?(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time)):(this._param.cancelAndHoldAtTime(n),this._events.cancel(n+this.sampleTime)):s&&(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time),s.type==="linearRampToValueAtTime"?this.linearRampToValueAtTime(this._toType(i),n):s.type==="exponentialRampToValueAtTime"&&this.exponentialRampToValueAtTime(this._toType(i),n)),this._events.add({time:n,type:"setValueAtTime",value:i}),this._param.setValueAtTime(i,n),this}rampTo(e,n=.1,i){return this.units==="frequency"||this.units==="bpm"||this.units==="decibels"?this.exponentialRampTo(e,n,i):this.linearRampTo(e,n,i),this}apply(e){const n=this.context.currentTime;e.setValueAtTime(this.getValueAtTime(n),n);const i=this._events.get(n);if(i&&i.type==="setTargetAtTime"){const r=this._events.getAfter(i.time),s=r?r.time:n+2,o=(s-n)/10;for(let a=n;a<s;a+=o)e.linearRampToValueAtTime(this.getValueAtTime(a),a)}return this._events.forEachAfter(this.context.currentTime,r=>{r.type==="cancelScheduledValues"?e.cancelScheduledValues(r.time):r.type==="setTargetAtTime"?e.setTargetAtTime(r.value,r.time,r.constant):e[r.type](r.value,r.time)}),this}setParam(e){te(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const n=this.input;return n.disconnect(this._param),this.apply(e),this._param=e,n.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(e,n,i,r,s){return i+(n-i)*Math.exp(-(s-e)/r)}_linearInterpolate(e,n,i,r,s){return n+(r-n)*((s-e)/(i-e))}_exponentialInterpolate(e,n,i,r,s){return n*Math.pow(r/n,(s-e)/(i-e))}}class oe extends Ke{constructor(){super(...arguments),this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return ae(this.input)?un(this.input)||this.input instanceof ye?1:this.input.numberOfInputs:0}get numberOfOutputs(){return ae(this.output)?this.output.numberOfOutputs:0}_isAudioNode(e){return ae(e)&&(e instanceof oe||jt(e))}_getInternalNodes(){const e=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&e.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&e.push(this.output),e}_setChannelProperties(e){this._getInternalNodes().forEach(i=>{i.channelCount=e.channelCount,i.channelCountMode=e.channelCountMode,i.channelInterpretation=e.channelInterpretation})}_getChannelProperties(){const e=this._getInternalNodes();te(e.length>0,"ToneAudioNode does not have any internal nodes");const n=e[0];return{channelCount:n.channelCount,channelCountMode:n.channelCountMode,channelInterpretation:n.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(e){const n=this._getChannelProperties();this._setChannelProperties(Object.assign(n,{channelCount:e}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(e){const n=this._getChannelProperties();this._setChannelProperties(Object.assign(n,{channelCountMode:e}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(e){const n=this._getChannelProperties();this._setChannelProperties(Object.assign(n,{channelInterpretation:e}))}connect(e,n=0,i=0){return Zn(this,e,n,i),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return ao("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(e,n=0,i=0){return j_(this,e,n,i),this}chain(...e){return Ps(this,...e),this}fan(...e){return e.forEach(n=>this.connect(n)),this}dispose(){return super.dispose(),ae(this.input)&&(this.input instanceof oe?this.input.dispose():jt(this.input)&&this.input.disconnect()),ae(this.output)&&(this.output instanceof oe?this.output.dispose():jt(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function Ps(...t){const e=t.shift();t.reduce((n,i)=>(n instanceof oe?n.connect(i):jt(n)&&Zn(n,i),i),e)}function Zn(t,e,n=0,i=0){for(te(ae(t),"Cannot connect from undefined node"),te(ae(e),"Cannot connect to undefined node"),(e instanceof oe||jt(e))&&te(e.numberOfInputs>0,"Cannot connect to node with no inputs"),te(t.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof oe||e instanceof ye;)ae(e.input)&&(e=e.input);for(;t instanceof oe;)ae(t.output)&&(t=t.output);un(e)?t.connect(e,n):t.connect(e,n,i)}function j_(t,e,n=0,i=0){if(ae(e))for(;e instanceof oe;)e=e.input;for(;!jt(t);)ae(t.output)&&(t=t.output);un(e)?t.disconnect(e,n):jt(e)?t.disconnect(e,n,i):t.disconnect()}class Ge extends oe{constructor(){super(H(Ge.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;const e=H(Ge.getDefaults(),arguments,["gain","units"]);this.gain=new ye({context:this.context,convert:e.convert,param:this._gainNode.gain,units:e.units,value:e.gain,minValue:e.minValue,maxValue:e.maxValue}),Te(this,"gain")}static getDefaults(){return Object.assign(oe.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class qn extends oe{constructor(e){super(e),this.onended=fe,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new Ge({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(n){const i=this.toSeconds(n);return this._startTime!==-1&&i>=this._startTime&&(this._stopTime===-1||i<=this._stopTime)?"started":"stopped"},this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut,this._curve=e.curve,this.onended=e.onended}static getDefaults(){return Object.assign(oe.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:fe})}_startGain(e,n=1){te(this._startTime===-1,"Source cannot be started more than once");const i=this.toSeconds(this._fadeIn);return this._startTime=e+i,this._startTime=Math.max(this._startTime,this.context.currentTime),i>0?(this._gainNode.gain.setValueAtTime(0,e),this._curve==="linear"?this._gainNode.gain.linearRampToValueAtTime(n,e+i):this._gainNode.gain.exponentialApproachValueAtTime(n,e,i)):this._gainNode.gain.setValueAtTime(n,e),this}stop(e){return this.log("stop",e),this._stopGain(this.toSeconds(e)),this}_stopGain(e){te(this._startTime!==-1,"'start' must be called before 'stop'"),this.cancelStop();const n=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(e)+n,this._stopTime=Math.max(this._stopTime,this.context.currentTime),n>0?this._curve==="linear"?this._gainNode.gain.linearRampTo(0,n,e):this._gainNode.gain.targetRampTo(0,n,e):(this._gainNode.gain.cancelAndHoldAtTime(e),this._gainNode.gain.setValueAtTime(0,e)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const i=this._curve==="exponential"?n*2:0;this._stopSource(this.now()+i),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==fe&&(this.onended(this),this.onended=fe,!this.context.isOffline)){const e=()=>this.dispose();typeof window.requestIdleCallback!="undefined"?window.requestIdleCallback(e):setTimeout(e,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),te(this._startTime!==-1,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}}class yr extends qn{constructor(){super(H(yr.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();const e=H(yr.getDefaults(),arguments,["offset"]);Zn(this._source,this._gainNode),this.offset=new ye({context:this.context,convert:e.convert,param:this._source.offset,units:e.units,value:e.offset,minValue:e.minValue,maxValue:e.maxValue})}static getDefaults(){return Object.assign(qn.getDefaults(),{convert:!0,offset:1,units:"number"})}start(e){const n=this.toSeconds(e);return this.log("start",n),this._startGain(n),this._source.start(n),this}_stopSource(e){this._source.stop(e)}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class Pe extends oe{constructor(){super(H(Pe.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;const e=H(Pe.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new yr({context:this.context,convert:e.convert,offset:e.value,units:e.units,minValue:e.minValue,maxValue:e.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(oe.getDefaults(),{convert:!0,units:"number",value:0})}connect(e,n=0,i=0){return fo(this,e,n,i),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(e,n){return this._param.setValueAtTime(e,n),this}getValueAtTime(e){return this._param.getValueAtTime(e)}setRampPoint(e){return this._param.setRampPoint(e),this}linearRampToValueAtTime(e,n){return this._param.linearRampToValueAtTime(e,n),this}exponentialRampToValueAtTime(e,n){return this._param.exponentialRampToValueAtTime(e,n),this}exponentialRampTo(e,n,i){return this._param.exponentialRampTo(e,n,i),this}linearRampTo(e,n,i){return this._param.linearRampTo(e,n,i),this}targetRampTo(e,n,i){return this._param.targetRampTo(e,n,i),this}exponentialApproachValueAtTime(e,n,i){return this._param.exponentialApproachValueAtTime(e,n,i),this}setTargetAtTime(e,n,i){return this._param.setTargetAtTime(e,n,i),this}setValueCurveAtTime(e,n,i,r){return this._param.setValueCurveAtTime(e,n,i,r),this}cancelScheduledValues(e){return this._param.cancelScheduledValues(e),this}cancelAndHoldAtTime(e){return this._param.cancelAndHoldAtTime(e),this}rampTo(e,n,i){return this._param.rampTo(e,n,i),this}get value(){return this._param.value}set value(e){this._param.value=e}get convert(){return this._param.convert}set convert(e){this._param.convert=e}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(e){this._param.overridden=e}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(e){return this._param.apply(e),this}}function fo(t,e,n,i){(e instanceof ye||un(e)||e instanceof Pe&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof Pe&&(e.overridden=!0)),Zn(t,e,n,i)}class br extends ye{constructor(){super(H(br.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new kt(1/0),this._multiplier=1;const e=H(br.getDefaults(),arguments,["value"]);this._multiplier=e.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(e.value)}),this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(ye.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(e,n,i){n=this.toSeconds(n),this.setRampPoint(n);const r=this._fromType(e),s=this._events.get(n),o=Math.round(Math.max(1/i,1));for(let a=0;a<=o;a++){const l=i*a+n,u=this._exponentialApproach(s.time,s.value,r,i,l);this.linearRampToValueAtTime(this._toType(u),l)}return this}setValueAtTime(e,n){const i=this.toSeconds(n);super.setValueAtTime(e,n);const r=this._events.get(i),s=this._events.previousEvent(r),o=this._getTicksUntilEvent(s,i);return r.ticks=Math.max(o,0),this}linearRampToValueAtTime(e,n){const i=this.toSeconds(n);super.linearRampToValueAtTime(e,n);const r=this._events.get(i),s=this._events.previousEvent(r),o=this._getTicksUntilEvent(s,i);return r.ticks=Math.max(o,0),this}exponentialRampToValueAtTime(e,n){n=this.toSeconds(n);const i=this._fromType(e),r=this._events.get(n),s=Math.round(Math.max((n-r.time)*10,1)),o=(n-r.time)/s;for(let a=0;a<=s;a++){const l=o*a+r.time,u=this._exponentialInterpolate(r.time,r.value,n,i,l);this.linearRampToValueAtTime(this._toType(u),l)}return this}_getTicksUntilEvent(e,n){if(e===null)e={ticks:0,time:0,type:"setValueAtTime",value:0};else if(at(e.ticks)){const o=this._events.previousEvent(e);e.ticks=this._getTicksUntilEvent(o,e.time)}const i=this._fromType(this.getValueAtTime(e.time));let r=this._fromType(this.getValueAtTime(n));const s=this._events.get(n);return s&&s.time===n&&s.type==="setValueAtTime"&&(r=this._fromType(this.getValueAtTime(n-this.sampleTime))),.5*(n-e.time)*(i+r)+e.ticks}getTicksAtTime(e){const n=this.toSeconds(e),i=this._events.get(n);return Math.max(this._getTicksUntilEvent(i,n),0)}getDurationOfTicks(e,n){const i=this.toSeconds(n),r=this.getTicksAtTime(n);return this.getTimeOfTick(r+e)-i}getTimeOfTick(e){const n=this._events.get(e,"ticks"),i=this._events.getAfter(e,"ticks");if(n&&n.ticks===e)return n.time;if(n&&i&&i.type==="linearRampToValueAtTime"&&n.value!==i.value){const r=this._fromType(this.getValueAtTime(n.time)),o=(this._fromType(this.getValueAtTime(i.time))-r)/(i.time-n.time),a=Math.sqrt(Math.pow(r,2)-2*o*(n.ticks-e)),l=(-r+a)/o,u=(-r-a)/o;return(l>0?l:u)+n.time}else return n?n.value===0?1/0:n.time+(e-n.ticks)/n.value:e/this._initialValue}ticksToTime(e,n){return this.getDurationOfTicks(e,n)}timeToTicks(e,n){const i=this.toSeconds(n),r=this.toSeconds(e),s=this.getTicksAtTime(i);return this.getTicksAtTime(i+r)-s}_fromType(e){return this.units==="bpm"&&this.multiplier?1/(60/e/this.multiplier):super._fromType(e)}_toType(e){return this.units==="bpm"&&this.multiplier?e/this.multiplier*60:super._toType(e)}get multiplier(){return this._multiplier}set multiplier(e){const n=this.value;this._multiplier=e,this.cancelScheduledValues(0),this.setValueAtTime(n,0)}}class wr extends Pe{constructor(){super(H(wr.getDefaults(),arguments,["value"])),this.name="TickSignal";const e=H(wr.getDefaults(),arguments,["value"]);this.input=this._param=new br({context:this.context,convert:e.convert,multiplier:e.multiplier,param:this._constantSource.offset,units:e.units,value:e.value})}static getDefaults(){return Object.assign(Pe.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(e,n){return this._param.ticksToTime(e,n)}timeToTicks(e,n){return this._param.timeToTicks(e,n)}getTimeOfTick(e){return this._param.getTimeOfTick(e)}getDurationOfTicks(e,n){return this._param.getDurationOfTicks(e,n)}getTicksAtTime(e){return this._param.getTicksAtTime(e)}get multiplier(){return this._param.multiplier}set multiplier(e){this._param.multiplier=e}dispose(){return super.dispose(),this._param.dispose(),this}}class Sr extends Ke{constructor(){super(H(Sr.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new ho,this._tickOffset=new kt;const e=H(Sr.getDefaults(),arguments,["frequency"]);this.frequency=new wr({context:this.context,units:e.units,value:e.frequency}),Te(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},Ke.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(e,n){const i=this.toSeconds(e);return this._state.getValueAtTime(i)!=="started"&&(this._state.setStateAtTime("started",i),ae(n)&&this.setTicksAtTime(n,i)),this}stop(e){const n=this.toSeconds(e);if(this._state.getValueAtTime(n)==="stopped"){const i=this._state.get(n);i&&i.time>0&&(this._tickOffset.cancel(i.time),this._state.cancel(i.time))}return this._state.cancel(n),this._state.setStateAtTime("stopped",n),this.setTicksAtTime(0,n),this}pause(e){const n=this.toSeconds(e);return this._state.getValueAtTime(n)==="started"&&this._state.setStateAtTime("paused",n),this}cancel(e){return e=this.toSeconds(e),this._state.cancel(e),this._tickOffset.cancel(e),this}getTicksAtTime(e){const n=this.toSeconds(e),i=this._state.getLastState("stopped",n),r={state:"paused",time:n};this._state.add(r);let s=i,o=0;return this._state.forEachBetween(i.time,n+this.sampleTime,a=>{let l=s.time;const u=this._tickOffset.get(a.time);u&&u.time>=s.time&&(o=u.ticks,l=u.time),s.state==="started"&&a.state!=="started"&&(o+=this.frequency.getTicksAtTime(a.time)-this.frequency.getTicksAtTime(l)),s=a}),this._state.remove(r),o}get ticks(){return this.getTicksAtTime(this.now())}set ticks(e){this.setTicksAtTime(e,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(e){const n=this.now(),i=this.frequency.timeToTicks(e,n);this.setTicksAtTime(i,n)}getSecondsAtTime(e){e=this.toSeconds(e);const n=this._state.getLastState("stopped",e),i={state:"paused",time:e};this._state.add(i);let r=n,s=0;return this._state.forEachBetween(n.time,e+this.sampleTime,o=>{let a=r.time;const l=this._tickOffset.get(o.time);l&&l.time>=r.time&&(s=l.seconds,a=l.time),r.state==="started"&&o.state!=="started"&&(s+=o.time-a),r=o}),this._state.remove(i),s}setTicksAtTime(e,n){return n=this.toSeconds(n),this._tickOffset.cancel(n),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(e,n),ticks:e,time:n}),this}getStateAtTime(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)}getTimeOfTick(e,n=this.now()){const i=this._tickOffset.get(n),r=this._state.get(n),s=Math.max(i.time,r.time),o=this.frequency.getTicksAtTime(s)+e-i.ticks;return this.frequency.getTimeOfTick(o)}forEachTickBetween(e,n,i){let r=this._state.get(e);this._state.forEachBetween(e,n,o=>{r&&r.state==="started"&&o.state!=="started"&&this.forEachTickBetween(Math.max(r.time,e),o.time-this.sampleTime,i),r=o});let s=null;if(r&&r.state==="started"){const o=Math.max(r.time,e),a=this.frequency.getTicksAtTime(o),l=this.frequency.getTicksAtTime(r.time),u=a-l;let c=Math.ceil(u)-u;c=ut(c,1)?0:c;let h=this.frequency.getTimeOfTick(a+c);for(;h<n;){try{i(h,Math.round(this.getTicksAtTime(h)))}catch(f){s=f;break}h+=this.frequency.getDurationOfTicks(1,h)}}if(s)throw s;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}class di extends Ke{constructor(){super(H(di.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=fe,this._lastUpdate=0,this._state=new ho("stopped"),this._boundLoop=this._loop.bind(this);const e=H(di.getDefaults(),arguments,["callback","frequency"]);this.callback=e.callback,this._tickSource=new Sr({context:this.context,frequency:e.frequency,units:e.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,Te(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(Ke.getDefaults(),{callback:fe,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(e,n){nu(this.context);const i=this.toSeconds(e);return this.log("start",i),this._state.getValueAtTime(i)!=="started"&&(this._state.setStateAtTime("started",i),this._tickSource.start(i,n),i<this._lastUpdate&&this.emit("start",i,n)),this}stop(e){const n=this.toSeconds(e);return this.log("stop",n),this._state.cancel(n),this._state.setStateAtTime("stopped",n),this._tickSource.stop(n),n<this._lastUpdate&&this.emit("stop",n),this}pause(e){const n=this.toSeconds(e);return this._state.getValueAtTime(n)==="started"&&(this._state.setStateAtTime("paused",n),this._tickSource.pause(n),n<this._lastUpdate&&this.emit("pause",n)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(e){this._tickSource.ticks=e}get seconds(){return this._tickSource.seconds}set seconds(e){this._tickSource.seconds=e}getSecondsAtTime(e){return this._tickSource.getSecondsAtTime(e)}setTicksAtTime(e,n){return this._tickSource.setTicksAtTime(e,n),this}getTimeOfTick(e,n=this.now()){return this._tickSource.getTimeOfTick(e,n)}getTicksAtTime(e){return this._tickSource.getTicksAtTime(e)}nextTickTime(e,n){const i=this.toSeconds(n),r=this.getTicksAtTime(i);return this._tickSource.getTimeOfTick(r+e,i)}_loop(){const e=this._lastUpdate,n=this.now();this._lastUpdate=n,this.log("loop",e,n),e!==n&&(this._state.forEachBetween(e,n,i=>{switch(i.state){case"started":const r=this._tickSource.getTicksAtTime(i.time);this.emit("start",i.time,r);break;case"stopped":i.time!==0&&this.emit("stop",i.time);break;case"paused":this.emit("pause",i.time);break}}),this._tickSource.forEachTickBetween(e,n,(i,r)=>{this.callback(i,r)}))}getStateAtTime(e){const n=this.toSeconds(e);return this._state.getValueAtTime(n)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}Pi.mixin(di);class po extends Vt{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const e=H(po.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=e.baseUrl,Object.keys(e.urls).forEach(n=>{this._loadingCount++;const i=e.urls[n];this.add(n,i,this._bufferLoaded.bind(this,e.onload),e.onerror)})}static getDefaults(){return{baseUrl:"",onerror:fe,onload:fe,urls:{}}}has(e){return this._buffers.has(e.toString())}get(e){return te(this.has(e),`ToneAudioBuffers has no buffer named: ${e}`),this._buffers.get(e.toString())}_bufferLoaded(e){this._loadingCount--,this._loadingCount===0&&e&&e()}get loaded(){return Array.from(this._buffers).every(([e,n])=>n.loaded)}add(e,n,i=fe,r=fe){return bt(n)?this._buffers.set(e.toString(),new me(this.baseUrl+n,i,r)):this._buffers.set(e.toString(),new me(n,i,r)),this}dispose(){return super.dispose(),this._buffers.forEach(e=>e.dispose()),this._buffers.clear(),this}}class Tr extends nt{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(e){return Kt(super._frequencyToUnits(e))}_ticksToUnits(e){return Kt(super._ticksToUnits(e))}_beatsToUnits(e){return Kt(super._beatsToUnits(e))}_secondsToUnits(e){return Kt(super._secondsToUnits(e))}toMidi(){return this.valueOf()}toFrequency(){return fu(this.toMidi())}transpose(e){return new Tr(this.context,this.toMidi()+e)}}class It extends ri{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(e){return this._getPPQ()*e}_secondsToUnits(e){return Math.floor(e/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(e){return e}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class U_ extends Ke{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new kt,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(e,n){return this._events.add({callback:e,time:this.toSeconds(n)}),this._events.length===1&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(e){return this._events.cancel(this.toSeconds(e)),this}_drawLoop(){const e=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=e;){const n=this._events.shift();n&&e-n.time<=this.expiration&&n.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}Gr(t=>{t.draw=new U_({context:t})});Zr(t=>{t.draw.dispose()});class W_ extends Vt{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(e){te(ae(e.time),"Events must have a time property"),te(ae(e.duration),"Events must have a duration parameter"),e.time=e.time.valueOf();let n=new $_(e.time,e.time+e.duration,e);for(this._root===null?this._root=n:this._root.insert(n),this._length++;n!==null;)n.updateHeight(),n.updateMax(),this._rebalance(n),n=n.parent;return this}remove(e){if(this._root!==null){const n=[];this._root.search(e.time,n);for(const i of n)if(i.event===e){this._removeNode(i),this._length--;break}}return this}get length(){return this._length}cancel(e){return this.forEachFrom(e,n=>this.remove(n)),this}_setRoot(e){this._root=e,this._root!==null&&(this._root.parent=null)}_replaceNodeInParent(e,n){e.parent!==null?(e.isLeftChild()?e.parent.left=n:e.parent.right=n,this._rebalance(e.parent)):this._setRoot(n)}_removeNode(e){if(e.left===null&&e.right===null)this._replaceNodeInParent(e,null);else if(e.right===null)this._replaceNodeInParent(e,e.left);else if(e.left===null)this._replaceNodeInParent(e,e.right);else{const n=e.getBalance();let i,r=null;if(n>0)if(e.left.right===null)i=e.left,i.right=e.right,r=i;else{for(i=e.left.right;i.right!==null;)i=i.right;i.parent&&(i.parent.right=i.left,r=i.parent,i.left=e.left,i.right=e.right)}else if(e.right.left===null)i=e.right,i.left=e.left,r=i;else{for(i=e.right.left;i.left!==null;)i=i.left;i.parent&&(i.parent.left=i.right,r=i.parent,i.left=e.left,i.right=e.right)}e.parent!==null?e.isLeftChild()?e.parent.left=i:e.parent.right=i:this._setRoot(i),r&&this._rebalance(r)}e.dispose()}_rotateLeft(e){const n=e.parent,i=e.isLeftChild(),r=e.right;r&&(e.right=r.left,r.left=e),n!==null?i?n.left=r:n.right=r:this._setRoot(r)}_rotateRight(e){const n=e.parent,i=e.isLeftChild(),r=e.left;r&&(e.left=r.right,r.right=e),n!==null?i?n.left=r:n.right=r:this._setRoot(r)}_rebalance(e){const n=e.getBalance();n>1&&e.left?e.left.getBalance()<0?this._rotateLeft(e.left):this._rotateRight(e):n<-1&&e.right&&(e.right.getBalance()>0?this._rotateRight(e.right):this._rotateLeft(e))}get(e){if(this._root!==null){const n=[];if(this._root.search(e,n),n.length>0){let i=n[0];for(let r=1;r<n.length;r++)n[r].low>i.low&&(i=n[r]);return i.event}}return null}forEach(e){if(this._root!==null){const n=[];this._root.traverse(i=>n.push(i)),n.forEach(i=>{i.event&&e(i.event)})}return this}forEachAtTime(e,n){if(this._root!==null){const i=[];this._root.search(e,i),i.forEach(r=>{r.event&&n(r.event)})}return this}forEachFrom(e,n){if(this._root!==null){const i=[];this._root.searchAfter(e,i),i.forEach(r=>{r.event&&n(r.event)})}return this}dispose(){return super.dispose(),this._root!==null&&this._root.traverse(e=>e.dispose()),this._root=null,this}}class $_{constructor(e,n,i){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=i,this.low=e,this.high=n,this.max=this.high}insert(e){e.low<=this.low?this.left===null?this.left=e:this.left.insert(e):this.right===null?this.right=e:this.right.insert(e)}search(e,n){e>this.max||(this.left!==null&&this.left.search(e,n),this.low<=e&&this.high>e&&n.push(this),!(this.low>e)&&this.right!==null&&this.right.search(e,n))}searchAfter(e,n){this.low>=e&&(n.push(this),this.left!==null&&this.left.searchAfter(e,n)),this.right!==null&&this.right.searchAfter(e,n)}traverse(e){e(this),this.left!==null&&this.left.traverse(e),this.right!==null&&this.right.traverse(e)}updateHeight(){this.left!==null&&this.right!==null?this.height=Math.max(this.left.height,this.right.height)+1:this.right!==null?this.height=this.right.height+1:this.left!==null?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,this.left!==null&&(this.max=Math.max(this.max,this.left.max)),this.right!==null&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let e=0;return this.left!==null&&this.right!==null?e=this.left.height-this.right.height:this.left!==null?e=this.left.height+1:this.right!==null&&(e=-(this.right.height+1)),e}isLeftChild(){return this.parent!==null&&this.parent.left===this}get left(){return this._left}set left(e){this._left=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(e){this._right=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class cn extends oe{constructor(){super(H(cn.getDefaults(),arguments,["volume"])),this.name="Volume";const e=H(cn.getDefaults(),arguments,["volume"]);this.input=this.output=new Ge({context:this.context,gain:e.volume,units:"decibels"}),this.volume=this.output.gain,Te(this,"volume"),this._unmutedVolume=e.volume,this.mute=e.mute}static getDefaults(){return Object.assign(oe.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(e){!this.mute&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!e&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class kr extends oe{constructor(){super(H(kr.getDefaults(),arguments)),this.name="Destination",this.input=new cn({context:this.context}),this.output=new Ge({context:this.context}),this.volume=this.input.volume;const e=H(kr.getDefaults(),arguments);Ps(this.input,this.output,this.context.rawContext.destination),this.mute=e.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(oe.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(e){this.input.mute=e}chain(...e){return this.input.disconnect(),e.unshift(this.input),e.push(this.output),Ps(...e),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}Gr(t=>{t.destination=new kr({context:t})});Zr(t=>{t.destination.dispose()});class z_ extends Vt{constructor(e){super(),this.name="TimelineValue",this._timeline=new kt({memory:10}),this._initialValue=e}set(e,n){return this._timeline.add({value:e,time:n}),this}get(e){const n=this._timeline.get(e);return n?n.value:this._initialValue}}class $t{constructor(e,n){this.id=$t._eventId++;const i=Object.assign($t.getDefaults(),n);this.transport=e,this.callback=i.callback,this._once=i.once,this.time=i.time}static getDefaults(){return{callback:fe,once:!1,time:0}}invoke(e){this.callback&&(this.callback(e),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}}$t._eventId=0;class mo extends $t{constructor(e,n){super(e,n),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const i=Object.assign(mo.getDefaults(),n);this.duration=new It(e.context,i.duration).valueOf(),this._interval=new It(e.context,i.interval).valueOf(),this._nextTick=i.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},$t.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(e){this._createEvents(e),super.invoke(e)}_createEvents(e){const n=this.transport.getTicksAtTime(e);n>=this.time&&n>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new It(this.context,this._nextTick).toSeconds()))}_restart(e){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;const n=this.transport.getTicksAtTime(e);n>this.time&&(this._nextTick=this.time+Math.ceil((n-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new It(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new It(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}}class fi extends Ke{constructor(){super(H(fi.getDefaults(),arguments)),this.name="Transport",this._loop=new z_(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new kt,this._repeatedEvents=new W_,this._syncedSignals=[],this._swingAmount=0;const e=H(fi.getDefaults(),arguments);this._ppq=e.ppq,this._clock=new di({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=e.ppq,this.bpm.setValueAtTime(e.bpm,0),Te(this,"bpm"),this._timeSignature=e.timeSignature,this._swingTicks=e.ppq/2}static getDefaults(){return Object.assign(Ke.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(e,n){if(this._loop.get(e)&&n>=this._loopEnd&&(this.emit("loopEnd",e),this._clock.setTicksAtTime(this._loopStart,e),n=this._loopStart,this.emit("loopStart",e,this._clock.getSecondsAtTime(e)),this.emit("loop",e)),this._swingAmount>0&&n%this._ppq!==0&&n%(this._swingTicks*2)!==0){const i=n%(this._swingTicks*2)/(this._swingTicks*2),r=Math.sin(i*Math.PI)*this._swingAmount;e+=new It(this.context,this._swingTicks*2/3).toSeconds()*r}this._timeline.forEachAtTime(n,i=>i.invoke(e))}schedule(e,n){const i=new $t(this,{callback:e,time:new ri(this.context,n).toTicks()});return this._addEvent(i,this._timeline)}scheduleRepeat(e,n,i,r=1/0){const s=new mo(this,{callback:e,duration:new dt(this.context,r).toTicks(),interval:new dt(this.context,n).toTicks(),time:new ri(this.context,i).toTicks()});return this._addEvent(s,this._repeatedEvents)}scheduleOnce(e,n){const i=new $t(this,{callback:e,once:!0,time:new ri(this.context,n).toTicks()});return this._addEvent(i,this._timeline)}clear(e){if(this._scheduledEvents.hasOwnProperty(e)){const n=this._scheduledEvents[e.toString()];n.timeline.remove(n.event),n.event.dispose(),delete this._scheduledEvents[e.toString()]}return this}_addEvent(e,n){return this._scheduledEvents[e.id.toString()]={event:e,timeline:n},n.add(e),e.id}cancel(e=0){const n=this.toTicks(e);return this._timeline.forEachFrom(n,i=>this.clear(i.id)),this._repeatedEvents.forEachFrom(n,i=>this.clear(i.id)),this}_bindClockEvents(){this._clock.on("start",(e,n)=>{n=new It(this.context,n).toSeconds(),this.emit("start",e,n)}),this._clock.on("stop",e=>{this.emit("stop",e)}),this._clock.on("pause",e=>{this.emit("pause",e)})}get state(){return this._clock.getStateAtTime(this.now())}start(e,n){let i;return ae(n)&&(i=this.toTicks(n)),this._clock.start(e,i),this}stop(e){return this._clock.stop(e),this}pause(e){return this._clock.pause(e),this}toggle(e){return e=this.toSeconds(e),this._clock.getStateAtTime(e)!=="started"?this.start(e):this.stop(e),this}get timeSignature(){return this._timeSignature}set timeSignature(e){it(e)&&(e=e[0]/e[1]*4),this._timeSignature=e}get loopStart(){return new dt(this.context,this._loopStart,"i").toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e)}get loopEnd(){return new dt(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e)}get loop(){return this._loop.get(this.now())}set loop(e){this._loop.set(e,this.now())}setLoopPoints(e,n){return this.loopStart=e,this.loopEnd=n,this}get swing(){return this._swingAmount}set swing(e){this._swingAmount=e}get swingSubdivision(){return new It(this.context,this._swingTicks).toNotation()}set swingSubdivision(e){this._swingTicks=this.toTicks(e)}get position(){const e=this.now(),n=this._clock.getTicksAtTime(e);return new It(this.context,n).toBarsBeatsSixteenths()}set position(e){const n=this.toTicks(e);this.ticks=n}get seconds(){return this._clock.seconds}set seconds(e){const n=this.now(),i=this._clock.frequency.timeToTicks(e,n);this.ticks=i}get progress(){if(this.loop){const e=this.now();return(this._clock.getTicksAtTime(e)-this._loopStart)/(this._loopEnd-this._loopStart)}else return 0}get ticks(){return this._clock.ticks}set ticks(e){if(this._clock.ticks!==e){const n=this.now();if(this.state==="started"){const i=this._clock.getTicksAtTime(n),r=this._clock.frequency.getDurationOfTicks(Math.ceil(i)-i,n),s=n+r;this.emit("stop",s),this._clock.setTicksAtTime(e,s),this.emit("start",s,this._clock.getSecondsAtTime(s))}else this._clock.setTicksAtTime(e,n)}}getTicksAtTime(e){return Math.round(this._clock.getTicksAtTime(e))}getSecondsAtTime(e){return this._clock.getSecondsAtTime(e)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(e){this._clock.frequency.multiplier=e}nextSubdivision(e){if(e=this.toTicks(e),this.state!=="started")return 0;{const n=this.now(),i=this.getTicksAtTime(n),r=e-i%e;return this._clock.nextTickTime(r,n)}}syncSignal(e,n){if(!n){const r=this.now();if(e.getValueAtTime(r)!==0){const s=this.bpm.getValueAtTime(r),o=1/(60/s/this.PPQ);n=e.getValueAtTime(r)/o}else n=0}const i=new Ge(n);return this.bpm.connect(i),i.connect(e._param),this._syncedSignals.push({initial:e.value,ratio:i,signal:e}),e.value=0,this}unsyncSignal(e){for(let n=this._syncedSignals.length-1;n>=0;n--){const i=this._syncedSignals[n];i.signal===e&&(i.ratio.dispose(),i.signal.value=i.initial,this._syncedSignals.splice(n,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),uu(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}Pi.mixin(fi);Gr(t=>{t.transport=new fi({context:t})});Zr(t=>{t.transport.dispose()});class rt extends oe{constructor(e){super(e),this.input=void 0,this._state=new ho("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=fe,this._syncedStop=fe,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new cn({context:this.context,mute:e.mute,volume:e.volume}),this.volume=this._volume.volume,Te(this,"volume"),this.onstop=e.onstop}static getDefaults(){return Object.assign(oe.getDefaults(),{mute:!1,onstop:fe,volume:0})}get state(){return this._synced?this.context.transport.state==="started"?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}_clampToCurrentTime(e){return this._synced?e:Math.max(e,this.context.currentTime)}start(e,n,i){let r=at(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(r=this._clampToCurrentTime(r),!this._synced&&this._state.getValueAtTime(r)==="started")te(_r(r,this._state.get(r).time),"Start time must be strictly greater than previous start time"),this._state.cancel(r),this._state.setStateAtTime("started",r),this.log("restart",r),this.restart(r,n,i);else if(this.log("start",r),this._state.setStateAtTime("started",r),this._synced){const s=this._state.get(r);s&&(s.offset=this.toSeconds(Dn(n,0)),s.duration=i?this.toSeconds(i):void 0);const o=this.context.transport.schedule(a=>{this._start(a,n,i)},r);this._scheduled.push(o),this.context.transport.state==="started"&&this.context.transport.getSecondsAtTime(this.immediate())>r&&this._syncedStart(this.now(),this.context.transport.seconds)}else nu(this.context),this._start(r,n,i);return this}stop(e){let n=at(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(n=this._clampToCurrentTime(n),this._state.getValueAtTime(n)==="started"||ae(this._state.getNextState("started",n))){if(this.log("stop",n),!this._synced)this._stop(n);else{const i=this.context.transport.schedule(this._stop.bind(this),n);this._scheduled.push(i)}this._state.cancel(n),this._state.setStateAtTime("stopped",n)}return this}restart(e,n,i){return e=this.toSeconds(e),this._state.getValueAtTime(e)==="started"&&(this._state.cancel(e),this._restart(e,n,i)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(e,n)=>{if(n>0){const i=this._state.get(n);if(i&&i.state==="started"&&i.time!==n){const r=n-this.toSeconds(i.time);let s;i.duration&&(s=this.toSeconds(i.duration)-r),this._start(e,this.toSeconds(i.offset)+r,s)}}},this._syncedStop=e=>{const n=this.context.transport.getSecondsAtTime(Math.max(e-this.sampleTime,0));this._state.getValueAtTime(n)==="started"&&this._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(e=>this.context.transport.clear(e)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=fe,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class pi extends qn{constructor(){super(H(pi.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;const e=H(pi.getDefaults(),arguments,["url","onload"]);Zn(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new ye({context:this.context,param:this._source.playbackRate,units:"positive",value:e.playbackRate}),this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this._buffer=new me(e.url,e.onload,e.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(qn.getDefaults(),{url:new me,loop:!1,loopEnd:0,loopStart:0,onload:fe,onerror:fe,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e}get curve(){return this._curve}set curve(e){this._curve=e}start(e,n,i,r=1){te(this.buffer.loaded,"buffer is either not set or not loaded");const s=this.toSeconds(e);this._startGain(s,r),this.loop?n=Dn(n,this.loopStart):n=Dn(n,0);let o=Math.max(this.toSeconds(n),0);if(this.loop){const a=this.toSeconds(this.loopEnd)||this.buffer.duration,l=this.toSeconds(this.loopStart),u=a-l;Fs(o,a)&&(o=(o-l)%u+l),ut(o,this.buffer.duration)&&(o=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,su(o,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(s,o)),ae(i)){let a=this.toSeconds(i);a=Math.max(a,0),this.stop(s+a)}return this}_stopSource(e){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(e)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(e){this._source.loopStart=this.toSeconds(e)}get loopEnd(){return this._source.loopEnd}set loopEnd(e){this._source.loopEnd=this.toSeconds(e)}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._source.loop}set loop(e){this._source.loop=e,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}function gn(t,e){return Oe(this,void 0,void 0,function*(){const n=e/t.context.sampleRate,i=new uo(1,n,t.context.sampleRate);return new t.constructor(Object.assign(t.get(),{frequency:2/n,detune:0,context:i})).toDestination().start(0),(yield i.render()).getChannelData(0)})}class Cr extends qn{constructor(){super(H(Cr.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];const e=H(Cr.getDefaults(),arguments,["frequency","type"]);Zn(this._oscillator,this._gainNode),this.type=e.type,this.frequency=new ye({context:this.context,param:this._oscillator.frequency,units:"frequency",value:e.frequency}),this.detune=new ye({context:this.context,param:this._oscillator.detune,units:"cents",value:e.detune}),Te(this,["frequency","detune"])}static getDefaults(){return Object.assign(qn.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(e){const n=this.toSeconds(e);return this.log("start",n),this._startGain(n),this._oscillator.start(n),this}_stopSource(e){this._oscillator.stop(e)}setPeriodicWave(e){return this._oscillator.setPeriodicWave(e),this}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class xe extends rt{constructor(){super(H(xe.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;const e=H(xe.getDefaults(),arguments,["frequency","type"]);this.frequency=new Pe({context:this.context,units:"frequency",value:e.frequency}),Te(this,"frequency"),this.detune=new Pe({context:this.context,units:"cents",value:e.detune}),Te(this,"detune"),this._partials=e.partials,this._partialCount=e.partialCount,this._type=e.type,e.partialCount&&e.type!=="custom"&&(this._type=this.baseType+e.partialCount.toString()),this.phase=e.phase}static getDefaults(){return Object.assign(rt.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(e){const n=this.toSeconds(e),i=new Cr({context:this.context,onended:()=>this.onstop(this)});this._oscillator=i,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(n)}_stop(e){const n=this.toSeconds(e);this._oscillator&&this._oscillator.stop(n)}_restart(e){const n=this.toSeconds(e);return this.log("restart",n),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(n),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if(this._type==="custom")return xe._periodicWaveCache.find(n=>n.phase===this._phase&&I_(n.partials,this._partials));{const e=xe._periodicWaveCache.find(n=>n.type===this._type&&n.phase===this._phase);return this._partialCount=e?e.partialCount:this._partialCount,e}}get type(){return this._type}set type(e){this._type=e;const n=["sine","square","sawtooth","triangle"].indexOf(e)!==-1;if(this._phase===0&&n)this._wave=void 0,this._partialCount=0,this._oscillator!==null&&(this._oscillator.type=e);else{const i=this._getCachedPeriodicWave();if(ae(i)){const{partials:r,wave:s}=i;this._wave=s,this._partials=r,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave)}else{const[r,s]=this._getRealImaginary(e,this._phase),o=this.context.createPeriodicWave(r,s);this._wave=o,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave),xe._periodicWaveCache.push({imag:s,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:r,type:this._type,wave:this._wave}),xe._periodicWaveCache.length>100&&xe._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(e){this.partialCount&&this._type!=="custom"&&e!=="custom"?this.type=e+this.partialCount:this.type=e}get partialCount(){return this._partialCount}set partialCount(e){Ut(e,0);let n=this._type;const i=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(i&&(n=i[1]),this._type!=="custom")e===0?this.type=n:this.type=n+e.toString();else{const r=new Float32Array(e);this._partials.forEach((s,o)=>r[o]=s),this._partials=Array.from(r),this.type=this._type}}_getRealImaginary(e,n){let r=2048;const s=new Float32Array(r),o=new Float32Array(r);let a=1;if(e==="custom"){if(a=this._partials.length+1,this._partialCount=this._partials.length,r=a,this._partials.length===0)return[s,o]}else{const l=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(e);l?(a=parseInt(l[2],10)+1,this._partialCount=parseInt(l[2],10),e=l[1],a=Math.max(a,2),r=a):this._partialCount=0,this._partials=[]}for(let l=1;l<r;++l){const u=2/(l*Math.PI);let c;switch(e){case"sine":c=l<=a?1:0,this._partials[l-1]=c;break;case"square":c=l&1?2*u:0,this._partials[l-1]=c;break;case"sawtooth":c=u*(l&1?1:-1),this._partials[l-1]=c;break;case"triangle":l&1?c=2*(u*u)*(l-1>>1&1?-1:1):c=0,this._partials[l-1]=c;break;case"custom":c=this._partials[l-1];break;default:throw new TypeError("Oscillator: invalid type: "+e)}c!==0?(s[l]=-c*Math.sin(n*l),o[l]=c*Math.cos(n*l)):(s[l]=0,o[l]=0)}return[s,o]}_inverseFFT(e,n,i){let r=0;const s=e.length;for(let o=0;o<s;o++)r+=e[o]*Math.cos(o*i)+n[o]*Math.sin(o*i);return r}getInitialValue(){const[e,n]=this._getRealImaginary(this._type,0);let i=0;const r=Math.PI*2,s=32;for(let o=0;o<s;o++)i=Math.max(this._inverseFFT(e,n,o/s*r),i);return M_(-this._inverseFFT(e,n,this._phase)/i,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(e){this._phase=e*Math.PI/180,this.type=this._type}asArray(e=1024){return Oe(this,void 0,void 0,function*(){return gn(this,e)})}dispose(){return super.dispose(),this._oscillator!==null&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}xe._periodicWaveCache=[];class Qr extends oe{constructor(){super(Object.assign(H(Qr.getDefaults(),arguments,["context"])))}connect(e,n=0,i=0){return fo(this,e,n,i),this}}class mi extends Qr{constructor(){super(Object.assign(H(mi.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;const e=H(mi.getDefaults(),arguments,["mapping","length"]);it(e.mapping)||e.mapping instanceof Float32Array?this.curve=Float32Array.from(e.mapping):b_(e.mapping)&&this.setMap(e.mapping,e.length)}static getDefaults(){return Object.assign(Pe.getDefaults(),{length:1024})}setMap(e,n=1024){const i=new Float32Array(n);for(let r=0,s=n;r<s;r++){const o=r/(s-1)*2-1;i[r]=e(o,r)}return this.curve=i,this}get curve(){return this._shaper.curve}set curve(e){this._shaper.curve=e}get oversample(){return this._shaper.oversample}set oversample(e){const n=["none","2x","4x"].some(i=>i.includes(e));te(n,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class H_ extends Qr{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new mi({context:this.context,mapping:e=>(e+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class hn extends Pe{constructor(){super(Object.assign(H(hn.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;const e=H(hn.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new Ge({context:this.context,minValue:e.minValue,maxValue:e.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Pe.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class gi extends rt{constructor(){super(H(gi.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new H_({context:this.context}),this._modulationNode=new Ge({context:this.context});const e=H(gi.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new xe({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new xe({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new hn({context:this.context,units:"positive",value:e.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),Te(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(xe.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){this._modulator.restart(e),this._carrier.restart(e)}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(e=1024){return Oe(this,void 0,void 0,function*(){return gn(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class vi extends rt{constructor(){super(H(vi.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new Ge({context:this.context,gain:0});const e=H(vi.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new xe({context:this.context,detune:e.detune,frequency:0,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.detune=this._carrier.detune,this.frequency=new Pe({context:this.context,units:"frequency",value:e.frequency}),this._modulator=new xe({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new hn({context:this.context,units:"positive",value:e.harmonicity}),this.modulationIndex=new hn({context:this.context,units:"positive",value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),Te(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(xe.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){return this._modulator.restart(e),this._carrier.restart(e),this}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(e=1024){return Oe(this,void 0,void 0,function*(){return gn(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class Bn extends rt{constructor(){super(H(Bn.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new Ge({context:this.context,gain:0}),this._thresh=new mi({context:this.context,mapping:n=>n<=0?-1:1});const e=H(Bn.getDefaults(),arguments,["frequency","width"]);this.width=new Pe({context:this.context,units:"audioRange",value:e.width}),this._triangle=new xe({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),Te(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(rt.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(e){e=this.toSeconds(e),this._triangle.start(e),this._widthGate.gain.setValueAtTime(1,e)}_stop(e){e=this.toSeconds(e),this._triangle.stop(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(0,e)}_restart(e){this._triangle.restart(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(1,e)}get phase(){return this._triangle.phase}set phase(e){this._triangle.phase=e}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(e){this._triangle.type=e}asArray(e=1024){return Oe(this,void 0,void 0,function*(){return gn(this,e)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class _i extends rt{constructor(){super(H(_i.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];const e=H(_i.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new Pe({context:this.context,units:"frequency",value:e.frequency}),this.detune=new Pe({context:this.context,units:"cents",value:e.detune}),this._spread=e.spread,this._type=e.type,this._phase=e.phase,this._partials=e.partials,this._partialCount=e.partialCount,this.count=e.count,Te(this,["frequency","detune"])}static getDefaults(){return Object.assign(xe.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(e){e=this.toSeconds(e),this._forEach(n=>n.start(e))}_stop(e){e=this.toSeconds(e),this._forEach(n=>n.stop(e))}_restart(e){this._forEach(n=>n.restart(e))}_forEach(e){for(let n=0;n<this._oscillators.length;n++)e(this._oscillators[n],n)}get type(){return this._type}set type(e){this._type=e,this._forEach(n=>n.type=e)}get spread(){return this._spread}set spread(e){if(this._spread=e,this._oscillators.length>1){const n=-e/2,i=e/(this._oscillators.length-1);this._forEach((r,s)=>r.detune.value=n+i*s)}}get count(){return this._oscillators.length}set count(e){if(Ut(e,1),this._oscillators.length!==e){this._forEach(n=>n.dispose()),this._oscillators=[];for(let n=0;n<e;n++){const i=new xe({context:this.context,volume:-6-e*1.1,type:this._type,phase:this._phase+n/e*360,partialCount:this._partialCount,onstop:n===0?()=>this.onstop(this):fe});this.type==="custom"&&(i.partials=this._partials),this.frequency.connect(i.frequency),this.detune.connect(i.detune),i.detune.overridden=!1,i.connect(this.output),this._oscillators[n]=i}this.spread=this._spread,this.state==="started"&&this._forEach(n=>n.start())}}get phase(){return this._phase}set phase(e){this._phase=e,this._forEach((n,i)=>n.phase=this._phase+i/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(e){this._forEach(n=>n.baseType=e),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this._type="custom",this._forEach(n=>n.partials=e))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(e){this._partialCount=e,this._forEach(n=>n.partialCount=e),this._type=this._oscillators[0].type}asArray(e=1024){return Oe(this,void 0,void 0,function*(){return gn(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(e=>e.dispose()),this}}class yi extends rt{constructor(){super(H(yi.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new hn({context:this.context,value:2});const e=H(yi.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new Bn({context:this.context,frequency:e.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new xe({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),Te(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(rt.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(e){e=this.toSeconds(e),this._modulator.start(e),this._pulse.start(e)}_stop(e){e=this.toSeconds(e),this._modulator.stop(e),this._pulse.stop(e)}_restart(e){this._modulator.restart(e),this._pulse.restart(e)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(e){this._modulator.phase=e}asArray(e=1024){return Oe(this,void 0,void 0,function*(){return gn(this,e)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const Ia={am:gi,fat:_i,fm:vi,oscillator:xe,pulse:Bn,pwm:yi};class bi extends rt{constructor(){super(H(bi.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";const e=H(bi.getDefaults(),arguments,["frequency","type"]);this.frequency=new Pe({context:this.context,units:"frequency",value:e.frequency}),this.detune=new Pe({context:this.context,units:"cents",value:e.detune}),Te(this,["frequency","detune"]),this.set(e)}static getDefaults(){return Object.assign(xe.getDefaults(),vi.getDefaults(),gi.getDefaults(),_i.getDefaults(),Bn.getDefaults(),yi.getDefaults())}_start(e){this._oscillator.start(e)}_stop(e){this._oscillator.stop(e)}_restart(e){return this._oscillator.restart(e),this}get type(){let e="";return["am","fm","fat"].some(n=>this._sourceType===n)&&(e=this._sourceType),e+this._oscillator.type}set type(e){e.substr(0,2)==="fm"?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,2)==="am"?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,3)==="fat"?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(3)):e==="pwm"?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):e==="pulse"?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=e)}get partials(){return this._oscillator.partials}set partials(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partials=e)}get partialCount(){return this._oscillator.partialCount}set partialCount(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partialCount=e)}set(e){return Reflect.has(e,"type")&&e.type&&(this.type=e.type),super.set(e),this}_createNewOscillator(e){if(e!==this._sourceType){this._sourceType=e;const n=Ia[e],i=this.now();if(this._oscillator){const r=this._oscillator;r.stop(i),this.context.setTimeout(()=>r.dispose(),this.blockTime)}this._oscillator=new n({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),this.state==="started"&&this._oscillator.start(i)}}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e}get sourceType(){return this._sourceType}set sourceType(e){let n="sine";this._oscillator.type!=="pwm"&&this._oscillator.type!=="pulse"&&(n=this._oscillator.type),e==="fm"?this.type="fm"+n:e==="am"?this.type="am"+n:e==="fat"?this.type="fat"+n:e==="oscillator"?this.type=n:e==="pulse"?this.type="pulse":e==="pwm"&&(this.type="pwm")}_getOscType(e,n){return e instanceof Ia[n]}get baseType(){return this._oscillator.baseType}set baseType(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&e!=="pulse"&&e!=="pwm"&&(this._oscillator.baseType=e)}get width(){if(this._getOscType(this._oscillator,"pulse"))return this._oscillator.width}get count(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.count}set count(e){this._getOscType(this._oscillator,"fat")&&Wt(e)&&(this._oscillator.count=e)}get spread(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.spread}set spread(e){this._getOscType(this._oscillator,"fat")&&Wt(e)&&(this._oscillator.spread=e)}get modulationType(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.modulationType}set modulationType(e){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&bt(e)&&(this._oscillator.modulationType=e)}get modulationIndex(){if(this._getOscType(this._oscillator,"fm"))return this._oscillator.modulationIndex}get harmonicity(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.harmonicity}get modulationFrequency(){if(this._getOscType(this._oscillator,"pwm"))return this._oscillator.modulationFrequency}asArray(e=1024){return Oe(this,void 0,void 0,function*(){return gn(this,e)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}function pu(t,e=1/0){const n=new WeakMap;return function(i,r){Reflect.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(s){Ut(s,t,e),n.set(this,s)}})}}function Dt(t,e=1/0){const n=new WeakMap;return function(i,r){Reflect.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(s){Ut(this.toSeconds(s),t,e),n.set(this,s)}})}}class wi extends rt{constructor(){super(H(wi.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;const e=H(wi.getDefaults(),arguments,["url","onload"]);this._buffer=new me({onload:this._onload.bind(this,e.onload),onerror:e.onerror,reverse:e.reverse,url:e.url}),this.autostart=e.autostart,this._loop=e.loop,this._loopStart=e.loopStart,this._loopEnd=e.loopEnd,this._playbackRate=e.playbackRate,this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut}static getDefaults(){return Object.assign(rt.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:fe,onerror:fe,playbackRate:1,reverse:!1})}load(e){return Oe(this,void 0,void 0,function*(){return yield this._buffer.load(e),this._onload(),this})}_onload(e=fe){e(),this.autostart&&this.start()}_onSourceEnd(e){this.onstop(this),this._activeSources.delete(e),this._activeSources.size===0&&!this._synced&&this._state.getValueAtTime(this.now())==="started"&&(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(e,n,i){return super.start(e,n,i),this}_start(e,n,i){this._loop?n=Dn(n,this._loopStart):n=Dn(n,0);const r=this.toSeconds(n),s=i;i=Dn(i,Math.max(this._buffer.duration-r,0));let o=this.toSeconds(i);o=o/this._playbackRate,e=this.toSeconds(e);const a=new pi({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);!this._loop&&!this._synced&&(this._state.cancel(e+o),this._state.setStateAtTime("stopped",e+o,{implicitEnd:!0})),this._activeSources.add(a),this._loop&&at(s)?a.start(e,r):a.start(e,r,o-this.toSeconds(this.fadeOut))}_stop(e){const n=this.toSeconds(e);this._activeSources.forEach(i=>i.stop(n))}restart(e,n,i){return super.restart(e,n,i),this}_restart(e,n,i){this._stop(e),this._start(e,n,i)}seek(e,n){const i=this.toSeconds(n);if(this._state.getValueAtTime(i)==="started"){const r=this.toSeconds(e);this._stop(i),this._start(i,r)}return this}setLoopPoints(e,n){return this.loopStart=e,this.loopEnd=n,this}get loopStart(){return this._loopStart}set loopStart(e){this._loopStart=e,this.buffer.loaded&&Ut(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(n=>{n.loopStart=e})}get loopEnd(){return this._loopEnd}set loopEnd(e){this._loopEnd=e,this.buffer.loaded&&Ut(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(n=>{n.loopEnd=e})}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._loop}set loop(e){if(this._loop!==e&&(this._loop=e,this._activeSources.forEach(n=>{n.loop=e}),e)){const n=this._state.getNextState("stopped",this.now());n&&this._state.cancel(n.time)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e;const n=this.now(),i=this._state.getNextState("stopped",n);i&&i.implicitEnd&&(this._state.cancel(i.time),this._activeSources.forEach(r=>r.cancelStop())),this._activeSources.forEach(r=>{r.playbackRate.setValueAtTime(e,n)})}get reverse(){return this._buffer.reverse}set reverse(e){this._buffer.reverse=e}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(e=>e.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}vt([Dt(0)],wi.prototype,"fadeIn",void 0);vt([Dt(0)],wi.prototype,"fadeOut",void 0);class Mt extends oe{constructor(){super(H(Mt.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new Pe({context:this.context,value:0}),this.output=this._sig,this.input=void 0;const e=H(Mt.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this.attackCurve=e.attackCurve,this.releaseCurve=e.releaseCurve,this.decayCurve=e.decayCurve}static getDefaults(){return Object.assign(oe.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(e,n){if(bt(e))return e;{let i;for(i in Ji)if(Ji[i][n]===e)return i;return e}}_setCurve(e,n,i){if(bt(i)&&Reflect.has(Ji,i)){const r=Ji[i];nn(r)?e!=="_decayCurve"&&(this[e]=r[n]):this[e]=r}else if(it(i)&&e!=="_decayCurve")this[e]=i;else throw new Error("Envelope: invalid curve: "+i)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(e){this._setCurve("_attackCurve","In",e)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(e){this._setCurve("_releaseCurve","Out",e)}get decayCurve(){return this._decayCurve}set decayCurve(e){te(["linear","exponential"].some(n=>n===e),`Invalid envelope curve: ${e}`),this._decayCurve=e}triggerAttack(e,n=1){this.log("triggerAttack",e,n),e=this.toSeconds(e);let r=this.toSeconds(this.attack);const s=this.toSeconds(this.decay),o=this.getValueAtTime(e);if(o>0){const a=1/r;r=(1-o)/a}if(r<this.sampleTime)this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(n,e);else if(this._attackCurve==="linear")this._sig.linearRampTo(n,r,e);else if(this._attackCurve==="exponential")this._sig.targetRampTo(n,r,e);else{this._sig.cancelAndHoldAtTime(e);let a=this._attackCurve;for(let l=1;l<a.length;l++)if(a[l-1]<=o&&o<=a[l]){a=this._attackCurve.slice(l),a[0]=o;break}this._sig.setValueCurveAtTime(a,e,r,n)}if(s&&this.sustain<1){const a=n*this.sustain,l=e+r;this.log("decay",l),this._decayCurve==="linear"?this._sig.linearRampToValueAtTime(a,s+l):this._sig.exponentialApproachValueAtTime(a,l,s)}return this}triggerRelease(e){this.log("triggerRelease",e),e=this.toSeconds(e);const n=this.getValueAtTime(e);if(n>0){const i=this.toSeconds(this.release);i<this.sampleTime?this._sig.setValueAtTime(0,e):this._releaseCurve==="linear"?this._sig.linearRampTo(0,i,e):this._releaseCurve==="exponential"?this._sig.targetRampTo(0,i,e):(te(it(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(e),this._sig.setValueCurveAtTime(this._releaseCurve,e,i,n))}return this}getValueAtTime(e){return this._sig.getValueAtTime(e)}triggerAttackRelease(e,n,i=1){return n=this.toSeconds(n),this.triggerAttack(n,i),this.triggerRelease(n+this.toSeconds(e)),this}cancel(e){return this._sig.cancelScheduledValues(this.toSeconds(e)),this}connect(e,n=0,i=0){return fo(this,e,n,i),this}asArray(e=1024){return Oe(this,void 0,void 0,function*(){const n=e/this.context.sampleRate,i=new uo(1,n,this.context.sampleRate),r=this.toSeconds(this.attack)+this.toSeconds(this.decay),s=r+this.toSeconds(this.release),o=s*.1,a=s+o,l=new this.constructor(Object.assign(this.get(),{attack:n*this.toSeconds(this.attack)/a,decay:n*this.toSeconds(this.decay)/a,release:n*this.toSeconds(this.release)/a,context:i}));return l._sig.toDestination(),l.triggerAttackRelease(n*(r+o)/a,0),(yield i.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}}vt([Dt(0)],Mt.prototype,"attack",void 0);vt([Dt(0)],Mt.prototype,"decay",void 0);vt([pu(0,1)],Mt.prototype,"sustain",void 0);vt([Dt(0)],Mt.prototype,"release",void 0);const Ji=(()=>{let e,n;const i=[];for(e=0;e<128;e++)i[e]=Math.sin(e/(128-1)*(Math.PI/2));const r=[],s=6.4;for(e=0;e<128-1;e++){n=e/(128-1);const f=Math.sin(n*(Math.PI*2)*s-Math.PI/2)+1;r[e]=f/10+n*.83}r[128-1]=1;const o=[],a=5;for(e=0;e<128;e++)o[e]=Math.ceil(e/(128-1)*a)/a;const l=[];for(e=0;e<128;e++)n=e/(128-1),l[e]=.5*(1-Math.cos(Math.PI*n));const u=[];for(e=0;e<128;e++){n=e/(128-1);const f=Math.pow(n,3)*4+.2,d=Math.cos(f*Math.PI*2*n);u[e]=Math.abs(d*(1-n))}function c(f){const d=new Array(f.length);for(let p=0;p<f.length;p++)d[p]=1-f[p];return d}function h(f){return f.slice(0).reverse()}return{bounce:{In:c(u),Out:u},cosine:{In:i,Out:h(i)},exponential:"exponential",linear:"linear",ripple:{In:r,Out:c(r)},sine:{In:l,Out:c(l)},step:{In:o,Out:c(o)}}})();class Nt extends oe{constructor(){super(H(Nt.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;const e=H(Nt.getDefaults(),arguments);this._volume=this.output=new cn({context:this.context,volume:e.volume}),this.volume=this._volume.volume,Te(this,"volume")}static getDefaults(){return Object.assign(oe.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let e=!1;return this._synced||(this._synced=!0,e=!0),e}_syncMethod(e,n){const i=this["_original_"+e]=this[e];this[e]=(...r)=>{const s=r[n],o=this.context.transport.schedule(a=>{r[n]=a,i.apply(this,r)},s);this._scheduledEvents.push(o)}}unsync(){return this._scheduledEvents.forEach(e=>this.context.transport.clear(e)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(e,n,i,r){const s=this.toSeconds(i),o=this.toSeconds(n);return this.triggerAttack(e,s,r),this.triggerRelease(s+o),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class dn extends Nt{constructor(){super(H(dn.getDefaults(),arguments));const e=H(dn.getDefaults(),arguments);this.portamento=e.portamento,this.onsilence=e.onsilence}static getDefaults(){return Object.assign(Nt.getDefaults(),{detune:0,onsilence:fe,portamento:0})}triggerAttack(e,n,i=1){this.log("triggerAttack",e,n,i);const r=this.toSeconds(n);return this._triggerEnvelopeAttack(r,i),this.setNote(e,r),this}triggerRelease(e){this.log("triggerRelease",e);const n=this.toSeconds(e);return this._triggerEnvelopeRelease(n),this}setNote(e,n){const i=this.toSeconds(n),r=e instanceof nt?e.toFrequency():e;if(this.portamento>0&&this.getLevelAtTime(i)>.05){const s=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(r,s,i)}else this.frequency.setValueAtTime(r,i);return this}}vt([Dt(0)],dn.prototype,"portamento",void 0);class go extends Mt{constructor(){super(H(go.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new Ge({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class Ln extends dn{constructor(){super(H(Ln.getDefaults(),arguments)),this.name="Synth";const e=H(Ln.getDefaults(),arguments);this.oscillator=new bi(Object.assign({context:this.context,detune:e.detune,onstop:()=>this.onsilence(this)},e.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new go(Object.assign({context:this.context},e.envelope)),this.oscillator.chain(this.envelope,this.output),Te(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(dn.getDefaults(),{envelope:Object.assign(Ds(Mt.getDefaults(),Object.keys(oe.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(Ds(bi.getDefaults(),[...Object.keys(rt.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(e,n){if(this.envelope.triggerAttack(e,n),this.oscillator.start(e),this.envelope.sustain===0){const i=this.toSeconds(this.envelope.attack),r=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+i+r)}}_triggerEnvelopeRelease(e){this.envelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class Si extends Ln{constructor(){super(H(Si.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;const e=H(Si.getDefaults(),arguments);this.pitchDecay=e.pitchDecay,this.octaves=e.octaves,Te(this,["oscillator","envelope"])}static getDefaults(){return sn(dn.getDefaults(),Ln.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(e,n){const i=this.toSeconds(n),r=this.toFrequency(e instanceof nt?e.toFrequency():e),s=r*this.octaves;return this.oscillator.frequency.setValueAtTime(s,i),this.oscillator.frequency.exponentialRampToValueAtTime(r,i+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}vt([pu(0)],Si.prototype,"octaves",void 0);vt([Dt(0)],Si.prototype,"pitchDecay",void 0);const mu=new Set;function vo(t){mu.add(t)}function gu(t,e){const n=`registerProcessor("${t}", ${e})`;mu.add(n)}const G_=`
	/**
	 * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. 
	 */
	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {

		constructor(options) {
			
			super(options);
			/**
			 * If the processor was disposed or not. Keep alive until it's disposed.
			 */
			this.disposed = false;
		   	/** 
			 * The number of samples in the processing block
			 */
			this.blockSize = 128;
			/**
			 * the sample rate
			 */
			this.sampleRate = sampleRate;

			this.port.onmessage = (event) => {
				// when it receives a dispose 
				if (event.data === "dispose") {
					this.disposed = true;
				}
			};
		}
	}
`;vo(G_);const Z_=`
	/**
	 * Abstract class for a single input/output processor. 
	 * has a 'generate' function which processes one sample at a time
	 */
	class SingleIOProcessor extends ToneAudioWorkletProcessor {

		constructor(options) {
			super(Object.assign(options, {
				numberOfInputs: 1,
				numberOfOutputs: 1
			}));
			/**
			 * Holds the name of the parameter and a single value of that
			 * parameter at the current sample
			 * @type { [name: string]: number }
			 */
			this.params = {}
		}

		/**
		 * Generate an output sample from the input sample and parameters
		 * @abstract
		 * @param input number
		 * @param channel number
		 * @param parameters { [name: string]: number }
		 * @returns number
		 */
		generate(){}

		/**
		 * Update the private params object with the 
		 * values of the parameters at the given index
		 * @param parameters { [name: string]: Float32Array },
		 * @param index number
		 */
		updateParams(parameters, index) {
			for (const paramName in parameters) {
				const param = parameters[paramName];
				if (param.length > 1) {
					this.params[paramName] = parameters[paramName][index];
				} else {
					this.params[paramName] = parameters[paramName][0];
				}
			}
		}

		/**
		 * Process a single frame of the audio
		 * @param inputs Float32Array[][]
		 * @param outputs Float32Array[][]
		 */
		process(inputs, outputs, parameters) {
			const input = inputs[0];
			const output = outputs[0];
			// get the parameter values
			const channelCount = Math.max(input && input.length || 0, output.length);
			for (let sample = 0; sample < this.blockSize; sample++) {
				this.updateParams(parameters, sample);
				for (let channel = 0; channel < channelCount; channel++) {
					const inputSample = input && input.length ? input[channel][sample] : 0;
					output[channel][sample] = this.generate(inputSample, channel, this.params);
				}
			}
			return !this.disposed;
		}
	};
`;vo(Z_);const X_=`
	/**
	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line
	 */
	class DelayLine {
		
		constructor(size, channels) {
			this.buffer = [];
			this.writeHead = []
			this.size = size;

			// create the empty channels
			for (let i = 0; i < channels; i++) {
				this.buffer[i] = new Float32Array(this.size);
				this.writeHead[i] = 0;
			}
		}

		/**
		 * Push a value onto the end
		 * @param channel number
		 * @param value number
		 */
		push(channel, value) {
			this.writeHead[channel] += 1;
			if (this.writeHead[channel] > this.size) {
				this.writeHead[channel] = 0;
			}
			this.buffer[channel][this.writeHead[channel]] = value;
		}

		/**
		 * Get the recorded value of the channel given the delay
		 * @param channel number
		 * @param delay number delay samples
		 */
		get(channel, delay) {
			let readHead = this.writeHead[channel] - Math.floor(delay);
			if (readHead < 0) {
				readHead += this.size;
			}
			return this.buffer[channel][readHead];
		}
	}
`;vo(X_);const Q_="feedback-comb-filter",Y_=`
	class FeedbackCombFilterWorklet extends SingleIOProcessor {

		constructor(options) {
			super(options);
			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);
		}

		static get parameterDescriptors() {
			return [{
				name: "delayTime",
				defaultValue: 0.1,
				minValue: 0,
				maxValue: 1,
				automationRate: "k-rate"
			}, {
				name: "feedback",
				defaultValue: 0.5,
				minValue: 0,
				maxValue: 0.9999,
				automationRate: "k-rate"
			}];
		}

		generate(input, channel, parameters) {
			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);
			this.delayLine.push(channel, input + delayedSample * parameters.feedback);
			return delayedSample;
		}
	}
`;gu(Q_,Y_);class xr extends Nt{constructor(){super(H(xr.getDefaults(),arguments,["voice","options"])),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0;const e=H(xr.getDefaults(),arguments,["voice","options"]);te(!Wt(e.voice),"DEPRECATED: The polyphony count is no longer the first argument.");const n=e.voice.getDefaults();this.options=Object.assign(n,e.options),this.voice=e.voice,this.maxPolyphony=e.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();const i=this._voices.indexOf(this._dummyVoice);this._voices.splice(i,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign(Nt.getDefaults(),{maxPolyphony:32,options:{},voice:Ln})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(e){this._availableVoices.push(e);const n=this._activeVoices.findIndex(i=>i.voice===e);this._activeVoices.splice(n,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){const e=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return e.connect(this.output),this._voices.push(e),e}else ao("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(this._averageActiveVoices*.95,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){const e=this._availableVoices.shift(),n=this._voices.indexOf(e);this._voices.splice(n,1),this.context.isOffline||e.dispose()}}_triggerAttack(e,n,i){e.forEach(r=>{const s=new Tr(this.context,r).toMidi(),o=this._getNextAvailableVoice();o&&(o.triggerAttack(r,n,i),this._activeVoices.push({midi:s,voice:o,released:!1}),this.log("triggerAttack",r,n))})}_triggerRelease(e,n){e.forEach(i=>{const r=new Tr(this.context,i).toMidi(),s=this._activeVoices.find(({midi:o,released:a})=>o===r&&!a);s&&(s.voice.triggerRelease(n),s.released=!0,this.log("triggerRelease",i,n))})}_scheduleEvent(e,n,i,r){te(!this.disposed,"Synth was already disposed"),i<=this.now()?e==="attack"?this._triggerAttack(n,i,r):this._triggerRelease(n,i):this.context.setTimeout(()=>{this._scheduleEvent(e,n,i,r)},i-this.now())}triggerAttack(e,n,i){Array.isArray(e)||(e=[e]);const r=this.toSeconds(n);return this._scheduleEvent("attack",e,r,i),this}triggerRelease(e,n){Array.isArray(e)||(e=[e]);const i=this.toSeconds(n);return this._scheduleEvent("release",e,i),this}triggerAttackRelease(e,n,i,r){const s=this.toSeconds(i);if(this.triggerAttack(e,s,r),it(n)){te(it(e),"If the duration is an array, the notes must also be an array"),e=e;for(let o=0;o<e.length;o++){const a=n[Math.min(o,n.length-1)],l=this.toSeconds(a);te(l>0,"The duration must be greater than 0"),this.triggerRelease(e[o],s+l)}}else{const o=this.toSeconds(n);te(o>0,"The duration must be greater than 0"),this.triggerRelease(e,s+o)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}set(e){const n=Ds(e,["onsilence","context"]);return this.options=sn(this.options,n),this._voices.forEach(i=>i.set(n)),this._dummyVoice.set(n),this}get(){return this._dummyVoice.get()}releaseAll(e){const n=this.toSeconds(e);return this._activeVoices.forEach(({voice:i})=>{i.triggerRelease(n)}),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach(e=>e.dispose()),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}class Ti extends Nt{constructor(){super(H(Ti.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;const e=H(Ti.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),n={};Object.keys(e.urls).forEach(i=>{const r=parseInt(i,10);if(te(Ki(i)||Wt(r)&&isFinite(r),`url key is neither a note or midi pitch: ${i}`),Ki(i)){const s=new nt(this.context,i).toMidi();n[s]=e.urls[i]}else Wt(r)&&isFinite(r)&&(n[r]=e.urls[r])}),this._buffers=new po({urls:n,onload:e.onload,baseUrl:e.baseUrl,onerror:e.onerror}),this.attack=e.attack,this.release=e.release,this.curve=e.curve,this._buffers.loaded&&Promise.resolve().then(e.onload)}static getDefaults(){return Object.assign(Nt.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:fe,onerror:fe,release:.1,urls:{}})}_findClosest(e){let i=0;for(;i<96;){if(this._buffers.has(e+i))return-i;if(this._buffers.has(e-i))return i;i++}throw new Error(`No available buffers for note: ${e}`)}triggerAttack(e,n,i=1){return this.log("triggerAttack",e,n,i),Array.isArray(e)||(e=[e]),e.forEach(r=>{const s=du(new nt(this.context,r).toFrequency()),o=Math.round(s),a=s-o,l=this._findClosest(o),u=o-l,c=this._buffers.get(u),h=hu(l+a),f=new pi({url:c,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:h}).connect(this.output);f.start(n,0,c.duration/h,i),it(this._activeSources.get(o))||this._activeSources.set(o,[]),this._activeSources.get(o).push(f),f.onended=()=>{if(this._activeSources&&this._activeSources.has(o)){const d=this._activeSources.get(o),p=d.indexOf(f);p!==-1&&d.splice(p,1)}}}),this}triggerRelease(e,n){return this.log("triggerRelease",e,n),Array.isArray(e)||(e=[e]),e.forEach(i=>{const r=new nt(this.context,i).toMidi();if(this._activeSources.has(r)&&this._activeSources.get(r).length){const s=this._activeSources.get(r);n=this.toSeconds(n),s.forEach(o=>{o.stop(n)}),this._activeSources.set(r,[])}}),this}releaseAll(e){const n=this.toSeconds(e);return this._activeSources.forEach(i=>{for(;i.length;)i.shift().stop(n)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(e,n,i,r=1){const s=this.toSeconds(i);return this.triggerAttack(e,s,r),it(n)?(te(it(e),"notes must be an array when duration is array"),e.forEach((o,a)=>{const l=n[Math.min(a,n.length-1)];this.triggerRelease(o,s+this.toSeconds(l))})):this.triggerRelease(e,s+this.toSeconds(n)),this}add(e,n,i){if(te(Ki(e)||isFinite(e),`note must be a pitch or midi: ${e}`),Ki(e)){const r=new nt(this.context,e).toMidi();this._buffers.add(r,n,i)}else this._buffers.add(e,n,i);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(e=>{e.forEach(n=>n.dispose())}),this._activeSources.clear(),this}}vt([Dt(0)],Ti.prototype,"attack",void 0);vt([Dt(0)],Ti.prototype,"release",void 0);class Ar extends oe{constructor(){super(Object.assign(H(Ar.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;const e=H(Ar.getDefaults(),arguments,["pan"]);this.pan=new ye({context:this.context,param:this._panner.pan,value:e.pan,minValue:-1,maxValue:1}),this._panner.channelCount=e.channelCount,this._panner.channelCountMode="explicit",Te(this,"pan")}static getDefaults(){return Object.assign(oe.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}const K_="bit-crusher",J_=`
	class BitCrusherWorklet extends SingleIOProcessor {

		static get parameterDescriptors() {
			return [{
				name: "bits",
				defaultValue: 12,
				minValue: 1,
				maxValue: 16,
				automationRate: 'k-rate'
			}];
		}

		generate(input, _channel, parameters) {
			const step = Math.pow(0.5, parameters.bits - 1);
			const val = step * Math.floor(input / step + 0.5);
			return val;
		}
	}
`;gu(K_,J_);class Ce extends oe{constructor(){super(H(Ce.getDefaults(),arguments,["solo"])),this.name="Solo";const e=H(Ce.getDefaults(),arguments,["solo"]);this.input=this.output=new Ge({context:this.context}),Ce._allSolos.has(this.context)||Ce._allSolos.set(this.context,new Set),Ce._allSolos.get(this.context).add(this),this.solo=e.solo}static getDefaults(){return Object.assign(oe.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(e){e?this._addSolo():this._removeSolo(),Ce._allSolos.get(this.context).forEach(n=>n._updateSolo())}get muted(){return this.input.gain.value===0}_addSolo(){Ce._soloed.has(this.context)||Ce._soloed.set(this.context,new Set),Ce._soloed.get(this.context).add(this)}_removeSolo(){Ce._soloed.has(this.context)&&Ce._soloed.get(this.context).delete(this)}_isSoloed(){return Ce._soloed.has(this.context)&&Ce._soloed.get(this.context).has(this)}_noSolos(){return!Ce._soloed.has(this.context)||Ce._soloed.has(this.context)&&Ce._soloed.get(this.context).size===0}_updateSolo(){this._isSoloed()?this.input.gain.value=1:this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),Ce._allSolos.get(this.context).delete(this),this._removeSolo(),this}}Ce._allSolos=new Map;Ce._soloed=new Map;class Ir extends oe{constructor(){super(H(Ir.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";const e=H(Ir.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new Ar({context:this.context,pan:e.pan,channelCount:e.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new cn({context:this.context,volume:e.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=e.mute,Te(this,["pan","volume"])}static getDefaults(){return Object.assign(oe.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class Qt extends oe{constructor(){super(H(Qt.getDefaults(),arguments,["volume","pan"])),this.name="Channel";const e=H(Qt.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new Ce({solo:e.solo,context:this.context}),this._panVol=this.output=new Ir({context:this.context,pan:e.pan,volume:e.volume,mute:e.mute,channelCount:e.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),Te(this,["pan","volume"])}static getDefaults(){return Object.assign(oe.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(e){this._solo.solo=e}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(e){this._panVol.mute=e}_getBus(e){return Qt.buses.has(e)||Qt.buses.set(e,new Ge({context:this.context})),Qt.buses.get(e)}send(e,n=0){const i=this._getBus(e),r=new Ge({context:this.context,units:"decibels",gain:n});return this.connect(r),r.connect(i),r}receive(e){return this._getBus(e).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}Qt.buses=new Map;class ey extends oe{constructor(){super(...arguments),this.name="Listener",this.positionX=new ye({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new ye({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new ye({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new ye({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new ye({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new ye({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new ye({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new ye({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new ye({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(oe.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}Gr(t=>{t.listener=new ey({context:t})});Zr(t=>{t.listener.dispose()});function ty(){return ot().now()}ot().transport;ot().destination;ot().destination;ot().listener;ot().draw;ot();const bs=[],ny=Mr({name:"IndexPage",components:{Editor:yd},setup(){const t=Q(),e=Q(),n=Q(!1),i=Q(1e7),r=Q(""),s=Q(20),o=Q({label:"16th",value:16}),a=Q(),l=Q();return{file:t,fclk:i,playing:n,minVelocity:s,code:r,unit:o,bpmOverride:a,durationOverride:l,unitOptions:[{label:"128th",value:128},{label:"64th",value:64},{label:"32th",value:32},{label:"16th",value:16},{label:"8th",value:8},{label:"4th",value:4},{label:"2nd",value:2},{label:"1st",value:1}],json:D(()=>JSON.stringify(e.value,null,2)),async onFileChange(){if(!t.value)return;const u=await t.value.arrayBuffer(),c=new ol.Midi(u);console.log(Ed(new Uint8Array(u))),e.value=c.toJSON()},stop(){bs.forEach(u=>u.disconnect()),bs.length=0,n.value=!1},play(){if(!e.value)return;const u=e.value;if(n.value||!u)return;const c=ty();u.tracks.forEach(h=>{const f=new xr().toDestination();bs.push(f),h.notes.forEach(d=>{const{name:p,velocity:g,duration:m,time:w}=d;f.triggerAttackRelease(p,m,w+c,g)})}),n.value=!0},generate(){var m,w,b,C;if(!e.value)return;const u=[[]],c=e.value.header.ppq*4/o.value.value;for(const T of e.value.tracks)for(const v of T.notes.sort((_,y)=>_.ticks-y.ticks)){const{ticks:_,durationTicks:y,midi:S}=v,A=Math.round(_/c),I=l.value||Math.max(1,Math.round(y/c)),M=A+I;for(let N=0;N<u.length;N++){const V=u[N],F=V[V.length-1],W=F&&F.start>=A&&F.end<=M,j={start:A,end:M,midi:S,duration:I};if(W)if(N===u.length-1){u.push([j]);break}else continue;else{V.push(j);break}}}const h=u.map(T=>{let v=0;const _=[];for(const y of T){const{start:S,end:A,midi:I,duration:M}=y;let N=S-v;for(;N>0;){const V=Math.min(N,127);_.push(128+V),N-=V}for(let V=0;V<M;V++)_.push(I);v=A}return _}),d=(a.value||((b=(w=(m=e.value.header)==null?void 0:m.tempos)==null?void 0:w[0])==null?void 0:b.bpm)||120)/60/4*o.value.value,p=Math.round(i.value/d*4),g=new Array(12).fill(0).map((T,v)=>{const _=440*Math.pow(2,(v-69)/12);return Math.round(i.value/_*4)}).reverse();console.log(g),r.value=`/*
Generated by https://weisrc.github.io/fpgaudio
for ${((C=t.value)==null?void 0:C.name)||"unknown"}
*/

module fpgaudio_synth(
  input wire clk,
  input wire reset,
  output wire [${h.length-1}:0] out
);

// unit clock
wire uclk;
fpgaudio_divider fd_uclk (clk, ${p}, uclk);

// track data
${h.map((T,v)=>{const _=T.reverse().map(S=>S.toString(16).padStart(2,"0")).join(""),y=T.length*8;return`wire [${y-1}:0] track${v} = ${y}'h${_};`}).join(`
`)}

// track pauses
${h.map((T,v)=>`wire [31:0] pause${v};`).join(`
`)}

// track cursors
${h.map((T,v)=>`wire [31:0] cursor${v};`).join(`
`)}

// midi data
${h.map((T,v)=>{const _=new Array(8).fill(0).map((y,S)=>`track${v}[cursor${v}+${7-S}]`).join(",");return`wire [7:0] midi${v} = {${_}};`}).join(`
`)}

// track cursor modules
${h.map((T,v)=>`fpgaudio_cursor fc${v}(uclk, reset, midi${v}, ${T.length*8}, cursor${v}, pause${v});`).join(`
`)}

// track oscillators
${h.map((T,v)=>`fpgaudio_oscillator fo${v}(clk, midi${v}[6:0], !pause${v}, out[${v}]);`).join(`
`)}

endmodule

module fpgaudio_cursor(
  input wire clk,
  input wire reset,
  input wire [7:0] data,
  input wire [31:0] max,
  output integer cursor,
  output reg [6:0] pause
);

always @(posedge clk or posedge reset) begin
  if (reset) begin
    pause = 0;
    cursor = 0;
  end else begin
    if (cursor >= max) pause = 1;
    else if (pause) pause = pause - 1;
    else begin
      pause = data[7] ? data[6:0] : 0;
      cursor = cursor + 8;
    end
  end
end

endmodule

module fpgaudio_oscillator(
  input wire clk,
  input wire [6:0] midi,
  input wire enable,
  output wire out
);

// midi lowest octave value frequency divider periods
wire [383:0] octave = 384'h${g.map(T=>T.toString(16).padStart(8,"0")).join("")};
wire [8:0] i = (midi % 12) << 5;
wire [31:0] base_period = {${new Array(32).fill(0).map((T,v)=>`octave[i+${31-v}]`).join(",")}};
wire [31:0] period = base_period >> (midi / 12);
wire internal_out;
fpgaudio_divider fd_midi(clk, period, internal_out);
assign out = enable ? internal_out : 1'b0;

endmodule

module fpgaudio_divider(
  input wire clk,
  input wire [31:0] period_t,
  output reg dclk
);

integer t = 0;
always @(posedge clk) begin
  t = t + 1;
  if (t >= period_t) begin
    t = 0;
    dclk = ~dclk;
  end
end

endmodule

`,console.log(h)}}}}),iy=pt("div",{class:"text-overline"},"Step 1",-1),ry=pt("div",{class:"text-h5 q-mt-sm q-mb-xs"}," MIDI to Tone.js JSON conversion ",-1),sy=pt("div",{class:"text-caption text-grey"}," Since MIDI files are binary, we need to convert them to a more accessible format for JavaScript such as JSON as it is this frontend that is going to convert it back to a compact binary format for the FPGA. You can also play the MIDI file here thanks to Tone.js! ",-1),oy=pt("br",null,null,-1),ay=pt("div",{class:"text-overline"},"Step 2",-1),ly=pt("div",{class:"text-h5 q-mt-sm q-mb-xs"},"Verilog Code Generation",-1),uy=pt("div",{class:"text-caption text-grey"}," What is the baes clock frequency? What should be the main note unit? Should we override the beats per minute? Should we override all note duration to give them a punch? Please enter the information on the side input field and click generate. The track encoding format is simple: every track is an array of bytes. If the value of the byte is less than 128, then the byte is an actual MIDI note that will play for unit time. However, if it is larger, the byte is a pause. The following 7 bytes determines how unit of time to pause on the track. This pretty much it! ",-1),cy=pt("div",{class:"text-overline"},"Step 3",-1),hy=pt("div",{class:"text-h5 q-mt-sm q-mb-xs"},"Implement and have fun!",-1),dy=pt("div",{class:"text-caption text-grey"}," You are very close to having your own MIDI synthesizer! All you need to do is implement the generated Verilog code in your FPGA and connect the audio output to your speakers. You can also use the generated JSON file to play the MIDI file in your browser. ",-1);function fy(t,e,n,i,r,s){const o=sc("Editor");return Cn(),xn(Sh,{padding:"",class:"q-gutter-y-md"},{default:Ee(()=>[ce(ls,{flat:"",bordered:""},{default:Ee(()=>[ce(Ct,{horizontal:""},{default:Ee(()=>[ce(Ct,{class:"q-pt-xs q-gutter-y-sm"},{default:Ee(()=>[iy,ry,sy,oy,t.json?(Cn(),xn(o,{key:0,height:"50vh",theme:"vs-dark",language:"json",value:t.json},null,8,["value"])):is("",!0)]),_:1}),ce(Ct,{class:"col-5 flex flex-center"},{default:Ee(()=>[ce(Do,{class:"rounded-borders",src:"https://images.unsplash.com/photo-1507838153414-b4b713384a76"})]),_:1})]),_:1}),ce(mc),ce(Nc,{class:"justify-between"},{default:Ee(()=>[ce(Mc,{modelValue:t.file,"onUpdate:modelValue":[e[0]||(e[0]=a=>t.file=a),t.onFileChange],label:"MIDI Audio File",accept:".mid"},{before:Ee(()=>[ce(qt,{name:"music_note"})]),append:Ee(()=>[t.file!==null?(Cn(),xn(qt,{key:0,name:"close",class:"cursor-pointer"})):is("",!0)]),_:1},8,["modelValue","onUpdate:modelValue"]),pt("div",null,[t.playing?(Cn(),xn(rs,{key:1,icon:"pause",onClick:t.stop,disable:!t.json},{default:Ee(()=>[Vo("Stop")]),_:1},8,["onClick","disable"])):(Cn(),xn(rs,{key:0,icon:"play_arrow",onClick:t.play,disable:!t.json},{default:Ee(()=>[Vo("Play")]),_:1},8,["onClick","disable"]))])]),_:1})]),_:1}),ce(ls,{flat:"",bordered:""},{default:Ee(()=>[ce(Ct,{horizontal:""},{default:Ee(()=>[ce(Ct,{class:"q-pt-xs q-gutter-y-sm"},{default:Ee(()=>[ay,ly,uy,t.code?(Cn(),xn(o,{key:0,height:"50vh",theme:"vs-dark",language:"verilog",value:t.code},null,8,["value"])):is("",!0)]),_:1}),ce(Ct,{class:"flex flex-center col-3"},{default:Ee(()=>[ce(wh,{onSubmit:t.generate,class:"q-gutter-md"},{default:Ee(()=>[ce(us,{filled:"",modelValue:t.fclk,"onUpdate:modelValue":e[1]||(e[1]=a=>t.fclk=a),label:"Clock Frequency (Hz)",type:"number"},null,8,["modelValue"]),ce(bh,{filled:"",modelValue:t.unit,"onUpdate:modelValue":e[2]||(e[2]=a=>t.unit=a),options:t.unitOptions,label:"Note Unit"},null,8,["modelValue","options"]),ce(us,{filled:"",modelValue:t.bpmOverride,"onUpdate:modelValue":e[3]||(e[3]=a=>t.bpmOverride=a),label:"BPM Override",type:"number"},null,8,["modelValue"]),ce(us,{filled:"",modelValue:t.durationOverride,"onUpdate:modelValue":e[4]||(e[4]=a=>t.durationOverride=a),label:"Duration Override",type:"number"},null,8,["modelValue"]),ce(rs,{label:"Generate",type:"submit",color:"primary",disable:!t.json||!t.fclk||!t.unit},null,8,["disable"])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1}),ce(ls,{flat:"",bordered:""},{default:Ee(()=>[ce(Ct,{horizontal:""},{default:Ee(()=>[ce(Ct,{class:"q-pt-xs q-gutter-y-sm"},{default:Ee(()=>[cy,hy,dy]),_:1}),ce(Ct,{class:"col-5 flex flex-center"},{default:Ee(()=>[ce(Do,{class:"rounded-borders",src:"https://images.unsplash.com/photo-1514525253161-7a46d19cd819"})]),_:1})]),_:1})]),_:1})]),_:1})}var $y=rc(ny,[["render",fy]]);export{$y as default};
